var Qf=Object.defineProperty;var tg=(n,t,e)=>t in n?Qf(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var _h=(n,t,e)=>tg(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();var Ht="top",le="bottom",he="right",Zt="left",eo="auto",nr=[Ht,le,he,Zt],tn="start",$n="end",bu="clippingParents",rl="viewport",Tn="popper",xu="reference",ka=nr.reduce(function(n,t){return n.concat([t+"-"+tn,t+"-"+$n])},[]),sl=[].concat(nr,[eo]).reduce(function(n,t){return n.concat([t,t+"-"+tn,t+"-"+$n])},[]),Cu="beforeRead",Tu="read",Su="afterRead",Au="beforeMain",Iu="main",Ru="afterMain",Lu="beforeWrite",Ou="write",ku="afterWrite",Du=[Cu,Tu,Su,Au,Iu,Ru,Lu,Ou,ku];function ze(n){return n?(n.nodeName||"").toLowerCase():null}function ce(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var t=n.ownerDocument;return t&&t.defaultView||window}return n}function en(n){var t=ce(n).Element;return n instanceof t||n instanceof Element}function pe(n){var t=ce(n).HTMLElement;return n instanceof t||n instanceof HTMLElement}function ol(n){if(typeof ShadowRoot>"u")return!1;var t=ce(n).ShadowRoot;return n instanceof t||n instanceof ShadowRoot}function eg(n){var t=n.state;Object.keys(t.elements).forEach(function(e){var i=t.styles[e]||{},r=t.attributes[e]||{},s=t.elements[e];!pe(s)||!ze(s)||(Object.assign(s.style,i),Object.keys(r).forEach(function(o){var a=r[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function ig(n){var t=n.state,e={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,e.popper),t.styles=e,t.elements.arrow&&Object.assign(t.elements.arrow.style,e.arrow),function(){Object.keys(t.elements).forEach(function(i){var r=t.elements[i],s=t.attributes[i]||{},o=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:e[i]),a=o.reduce(function(l,c){return l[c]="",l},{});!pe(r)||!ze(r)||(Object.assign(r.style,a),Object.keys(s).forEach(function(l){r.removeAttribute(l)}))})}}const al={name:"applyStyles",enabled:!0,phase:"write",fn:eg,effect:ig,requires:["computeStyles"]};function Pe(n){return n.split("-")[0]}var Zi=Math.max,Ds=Math.min,jn=Math.round;function Da(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Mu(){return!/^((?!chrome|android).)*safari/i.test(Da())}function Un(n,t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);var i=n.getBoundingClientRect(),r=1,s=1;t&&pe(n)&&(r=n.offsetWidth>0&&jn(i.width)/n.offsetWidth||1,s=n.offsetHeight>0&&jn(i.height)/n.offsetHeight||1);var o=en(n)?ce(n):window,a=o.visualViewport,l=!Mu()&&e,c=(i.left+(l&&a?a.offsetLeft:0))/r,h=(i.top+(l&&a?a.offsetTop:0))/s,u=i.width/r,f=i.height/s;return{width:u,height:f,top:h,right:c+u,bottom:h+f,left:c,x:c,y:h}}function ll(n){var t=Un(n),e=n.offsetWidth,i=n.offsetHeight;return Math.abs(t.width-e)<=1&&(e=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:n.offsetLeft,y:n.offsetTop,width:e,height:i}}function Pu(n,t){var e=t.getRootNode&&t.getRootNode();if(n.contains(t))return!0;if(e&&ol(e)){var i=t;do{if(i&&n.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Qe(n){return ce(n).getComputedStyle(n)}function ng(n){return["table","td","th"].indexOf(ze(n))>=0}function Ri(n){return((en(n)?n.ownerDocument:n.document)||window.document).documentElement}function io(n){return ze(n)==="html"?n:n.assignedSlot||n.parentNode||(ol(n)?n.host:null)||Ri(n)}function mh(n){return!pe(n)||Qe(n).position==="fixed"?null:n.offsetParent}function rg(n){var t=/firefox/i.test(Da()),e=/Trident/i.test(Da());if(e&&pe(n)){var i=Qe(n);if(i.position==="fixed")return null}var r=io(n);for(ol(r)&&(r=r.host);pe(r)&&["html","body"].indexOf(ze(r))<0;){var s=Qe(r);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return r;r=r.parentNode}return null}function Kr(n){for(var t=ce(n),e=mh(n);e&&ng(e)&&Qe(e).position==="static";)e=mh(e);return e&&(ze(e)==="html"||ze(e)==="body"&&Qe(e).position==="static")?t:e||rg(n)||t}function hl(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Rr(n,t,e){return Zi(n,Ds(t,e))}function sg(n,t,e){var i=Rr(n,t,e);return i>e?e:i}function Nu(){return{top:0,right:0,bottom:0,left:0}}function Fu(n){return Object.assign({},Nu(),n)}function zu(n,t){return t.reduce(function(e,i){return e[i]=n,e},{})}var og=function(t,e){return t=typeof t=="function"?t(Object.assign({},e.rects,{placement:e.placement})):t,Fu(typeof t!="number"?t:zu(t,nr))};function ag(n){var t,e=n.state,i=n.name,r=n.options,s=e.elements.arrow,o=e.modifiersData.popperOffsets,a=Pe(e.placement),l=hl(a),c=[Zt,he].indexOf(a)>=0,h=c?"height":"width";if(!(!s||!o)){var u=og(r.padding,e),f=ll(s),d=l==="y"?Ht:Zt,_=l==="y"?le:he,g=e.rects.reference[h]+e.rects.reference[l]-o[l]-e.rects.popper[h],m=o[l]-e.rects.reference[l],p=Kr(s),v=p?l==="y"?p.clientHeight||0:p.clientWidth||0:0,b=g/2-m/2,w=u[d],x=v-f[h]-u[_],A=v/2-f[h]/2+b,I=Rr(w,A,x),O=l;e.modifiersData[i]=(t={},t[O]=I,t.centerOffset=I-A,t)}}function lg(n){var t=n.state,e=n.options,i=e.element,r=i===void 0?"[data-popper-arrow]":i;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||Pu(t.elements.popper,r)&&(t.elements.arrow=r))}const Gu={name:"arrow",enabled:!0,phase:"main",fn:ag,effect:lg,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Yn(n){return n.split("-")[1]}var hg={top:"auto",right:"auto",bottom:"auto",left:"auto"};function cg(n,t){var e=n.x,i=n.y,r=t.devicePixelRatio||1;return{x:jn(e*r)/r||0,y:jn(i*r)/r||0}}function ph(n){var t,e=n.popper,i=n.popperRect,r=n.placement,s=n.variation,o=n.offsets,a=n.position,l=n.gpuAcceleration,c=n.adaptive,h=n.roundOffsets,u=n.isFixed,f=o.x,d=f===void 0?0:f,_=o.y,g=_===void 0?0:_,m=typeof h=="function"?h({x:d,y:g}):{x:d,y:g};d=m.x,g=m.y;var p=o.hasOwnProperty("x"),v=o.hasOwnProperty("y"),b=Zt,w=Ht,x=window;if(c){var A=Kr(e),I="clientHeight",O="clientWidth";if(A===ce(e)&&(A=Ri(e),Qe(A).position!=="static"&&a==="absolute"&&(I="scrollHeight",O="scrollWidth")),A=A,r===Ht||(r===Zt||r===he)&&s===$n){w=le;var L=u&&A===x&&x.visualViewport?x.visualViewport.height:A[I];g-=L-i.height,g*=l?1:-1}if(r===Zt||(r===Ht||r===le)&&s===$n){b=he;var M=u&&A===x&&x.visualViewport?x.visualViewport.width:A[O];d-=M-i.width,d*=l?1:-1}}var U=Object.assign({position:a},c&&hg),T=h===!0?cg({x:d,y:g},ce(e)):{x:d,y:g};if(d=T.x,g=T.y,l){var k;return Object.assign({},U,(k={},k[w]=v?"0":"",k[b]=p?"0":"",k.transform=(x.devicePixelRatio||1)<=1?"translate("+d+"px, "+g+"px)":"translate3d("+d+"px, "+g+"px, 0)",k))}return Object.assign({},U,(t={},t[w]=v?g+"px":"",t[b]=p?d+"px":"",t.transform="",t))}function ug(n){var t=n.state,e=n.options,i=e.gpuAcceleration,r=i===void 0?!0:i,s=e.adaptive,o=s===void 0?!0:s,a=e.roundOffsets,l=a===void 0?!0:a,c={placement:Pe(t.placement),variation:Yn(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,ph(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,ph(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const cl={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:ug,data:{}};var as={passive:!0};function dg(n){var t=n.state,e=n.instance,i=n.options,r=i.scroll,s=r===void 0?!0:r,o=i.resize,a=o===void 0?!0:o,l=ce(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach(function(h){h.addEventListener("scroll",e.update,as)}),a&&l.addEventListener("resize",e.update,as),function(){s&&c.forEach(function(h){h.removeEventListener("scroll",e.update,as)}),a&&l.removeEventListener("resize",e.update,as)}}const ul={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:dg,data:{}};var fg={left:"right",right:"left",bottom:"top",top:"bottom"};function Is(n){return n.replace(/left|right|bottom|top/g,function(t){return fg[t]})}var gg={start:"end",end:"start"};function yh(n){return n.replace(/start|end/g,function(t){return gg[t]})}function dl(n){var t=ce(n),e=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:e,scrollTop:i}}function fl(n){return Un(Ri(n)).left+dl(n).scrollLeft}function _g(n,t){var e=ce(n),i=Ri(n),r=e.visualViewport,s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;var c=Mu();(c||!c&&t==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a+fl(n),y:l}}function mg(n){var t,e=Ri(n),i=dl(n),r=(t=n.ownerDocument)==null?void 0:t.body,s=Zi(e.scrollWidth,e.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Zi(e.scrollHeight,e.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+fl(n),l=-i.scrollTop;return Qe(r||e).direction==="rtl"&&(a+=Zi(e.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function gl(n){var t=Qe(n),e=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(e+r+i)}function Bu(n){return["html","body","#document"].indexOf(ze(n))>=0?n.ownerDocument.body:pe(n)&&gl(n)?n:Bu(io(n))}function Lr(n,t){var e;t===void 0&&(t=[]);var i=Bu(n),r=i===((e=n.ownerDocument)==null?void 0:e.body),s=ce(i),o=r?[s].concat(s.visualViewport||[],gl(i)?i:[]):i,a=t.concat(o);return r?a:a.concat(Lr(io(o)))}function Ma(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function pg(n,t){var e=Un(n,!1,t==="fixed");return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}function Eh(n,t,e){return t===rl?Ma(_g(n,e)):en(t)?pg(t,e):Ma(mg(Ri(n)))}function yg(n){var t=Lr(io(n)),e=["absolute","fixed"].indexOf(Qe(n).position)>=0,i=e&&pe(n)?Kr(n):n;return en(i)?t.filter(function(r){return en(r)&&Pu(r,i)&&ze(r)!=="body"}):[]}function Eg(n,t,e,i){var r=t==="clippingParents"?yg(n):[].concat(t),s=[].concat(r,[e]),o=s[0],a=s.reduce(function(l,c){var h=Eh(n,c,i);return l.top=Zi(h.top,l.top),l.right=Ds(h.right,l.right),l.bottom=Ds(h.bottom,l.bottom),l.left=Zi(h.left,l.left),l},Eh(n,o,i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Wu(n){var t=n.reference,e=n.element,i=n.placement,r=i?Pe(i):null,s=i?Yn(i):null,o=t.x+t.width/2-e.width/2,a=t.y+t.height/2-e.height/2,l;switch(r){case Ht:l={x:o,y:t.y-e.height};break;case le:l={x:o,y:t.y+t.height};break;case he:l={x:t.x+t.width,y:a};break;case Zt:l={x:t.x-e.width,y:a};break;default:l={x:t.x,y:t.y}}var c=r?hl(r):null;if(c!=null){var h=c==="y"?"height":"width";switch(s){case tn:l[c]=l[c]-(t[h]/2-e[h]/2);break;case $n:l[c]=l[c]+(t[h]/2-e[h]/2);break}}return l}function Xn(n,t){t===void 0&&(t={});var e=t,i=e.placement,r=i===void 0?n.placement:i,s=e.strategy,o=s===void 0?n.strategy:s,a=e.boundary,l=a===void 0?bu:a,c=e.rootBoundary,h=c===void 0?rl:c,u=e.elementContext,f=u===void 0?Tn:u,d=e.altBoundary,_=d===void 0?!1:d,g=e.padding,m=g===void 0?0:g,p=Fu(typeof m!="number"?m:zu(m,nr)),v=f===Tn?xu:Tn,b=n.rects.popper,w=n.elements[_?v:f],x=Eg(en(w)?w:w.contextElement||Ri(n.elements.popper),l,h,o),A=Un(n.elements.reference),I=Wu({reference:A,element:b,placement:r}),O=Ma(Object.assign({},b,I)),L=f===Tn?O:A,M={top:x.top-L.top+p.top,bottom:L.bottom-x.bottom+p.bottom,left:x.left-L.left+p.left,right:L.right-x.right+p.right},U=n.modifiersData.offset;if(f===Tn&&U){var T=U[r];Object.keys(M).forEach(function(k){var E=[he,le].indexOf(k)>=0?1:-1,F=[Ht,le].indexOf(k)>=0?"y":"x";M[k]+=T[F]*E})}return M}function vg(n,t){t===void 0&&(t={});var e=t,i=e.placement,r=e.boundary,s=e.rootBoundary,o=e.padding,a=e.flipVariations,l=e.allowedAutoPlacements,c=l===void 0?sl:l,h=Yn(i),u=h?a?ka:ka.filter(function(_){return Yn(_)===h}):nr,f=u.filter(function(_){return c.indexOf(_)>=0});f.length===0&&(f=u);var d=f.reduce(function(_,g){return _[g]=Xn(n,{placement:g,boundary:r,rootBoundary:s,padding:o})[Pe(g)],_},{});return Object.keys(d).sort(function(_,g){return d[_]-d[g]})}function wg(n){if(Pe(n)===eo)return[];var t=Is(n);return[yh(n),t,yh(t)]}function bg(n){var t=n.state,e=n.options,i=n.name;if(!t.modifiersData[i]._skip){for(var r=e.mainAxis,s=r===void 0?!0:r,o=e.altAxis,a=o===void 0?!0:o,l=e.fallbackPlacements,c=e.padding,h=e.boundary,u=e.rootBoundary,f=e.altBoundary,d=e.flipVariations,_=d===void 0?!0:d,g=e.allowedAutoPlacements,m=t.options.placement,p=Pe(m),v=p===m,b=l||(v||!_?[Is(m)]:wg(m)),w=[m].concat(b).reduce(function(J,K){return J.concat(Pe(K)===eo?vg(t,{placement:K,boundary:h,rootBoundary:u,padding:c,flipVariations:_,allowedAutoPlacements:g}):K)},[]),x=t.rects.reference,A=t.rects.popper,I=new Map,O=!0,L=w[0],M=0;M<w.length;M++){var U=w[M],T=Pe(U),k=Yn(U)===tn,E=[Ht,le].indexOf(T)>=0,F=E?"width":"height",X=Xn(t,{placement:U,boundary:h,rootBoundary:u,altBoundary:f,padding:c}),z=E?k?he:Zt:k?le:Ht;x[F]>A[F]&&(z=Is(z));var Z=Is(z),B=[];if(s&&B.push(X[T]<=0),a&&B.push(X[z]<=0,X[Z]<=0),B.every(function(J){return J})){L=U,O=!1;break}I.set(U,B)}if(O)for(var Q=_?3:1,P=function(K){var ft=w.find(function(pt){var nt=I.get(pt);if(nt)return nt.slice(0,K).every(function(ct){return ct})});if(ft)return L=ft,"break"},R=Q;R>0;R--){var et=P(R);if(et==="break")break}t.placement!==L&&(t.modifiersData[i]._skip=!0,t.placement=L,t.reset=!0)}}const $u={name:"flip",enabled:!0,phase:"main",fn:bg,requiresIfExists:["offset"],data:{_skip:!1}};function vh(n,t,e){return e===void 0&&(e={x:0,y:0}),{top:n.top-t.height-e.y,right:n.right-t.width+e.x,bottom:n.bottom-t.height+e.y,left:n.left-t.width-e.x}}function wh(n){return[Ht,he,le,Zt].some(function(t){return n[t]>=0})}function xg(n){var t=n.state,e=n.name,i=t.rects.reference,r=t.rects.popper,s=t.modifiersData.preventOverflow,o=Xn(t,{elementContext:"reference"}),a=Xn(t,{altBoundary:!0}),l=vh(o,i),c=vh(a,r,s),h=wh(l),u=wh(c);t.modifiersData[e]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:u},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":u})}const ju={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:xg};function Cg(n,t,e){var i=Pe(n),r=[Zt,Ht].indexOf(i)>=0?-1:1,s=typeof e=="function"?e(Object.assign({},t,{placement:n})):e,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[Zt,he].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}function Tg(n){var t=n.state,e=n.options,i=n.name,r=e.offset,s=r===void 0?[0,0]:r,o=sl.reduce(function(h,u){return h[u]=Cg(u,t.rects,s),h},{}),a=o[t.placement],l=a.x,c=a.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[i]=o}const Uu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Tg};function Sg(n){var t=n.state,e=n.name;t.modifiersData[e]=Wu({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const _l={name:"popperOffsets",enabled:!0,phase:"read",fn:Sg,data:{}};function Ag(n){return n==="x"?"y":"x"}function Ig(n){var t=n.state,e=n.options,i=n.name,r=e.mainAxis,s=r===void 0?!0:r,o=e.altAxis,a=o===void 0?!1:o,l=e.boundary,c=e.rootBoundary,h=e.altBoundary,u=e.padding,f=e.tether,d=f===void 0?!0:f,_=e.tetherOffset,g=_===void 0?0:_,m=Xn(t,{boundary:l,rootBoundary:c,padding:u,altBoundary:h}),p=Pe(t.placement),v=Yn(t.placement),b=!v,w=hl(p),x=Ag(w),A=t.modifiersData.popperOffsets,I=t.rects.reference,O=t.rects.popper,L=typeof g=="function"?g(Object.assign({},t.rects,{placement:t.placement})):g,M=typeof L=="number"?{mainAxis:L,altAxis:L}:Object.assign({mainAxis:0,altAxis:0},L),U=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(A){if(s){var k,E=w==="y"?Ht:Zt,F=w==="y"?le:he,X=w==="y"?"height":"width",z=A[w],Z=z+m[E],B=z-m[F],Q=d?-O[X]/2:0,P=v===tn?I[X]:O[X],R=v===tn?-O[X]:-I[X],et=t.elements.arrow,J=d&&et?ll(et):{width:0,height:0},K=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Nu(),ft=K[E],pt=K[F],nt=Rr(0,I[X],J[X]),ct=b?I[X]/2-Q-nt-ft-M.mainAxis:P-nt-ft-M.mainAxis,Et=b?-I[X]/2+Q+nt+pt+M.mainAxis:R+nt+pt+M.mainAxis,Ct=t.elements.arrow&&Kr(t.elements.arrow),$t=Ct?w==="y"?Ct.clientTop||0:Ct.clientLeft||0:0,Pt=(k=U==null?void 0:U[w])!=null?k:0,y=z+ct-Pt-$t,W=z+Et-Pt,G=Rr(d?Ds(Z,y):Z,z,d?Zi(B,W):B);A[w]=G,T[w]=G-z}if(a){var S,C=w==="x"?Ht:Zt,D=w==="x"?le:he,$=A[x],Y=x==="y"?"height":"width",N=$+m[C],V=$-m[D],tt=[Ht,Zt].indexOf(p)!==-1,q=(S=U==null?void 0:U[x])!=null?S:0,it=tt?N:$-I[Y]-O[Y]-q+M.altAxis,vt=tt?$+I[Y]+O[Y]-q-M.altAxis:V,mt=d&&tt?sg(it,$,vt):Rr(d?it:N,$,d?vt:V);A[x]=mt,T[x]=mt-$}t.modifiersData[i]=T}}const Yu={name:"preventOverflow",enabled:!0,phase:"main",fn:Ig,requiresIfExists:["offset"]};function Rg(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Lg(n){return n===ce(n)||!pe(n)?dl(n):Rg(n)}function Og(n){var t=n.getBoundingClientRect(),e=jn(t.width)/n.offsetWidth||1,i=jn(t.height)/n.offsetHeight||1;return e!==1||i!==1}function kg(n,t,e){e===void 0&&(e=!1);var i=pe(t),r=pe(t)&&Og(t),s=Ri(t),o=Un(n,r,e),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!e)&&((ze(t)!=="body"||gl(s))&&(a=Lg(t)),pe(t)?(l=Un(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=fl(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function Dg(n){var t=new Map,e=new Set,i=[];n.forEach(function(s){t.set(s.name,s)});function r(s){e.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!e.has(a)){var l=t.get(a);l&&r(l)}}),i.push(s)}return n.forEach(function(s){e.has(s.name)||r(s)}),i}function Mg(n){var t=Dg(n);return Du.reduce(function(e,i){return e.concat(t.filter(function(r){return r.phase===i}))},[])}function Pg(n){var t;return function(){return t||(t=new Promise(function(e){Promise.resolve().then(function(){t=void 0,e(n())})})),t}}function Ng(n){var t=n.reduce(function(e,i){var r=e[i.name];return e[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,e},{});return Object.keys(t).map(function(e){return t[e]})}var bh={placement:"bottom",modifiers:[],strategy:"absolute"};function xh(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function no(n){n===void 0&&(n={});var t=n,e=t.defaultModifiers,i=e===void 0?[]:e,r=t.defaultOptions,s=r===void 0?bh:r;return function(a,l,c){c===void 0&&(c=s);var h={placement:"bottom",orderedModifiers:[],options:Object.assign({},bh,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},u=[],f=!1,d={state:h,setOptions:function(p){var v=typeof p=="function"?p(h.options):p;g(),h.options=Object.assign({},s,h.options,v),h.scrollParents={reference:en(a)?Lr(a):a.contextElement?Lr(a.contextElement):[],popper:Lr(l)};var b=Mg(Ng([].concat(i,h.options.modifiers)));return h.orderedModifiers=b.filter(function(w){return w.enabled}),_(),d.update()},forceUpdate:function(){if(!f){var p=h.elements,v=p.reference,b=p.popper;if(xh(v,b)){h.rects={reference:kg(v,Kr(b),h.options.strategy==="fixed"),popper:ll(b)},h.reset=!1,h.placement=h.options.placement,h.orderedModifiers.forEach(function(M){return h.modifiersData[M.name]=Object.assign({},M.data)});for(var w=0;w<h.orderedModifiers.length;w++){if(h.reset===!0){h.reset=!1,w=-1;continue}var x=h.orderedModifiers[w],A=x.fn,I=x.options,O=I===void 0?{}:I,L=x.name;typeof A=="function"&&(h=A({state:h,options:O,name:L,instance:d})||h)}}}},update:Pg(function(){return new Promise(function(m){d.forceUpdate(),m(h)})}),destroy:function(){g(),f=!0}};if(!xh(a,l))return d;d.setOptions(c).then(function(m){!f&&c.onFirstUpdate&&c.onFirstUpdate(m)});function _(){h.orderedModifiers.forEach(function(m){var p=m.name,v=m.options,b=v===void 0?{}:v,w=m.effect;if(typeof w=="function"){var x=w({state:h,name:p,instance:d,options:b}),A=function(){};u.push(x||A)}})}function g(){u.forEach(function(m){return m()}),u=[]}return d}}var Fg=no(),zg=[ul,_l,cl,al],Gg=no({defaultModifiers:zg}),Bg=[ul,_l,cl,al,Uu,$u,Yu,Gu,ju],ml=no({defaultModifiers:Bg});const Xu=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Ru,afterRead:Su,afterWrite:ku,applyStyles:al,arrow:Gu,auto:eo,basePlacements:nr,beforeMain:Au,beforeRead:Cu,beforeWrite:Lu,bottom:le,clippingParents:bu,computeStyles:cl,createPopper:ml,createPopperBase:Fg,createPopperLite:Gg,detectOverflow:Xn,end:$n,eventListeners:ul,flip:$u,hide:ju,left:Zt,main:Iu,modifierPhases:Du,offset:Uu,placements:sl,popper:Tn,popperGenerator:no,popperOffsets:_l,preventOverflow:Yu,read:Tu,reference:xu,right:he,start:tn,top:Ht,variationPlacements:ka,viewport:rl,write:Ou},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.6 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const oi=new Map,Po={set(n,t,e){oi.has(n)||oi.set(n,new Map);const i=oi.get(n);if(!i.has(t)&&i.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`);return}i.set(t,e)},get(n,t){return oi.has(n)&&oi.get(n).get(t)||null},remove(n,t){if(!oi.has(n))return;const e=oi.get(n);e.delete(t),e.size===0&&oi.delete(n)}},Wg=1e6,$g=1e3,Pa="transitionend",Ku=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(t,e)=>`#${CSS.escape(e)}`)),n),jg=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Ug=n=>{do n+=Math.floor(Math.random()*Wg);while(document.getElementById(n));return n},Yg=n=>{if(!n)return 0;let{transitionDuration:t,transitionDelay:e}=window.getComputedStyle(n);const i=Number.parseFloat(t),r=Number.parseFloat(e);return!i&&!r?0:(t=t.split(",")[0],e=e.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(e))*$g)},Vu=n=>{n.dispatchEvent(new Event(Pa))},Ve=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),xi=n=>Ve(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Ku(n)):null,rr=n=>{if(!Ve(n)||n.getClientRects().length===0)return!1;const t=getComputedStyle(n).getPropertyValue("visibility")==="visible",e=n.closest("details:not([open])");if(!e)return t;if(e!==n){const i=n.closest("summary");if(i&&i.parentNode!==e||i===null)return!1}return t},Ci=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Hu=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const t=n.getRootNode();return t instanceof ShadowRoot?t:null}return n instanceof ShadowRoot?n:n.parentNode?Hu(n.parentNode):null},Ms=()=>{},Vr=n=>{n.offsetHeight},Zu=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,No=[],Xg=n=>{document.readyState==="loading"?(No.length||document.addEventListener("DOMContentLoaded",()=>{for(const t of No)t()}),No.push(n)):n()},Ee=()=>document.documentElement.dir==="rtl",be=n=>{Xg(()=>{const t=Zu();if(t){const e=n.NAME,i=t.fn[e];t.fn[e]=n.jQueryInterface,t.fn[e].Constructor=n,t.fn[e].noConflict=()=>(t.fn[e]=i,n.jQueryInterface)}})},ee=(n,t=[],e=n)=>typeof n=="function"?n.call(...t):e,qu=(n,t,e=!0)=>{if(!e){ee(n);return}const r=Yg(t)+5;let s=!1;const o=({target:a})=>{a===t&&(s=!0,t.removeEventListener(Pa,o),ee(n))};t.addEventListener(Pa,o),setTimeout(()=>{s||Vu(t)},r)},pl=(n,t,e,i)=>{const r=n.length;let s=n.indexOf(t);return s===-1?!e&&i?n[r-1]:n[0]:(s+=e?1:-1,i&&(s=(s+r)%r),n[Math.max(0,Math.min(s,r-1))])},Kg=/[^.]*(?=\..*)\.|.*/,Vg=/\..*/,Hg=/::\d+$/,Fo={};let Ch=1;const Ju={mouseenter:"mouseover",mouseleave:"mouseout"},Zg=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Qu(n,t){return t&&`${t}::${Ch++}`||n.uidEvent||Ch++}function td(n){const t=Qu(n);return n.uidEvent=t,Fo[t]=Fo[t]||{},Fo[t]}function qg(n,t){return function e(i){return yl(i,{delegateTarget:n}),e.oneOff&&H.off(n,i.type,t),t.apply(n,[i])}}function Jg(n,t,e){return function i(r){const s=n.querySelectorAll(t);for(let{target:o}=r;o&&o!==this;o=o.parentNode)for(const a of s)if(a===o)return yl(r,{delegateTarget:o}),i.oneOff&&H.off(n,r.type,t,e),e.apply(o,[r])}}function ed(n,t,e=null){return Object.values(n).find(i=>i.callable===t&&i.delegationSelector===e)}function id(n,t,e){const i=typeof t=="string",r=i?e:t||e;let s=nd(n);return Zg.has(s)||(s=n),[i,r,s]}function Th(n,t,e,i,r){if(typeof t!="string"||!n)return;let[s,o,a]=id(t,e,i);t in Ju&&(o=(_=>function(g){if(!g.relatedTarget||g.relatedTarget!==g.delegateTarget&&!g.delegateTarget.contains(g.relatedTarget))return _.call(this,g)})(o));const l=td(n),c=l[a]||(l[a]={}),h=ed(c,o,s?e:null);if(h){h.oneOff=h.oneOff&&r;return}const u=Qu(o,t.replace(Kg,"")),f=s?Jg(n,e,o):qg(n,o);f.delegationSelector=s?e:null,f.callable=o,f.oneOff=r,f.uidEvent=u,c[u]=f,n.addEventListener(a,f,s)}function Na(n,t,e,i,r){const s=ed(t[e],i,r);s&&(n.removeEventListener(e,s,!!r),delete t[e][s.uidEvent])}function Qg(n,t,e,i){const r=t[e]||{};for(const[s,o]of Object.entries(r))s.includes(i)&&Na(n,t,e,o.callable,o.delegationSelector)}function nd(n){return n=n.replace(Vg,""),Ju[n]||n}const H={on(n,t,e,i){Th(n,t,e,i,!1)},one(n,t,e,i){Th(n,t,e,i,!0)},off(n,t,e,i){if(typeof t!="string"||!n)return;const[r,s,o]=id(t,e,i),a=o!==t,l=td(n),c=l[o]||{},h=t.startsWith(".");if(typeof s<"u"){if(!Object.keys(c).length)return;Na(n,l,o,s,r?e:null);return}if(h)for(const u of Object.keys(l))Qg(n,l,u,t.slice(1));for(const[u,f]of Object.entries(c)){const d=u.replace(Hg,"");(!a||t.includes(d))&&Na(n,l,o,f.callable,f.delegationSelector)}},trigger(n,t,e){if(typeof t!="string"||!n)return null;const i=Zu(),r=nd(t),s=t!==r;let o=null,a=!0,l=!0,c=!1;s&&i&&(o=i.Event(t,e),i(n).trigger(o),a=!o.isPropagationStopped(),l=!o.isImmediatePropagationStopped(),c=o.isDefaultPrevented());const h=yl(new Event(t,{bubbles:a,cancelable:!0}),e);return c&&h.preventDefault(),l&&n.dispatchEvent(h),h.defaultPrevented&&o&&o.preventDefault(),h}};function yl(n,t={}){for(const[e,i]of Object.entries(t))try{n[e]=i}catch{Object.defineProperty(n,e,{configurable:!0,get(){return i}})}return n}function Sh(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function zo(n){return n.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}const He={setDataAttribute(n,t,e){n.setAttribute(`data-bs-${zo(t)}`,e)},removeDataAttribute(n,t){n.removeAttribute(`data-bs-${zo(t)}`)},getDataAttributes(n){if(!n)return{};const t={},e=Object.keys(n.dataset).filter(i=>i.startsWith("bs")&&!i.startsWith("bsConfig"));for(const i of e){let r=i.replace(/^bs/,"");r=r.charAt(0).toLowerCase()+r.slice(1),t[r]=Sh(n.dataset[i])}return t},getDataAttribute(n,t){return Sh(n.getAttribute(`data-bs-${zo(t)}`))}};class Hr{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const i=Ve(e)?He.getDataAttribute(e,"config"):{};return{...this.constructor.Default,...typeof i=="object"?i:{},...Ve(e)?He.getDataAttributes(e):{},...typeof t=="object"?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[i,r]of Object.entries(e)){const s=t[i],o=Ve(s)?"element":jg(s);if(!new RegExp(r).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${i}" provided type "${o}" but expected type "${r}".`)}}}const t_="5.3.6";class Re extends Hr{constructor(t,e){super(),t=xi(t),t&&(this._element=t,this._config=this._getConfig(e),Po.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Po.remove(this._element,this.constructor.DATA_KEY),H.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,i=!0){qu(t,e,i)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return Po.get(xi(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,typeof e=="object"?e:null)}static get VERSION(){return t_}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const Go=n=>{let t=n.getAttribute("data-bs-target");if(!t||t==="#"){let e=n.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e=`#${e.split("#")[1]}`),t=e&&e!=="#"?e.trim():null}return t?t.split(",").map(e=>Ku(e)).join(","):null},st={find(n,t=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(t,n))},findOne(n,t=document.documentElement){return Element.prototype.querySelector.call(t,n)},children(n,t){return[].concat(...n.children).filter(e=>e.matches(t))},parents(n,t){const e=[];let i=n.parentNode.closest(t);for(;i;)e.push(i),i=i.parentNode.closest(t);return e},prev(n,t){let e=n.previousElementSibling;for(;e;){if(e.matches(t))return[e];e=e.previousElementSibling}return[]},next(n,t){let e=n.nextElementSibling;for(;e;){if(e.matches(t))return[e];e=e.nextElementSibling}return[]},focusableChildren(n){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>`${e}:not([tabindex^="-"])`).join(",");return this.find(t,n).filter(e=>!Ci(e)&&rr(e))},getSelectorFromElement(n){const t=Go(n);return t&&st.findOne(t)?t:null},getElementFromSelector(n){const t=Go(n);return t?st.findOne(t):null},getMultipleElementsFromSelector(n){const t=Go(n);return t?st.find(t):[]}},ro=(n,t="hide")=>{const e=`click.dismiss${n.EVENT_KEY}`,i=n.NAME;H.on(document,e,`[data-bs-dismiss="${i}"]`,function(r){if(["A","AREA"].includes(this.tagName)&&r.preventDefault(),Ci(this))return;const s=st.getElementFromSelector(this)||this.closest(`.${i}`);n.getOrCreateInstance(s)[t]()})},e_="alert",i_="bs.alert",rd=`.${i_}`,n_=`close${rd}`,r_=`closed${rd}`,s_="fade",o_="show";class so extends Re{static get NAME(){return e_}close(){if(H.trigger(this._element,n_).defaultPrevented)return;this._element.classList.remove(o_);const e=this._element.classList.contains(s_);this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),H.trigger(this._element,r_),this.dispose()}static jQueryInterface(t){return this.each(function(){const e=so.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}ro(so,"close");be(so);const a_="button",l_="bs.button",h_=`.${l_}`,c_=".data-api",u_="active",Ah='[data-bs-toggle="button"]',d_=`click${h_}${c_}`;class oo extends Re{static get NAME(){return a_}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(u_))}static jQueryInterface(t){return this.each(function(){const e=oo.getOrCreateInstance(this);t==="toggle"&&e[t]()})}}H.on(document,d_,Ah,n=>{n.preventDefault();const t=n.target.closest(Ah);oo.getOrCreateInstance(t).toggle()});be(oo);const f_="swipe",sr=".bs.swipe",g_=`touchstart${sr}`,__=`touchmove${sr}`,m_=`touchend${sr}`,p_=`pointerdown${sr}`,y_=`pointerup${sr}`,E_="touch",v_="pen",w_="pointer-event",b_=40,x_={endCallback:null,leftCallback:null,rightCallback:null},C_={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Ps extends Hr{constructor(t,e){super(),this._element=t,!(!t||!Ps.isSupported())&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return x_}static get DefaultType(){return C_}static get NAME(){return f_}dispose(){H.off(this._element,sr)}_start(t){if(!this._supportPointerEvents){this._deltaX=t.touches[0].clientX;return}this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX)}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),ee(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=b_)return;const e=t/this._deltaX;this._deltaX=0,e&&ee(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(H.on(this._element,p_,t=>this._start(t)),H.on(this._element,y_,t=>this._end(t)),this._element.classList.add(w_)):(H.on(this._element,g_,t=>this._start(t)),H.on(this._element,__,t=>this._move(t)),H.on(this._element,m_,t=>this._end(t)))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&(t.pointerType===v_||t.pointerType===E_)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const T_="carousel",S_="bs.carousel",Li=`.${S_}`,sd=".data-api",A_="ArrowLeft",I_="ArrowRight",R_=500,ur="next",_n="prev",Sn="left",Rs="right",L_=`slide${Li}`,Bo=`slid${Li}`,O_=`keydown${Li}`,k_=`mouseenter${Li}`,D_=`mouseleave${Li}`,M_=`dragstart${Li}`,P_=`load${Li}${sd}`,N_=`click${Li}${sd}`,od="carousel",ls="active",F_="slide",z_="carousel-item-end",G_="carousel-item-start",B_="carousel-item-next",W_="carousel-item-prev",ad=".active",ld=".carousel-item",$_=ad+ld,j_=".carousel-item img",U_=".carousel-indicators",Y_="[data-bs-slide], [data-bs-slide-to]",X_='[data-bs-ride="carousel"]',K_={[A_]:Rs,[I_]:Sn},V_={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},H_={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Zr extends Re{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=st.findOne(U_,this._element),this._addEventListeners(),this._config.ride===od&&this.cycle()}static get Default(){return V_}static get DefaultType(){return H_}static get NAME(){return T_}next(){this._slide(ur)}nextWhenVisible(){!document.hidden&&rr(this._element)&&this.next()}prev(){this._slide(_n)}pause(){this._isSliding&&Vu(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){H.one(this._element,Bo,()=>this.cycle());return}this.cycle()}}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding){H.one(this._element,Bo,()=>this.to(t));return}const i=this._getItemIndex(this._getActive());if(i===t)return;const r=t>i?ur:_n;this._slide(r,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&H.on(this._element,O_,t=>this._keydown(t)),this._config.pause==="hover"&&(H.on(this._element,k_,()=>this.pause()),H.on(this._element,D_,()=>this._maybeEnableCycle())),this._config.touch&&Ps.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const i of st.find(j_,this._element))H.on(i,M_,r=>r.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(Sn)),rightCallback:()=>this._slide(this._directionToOrder(Rs)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),R_+this._config.interval))}};this._swipeHelper=new Ps(this._element,e)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=K_[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=st.findOne(ad,this._indicatorsElement);e.classList.remove(ls),e.removeAttribute("aria-current");const i=st.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);i&&(i.classList.add(ls),i.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const i=this._getActive(),r=t===ur,s=e||pl(this._getItems(),i,r,this._config.wrap);if(s===i)return;const o=this._getItemIndex(s),a=d=>H.trigger(this._element,d,{relatedTarget:s,direction:this._orderToDirection(t),from:this._getItemIndex(i),to:o});if(a(L_).defaultPrevented||!i||!s)return;const c=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=s;const h=r?G_:z_,u=r?B_:W_;s.classList.add(u),Vr(s),i.classList.add(h),s.classList.add(h);const f=()=>{s.classList.remove(h,u),s.classList.add(ls),i.classList.remove(ls,u,h),this._isSliding=!1,a(Bo)};this._queueCallback(f,i,this._isAnimated()),c&&this.cycle()}_isAnimated(){return this._element.classList.contains(F_)}_getActive(){return st.findOne($_,this._element)}_getItems(){return st.find(ld,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return Ee()?t===Sn?_n:ur:t===Sn?ur:_n}_orderToDirection(t){return Ee()?t===_n?Sn:Rs:t===_n?Rs:Sn}static jQueryInterface(t){return this.each(function(){const e=Zr.getOrCreateInstance(this,t);if(typeof t=="number"){e.to(t);return}if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}H.on(document,N_,Y_,function(n){const t=st.getElementFromSelector(this);if(!t||!t.classList.contains(od))return;n.preventDefault();const e=Zr.getOrCreateInstance(t),i=this.getAttribute("data-bs-slide-to");if(i){e.to(i),e._maybeEnableCycle();return}if(He.getDataAttribute(this,"slide")==="next"){e.next(),e._maybeEnableCycle();return}e.prev(),e._maybeEnableCycle()});H.on(window,P_,()=>{const n=st.find(X_);for(const t of n)Zr.getOrCreateInstance(t)});be(Zr);const Z_="collapse",q_="bs.collapse",qr=`.${q_}`,J_=".data-api",Q_=`show${qr}`,tm=`shown${qr}`,em=`hide${qr}`,im=`hidden${qr}`,nm=`click${qr}${J_}`,Wo="show",Dn="collapse",hs="collapsing",rm="collapsed",sm=`:scope .${Dn} .${Dn}`,om="collapse-horizontal",am="width",lm="height",hm=".collapse.show, .collapse.collapsing",Fa='[data-bs-toggle="collapse"]',cm={parent:null,toggle:!0},um={parent:"(null|element)",toggle:"boolean"};class Dr extends Re{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const i=st.find(Fa);for(const r of i){const s=st.getSelectorFromElement(r),o=st.find(s).filter(a=>a===this._element);s!==null&&o.length&&this._triggerArray.push(r)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return cm}static get DefaultType(){return um}static get NAME(){return Z_}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(hm).filter(a=>a!==this._element).map(a=>Dr.getOrCreateInstance(a,{toggle:!1}))),t.length&&t[0]._isTransitioning||H.trigger(this._element,Q_).defaultPrevented)return;for(const a of t)a.hide();const i=this._getDimension();this._element.classList.remove(Dn),this._element.classList.add(hs),this._element.style[i]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const r=()=>{this._isTransitioning=!1,this._element.classList.remove(hs),this._element.classList.add(Dn,Wo),this._element.style[i]="",H.trigger(this._element,tm)},o=`scroll${i[0].toUpperCase()+i.slice(1)}`;this._queueCallback(r,this._element,!0),this._element.style[i]=`${this._element[o]}px`}hide(){if(this._isTransitioning||!this._isShown()||H.trigger(this._element,em).defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,Vr(this._element),this._element.classList.add(hs),this._element.classList.remove(Dn,Wo);for(const r of this._triggerArray){const s=st.getElementFromSelector(r);s&&!this._isShown(s)&&this._addAriaAndCollapsedClass([r],!1)}this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(hs),this._element.classList.add(Dn),H.trigger(this._element,im)};this._element.style[e]="",this._queueCallback(i,this._element,!0)}_isShown(t=this._element){return t.classList.contains(Wo)}_configAfterMerge(t){return t.toggle=!!t.toggle,t.parent=xi(t.parent),t}_getDimension(){return this._element.classList.contains(om)?am:lm}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(Fa);for(const e of t){const i=st.getElementFromSelector(e);i&&this._addAriaAndCollapsedClass([e],this._isShown(i))}}_getFirstLevelChildren(t){const e=st.find(sm,this._config.parent);return st.find(t,this._config.parent).filter(i=>!e.includes(i))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const i of t)i.classList.toggle(rm,!e),i.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return typeof t=="string"&&/show|hide/.test(t)&&(e.toggle=!1),this.each(function(){const i=Dr.getOrCreateInstance(this,e);if(typeof t=="string"){if(typeof i[t]>"u")throw new TypeError(`No method named "${t}"`);i[t]()}})}}H.on(document,nm,Fa,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const t of st.getMultipleElementsFromSelector(this))Dr.getOrCreateInstance(t,{toggle:!1}).toggle()});be(Dr);const Ih="dropdown",dm="bs.dropdown",an=`.${dm}`,El=".data-api",fm="Escape",Rh="Tab",gm="ArrowUp",Lh="ArrowDown",_m=2,mm=`hide${an}`,pm=`hidden${an}`,ym=`show${an}`,Em=`shown${an}`,hd=`click${an}${El}`,cd=`keydown${an}${El}`,vm=`keyup${an}${El}`,An="show",wm="dropup",bm="dropend",xm="dropstart",Cm="dropup-center",Tm="dropdown-center",Ui='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Sm=`${Ui}.${An}`,Ls=".dropdown-menu",Am=".navbar",Im=".navbar-nav",Rm=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Lm=Ee()?"top-end":"top-start",Om=Ee()?"top-start":"top-end",km=Ee()?"bottom-end":"bottom-start",Dm=Ee()?"bottom-start":"bottom-end",Mm=Ee()?"left-start":"right-start",Pm=Ee()?"right-start":"left-start",Nm="top",Fm="bottom",zm={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Gm={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ne extends Re{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=st.next(this._element,Ls)[0]||st.prev(this._element,Ls)[0]||st.findOne(Ls,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return zm}static get DefaultType(){return Gm}static get NAME(){return Ih}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ci(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!H.trigger(this._element,ym,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Im))for(const i of[].concat(...document.body.children))H.on(i,"mouseover",Ms);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(An),this._element.classList.add(An),H.trigger(this._element,Em,t)}}hide(){if(Ci(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!H.trigger(this._element,mm,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))H.off(i,"mouseover",Ms);this._popper&&this._popper.destroy(),this._menu.classList.remove(An),this._element.classList.remove(An),this._element.setAttribute("aria-expanded","false"),He.removeDataAttribute(this._menu,"popper"),H.trigger(this._element,pm,t),this._element.focus()}}_getConfig(t){if(t=super._getConfig(t),typeof t.reference=="object"&&!Ve(t.reference)&&typeof t.reference.getBoundingClientRect!="function")throw new TypeError(`${Ih.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(typeof Xu>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let t=this._element;this._config.reference==="parent"?t=this._parent:Ve(this._config.reference)?t=xi(this._config.reference):typeof this._config.reference=="object"&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=ml(t,this._menu,e)}_isShown(){return this._menu.classList.contains(An)}_getPlacement(){const t=this._parent;if(t.classList.contains(bm))return Mm;if(t.classList.contains(xm))return Pm;if(t.classList.contains(Cm))return Nm;if(t.classList.contains(Tm))return Fm;const e=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return t.classList.contains(wm)?e?Om:Lm:e?Dm:km}_detectNavbar(){return this._element.closest(Am)!==null}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(He.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...ee(this._config.popperConfig,[void 0,t])}}_selectMenuItem({key:t,target:e}){const i=st.find(Rm,this._menu).filter(r=>rr(r));i.length&&pl(i,e,t===Lh,!i.includes(e)).focus()}static jQueryInterface(t){return this.each(function(){const e=Ne.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}static clearMenus(t){if(t.button===_m||t.type==="keyup"&&t.key!==Rh)return;const e=st.find(Sm);for(const i of e){const r=Ne.getInstance(i);if(!r||r._config.autoClose===!1)continue;const s=t.composedPath(),o=s.includes(r._menu);if(s.includes(r._element)||r._config.autoClose==="inside"&&!o||r._config.autoClose==="outside"&&o||r._menu.contains(t.target)&&(t.type==="keyup"&&t.key===Rh||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const a={relatedTarget:r._element};t.type==="click"&&(a.clickEvent=t),r._completeHide(a)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),i=t.key===fm,r=[gm,Lh].includes(t.key);if(!r&&!i||e&&!i)return;t.preventDefault();const s=this.matches(Ui)?this:st.prev(this,Ui)[0]||st.next(this,Ui)[0]||st.findOne(Ui,t.delegateTarget.parentNode),o=Ne.getOrCreateInstance(s);if(r){t.stopPropagation(),o.show(),o._selectMenuItem(t);return}o._isShown()&&(t.stopPropagation(),o.hide(),s.focus())}}H.on(document,cd,Ui,Ne.dataApiKeydownHandler);H.on(document,cd,Ls,Ne.dataApiKeydownHandler);H.on(document,hd,Ne.clearMenus);H.on(document,vm,Ne.clearMenus);H.on(document,hd,Ui,function(n){n.preventDefault(),Ne.getOrCreateInstance(this).toggle()});be(Ne);const ud="backdrop",Bm="fade",Oh="show",kh=`mousedown.bs.${ud}`,Wm={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},$m={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class dd extends Hr{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return Wm}static get DefaultType(){return $m}static get NAME(){return ud}show(t){if(!this._config.isVisible){ee(t);return}this._append();const e=this._getElement();this._config.isAnimated&&Vr(e),e.classList.add(Oh),this._emulateAnimation(()=>{ee(t)})}hide(t){if(!this._config.isVisible){ee(t);return}this._getElement().classList.remove(Oh),this._emulateAnimation(()=>{this.dispose(),ee(t)})}dispose(){this._isAppended&&(H.off(this._element,kh),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add(Bm),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=xi(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),H.on(t,kh,()=>{ee(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(t){qu(t,this._getElement(),this._config.isAnimated)}}const jm="focustrap",Um="bs.focustrap",Ns=`.${Um}`,Ym=`focusin${Ns}`,Xm=`keydown.tab${Ns}`,Km="Tab",Vm="forward",Dh="backward",Hm={autofocus:!0,trapElement:null},Zm={autofocus:"boolean",trapElement:"element"};class fd extends Hr{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Hm}static get DefaultType(){return Zm}static get NAME(){return jm}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),H.off(document,Ns),H.on(document,Ym,t=>this._handleFocusin(t)),H.on(document,Xm,t=>this._handleKeydown(t)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,H.off(document,Ns))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const i=st.focusableChildren(e);i.length===0?e.focus():this._lastTabNavDirection===Dh?i[i.length-1].focus():i[0].focus()}_handleKeydown(t){t.key===Km&&(this._lastTabNavDirection=t.shiftKey?Dh:Vm)}}const Mh=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Ph=".sticky-top",cs="padding-right",Nh="margin-right";class za{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,cs,e=>e+t),this._setElementAttributes(Mh,cs,e=>e+t),this._setElementAttributes(Ph,Nh,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,cs),this._resetElementAttributes(Mh,cs),this._resetElementAttributes(Ph,Nh)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,i){const r=this.getWidth(),s=o=>{if(o!==this._element&&window.innerWidth>o.clientWidth+r)return;this._saveInitialAttribute(o,e);const a=window.getComputedStyle(o).getPropertyValue(e);o.style.setProperty(e,`${i(Number.parseFloat(a))}px`)};this._applyManipulationCallback(t,s)}_saveInitialAttribute(t,e){const i=t.style.getPropertyValue(e);i&&He.setDataAttribute(t,e,i)}_resetElementAttributes(t,e){const i=r=>{const s=He.getDataAttribute(r,e);if(s===null){r.style.removeProperty(e);return}He.removeDataAttribute(r,e),r.style.setProperty(e,s)};this._applyManipulationCallback(t,i)}_applyManipulationCallback(t,e){if(Ve(t)){e(t);return}for(const i of st.find(t,this._element))e(i)}}const qm="modal",Jm="bs.modal",ve=`.${Jm}`,Qm=".data-api",tp="Escape",ep=`hide${ve}`,ip=`hidePrevented${ve}`,gd=`hidden${ve}`,_d=`show${ve}`,np=`shown${ve}`,rp=`resize${ve}`,sp=`click.dismiss${ve}`,op=`mousedown.dismiss${ve}`,ap=`keydown.dismiss${ve}`,lp=`click${ve}${Qm}`,Fh="modal-open",hp="fade",zh="show",$o="modal-static",cp=".modal.show",up=".modal-dialog",dp=".modal-body",fp='[data-bs-toggle="modal"]',gp={backdrop:!0,focus:!0,keyboard:!0},_p={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Kn extends Re{constructor(t,e){super(t,e),this._dialog=st.findOne(up,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new za,this._addEventListeners()}static get Default(){return gp}static get DefaultType(){return _p}static get NAME(){return qm}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||H.trigger(this._element,_d,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Fh),this._adjustDialog(),this._backdrop.show(()=>this._showElement(t)))}hide(){!this._isShown||this._isTransitioning||H.trigger(this._element,ep).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(zh),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){H.off(window,ve),H.off(this._dialog,ve),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new dd({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new fd({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=st.findOne(dp,this._dialog);e&&(e.scrollTop=0),Vr(this._element),this._element.classList.add(zh);const i=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,H.trigger(this._element,np,{relatedTarget:t})};this._queueCallback(i,this._dialog,this._isAnimated())}_addEventListeners(){H.on(this._element,ap,t=>{if(t.key===tp){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),H.on(window,rp,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),H.on(this._element,op,t=>{H.one(this._element,sp,e=>{if(!(this._element!==t.target||this._element!==e.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Fh),this._resetAdjustments(),this._scrollBar.reset(),H.trigger(this._element,gd)})}_isAnimated(){return this._element.classList.contains(hp)}_triggerBackdropTransition(){if(H.trigger(this._element,ip).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,i=this._element.style.overflowY;i==="hidden"||this._element.classList.contains($o)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add($o),this._queueCallback(()=>{this._element.classList.remove($o),this._queueCallback(()=>{this._element.style.overflowY=i},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),i=e>0;if(i&&!t){const r=Ee()?"paddingLeft":"paddingRight";this._element.style[r]=`${e}px`}if(!i&&t){const r=Ee()?"paddingRight":"paddingLeft";this._element.style[r]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each(function(){const i=Kn.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof i[t]>"u")throw new TypeError(`No method named "${t}"`);i[t](e)}})}}H.on(document,lp,fp,function(n){const t=st.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),H.one(t,_d,r=>{r.defaultPrevented||H.one(t,gd,()=>{rr(this)&&this.focus()})});const e=st.findOne(cp);e&&Kn.getInstance(e).hide(),Kn.getOrCreateInstance(t).toggle(this)});ro(Kn);be(Kn);const mp="offcanvas",pp="bs.offcanvas",ei=`.${pp}`,md=".data-api",yp=`load${ei}${md}`,Ep="Escape",Gh="show",Bh="showing",Wh="hiding",vp="offcanvas-backdrop",pd=".offcanvas.show",wp=`show${ei}`,bp=`shown${ei}`,xp=`hide${ei}`,$h=`hidePrevented${ei}`,yd=`hidden${ei}`,Cp=`resize${ei}`,Tp=`click${ei}${md}`,Sp=`keydown.dismiss${ei}`,Ap='[data-bs-toggle="offcanvas"]',Ip={backdrop:!0,keyboard:!0,scroll:!1},Rp={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ti extends Re{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Ip}static get DefaultType(){return Rp}static get NAME(){return mp}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||H.trigger(this._element,wp,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new za().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Bh);const i=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Gh),this._element.classList.remove(Bh),H.trigger(this._element,bp,{relatedTarget:t})};this._queueCallback(i,this._element,!0)}hide(){if(!this._isShown||H.trigger(this._element,xp).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Wh),this._backdrop.hide();const e=()=>{this._element.classList.remove(Gh,Wh),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new za().reset(),H.trigger(this._element,yd)};this._queueCallback(e,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=()=>{if(this._config.backdrop==="static"){H.trigger(this._element,$h);return}this.hide()},e=!!this._config.backdrop;return new dd({className:vp,isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?t:null})}_initializeFocusTrap(){return new fd({trapElement:this._element})}_addEventListeners(){H.on(this._element,Sp,t=>{if(t.key===Ep){if(this._config.keyboard){this.hide();return}H.trigger(this._element,$h)}})}static jQueryInterface(t){return this.each(function(){const e=Ti.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}H.on(document,Tp,Ap,function(n){const t=st.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Ci(this))return;H.one(t,yd,()=>{rr(this)&&this.focus()});const e=st.findOne(pd);e&&e!==t&&Ti.getInstance(e).hide(),Ti.getOrCreateInstance(t).toggle(this)});H.on(window,yp,()=>{for(const n of st.find(pd))Ti.getOrCreateInstance(n).show()});H.on(window,Cp,()=>{for(const n of st.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Ti.getOrCreateInstance(n).hide()});ro(Ti);be(Ti);const Lp=/^aria-[\w-]*$/i,Ed={"*":["class","dir","id","lang","role",Lp],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Op=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),kp=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Dp=(n,t)=>{const e=n.nodeName.toLowerCase();return t.includes(e)?Op.has(e)?!!kp.test(n.nodeValue):!0:t.filter(i=>i instanceof RegExp).some(i=>i.test(e))};function Mp(n,t,e){if(!n.length)return n;if(e&&typeof e=="function")return e(n);const r=new window.DOMParser().parseFromString(n,"text/html"),s=[].concat(...r.body.querySelectorAll("*"));for(const o of s){const a=o.nodeName.toLowerCase();if(!Object.keys(t).includes(a)){o.remove();continue}const l=[].concat(...o.attributes),c=[].concat(t["*"]||[],t[a]||[]);for(const h of l)Dp(h,c)||o.removeAttribute(h.nodeName)}return r.body.innerHTML}const Pp="TemplateFactory",Np={allowList:Ed,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Fp={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},zp={entry:"(string|element|function|null)",selector:"(string|element)"};class Gp extends Hr{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return Np}static get DefaultType(){return Fp}static get NAME(){return Pp}getContent(){return Object.values(this._config.content).map(t=>this._resolvePossibleFunction(t)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[r,s]of Object.entries(this._config.content))this._setContent(t,s,r);const e=t.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&e.classList.add(...i.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,i]of Object.entries(t))super._typeCheckConfig({selector:e,entry:i},zp)}_setContent(t,e,i){const r=st.findOne(i,t);if(r){if(e=this._resolvePossibleFunction(e),!e){r.remove();return}if(Ve(e)){this._putElementInTemplate(xi(e),r);return}if(this._config.html){r.innerHTML=this._maybeSanitize(e);return}r.textContent=e}}_maybeSanitize(t){return this._config.sanitize?Mp(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return ee(t,[void 0,this])}_putElementInTemplate(t,e){if(this._config.html){e.innerHTML="",e.append(t);return}e.textContent=t.textContent}}const Bp="tooltip",Wp=new Set(["sanitize","allowList","sanitizeFn"]),jo="fade",$p="modal",us="show",jp=".tooltip-inner",jh=`.${$p}`,Uh="hide.bs.modal",dr="hover",Uo="focus",Up="click",Yp="manual",Xp="hide",Kp="hidden",Vp="show",Hp="shown",Zp="inserted",qp="click",Jp="focusin",Qp="focusout",ty="mouseenter",ey="mouseleave",iy={AUTO:"auto",TOP:"top",RIGHT:Ee()?"left":"right",BOTTOM:"bottom",LEFT:Ee()?"right":"left"},ny={allowList:Ed,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},ry={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class or extends Re{constructor(t,e){if(typeof Xu>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return ny}static get DefaultType(){return ry}static get NAME(){return Bp}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),H.off(this._element.closest(jh),Uh,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const t=H.trigger(this._element,this.constructor.eventName(Vp)),i=(Hu(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!i)return;this._disposePopper();const r=this._getTipElement();this._element.setAttribute("aria-describedby",r.getAttribute("id"));const{container:s}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(s.append(r),H.trigger(this._element,this.constructor.eventName(Zp))),this._popper=this._createPopper(r),r.classList.add(us),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))H.on(a,"mouseover",Ms);const o=()=>{H.trigger(this._element,this.constructor.eventName(Hp)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(o,this.tip,this._isAnimated())}hide(){if(!this._isShown()||H.trigger(this._element,this.constructor.eventName(Xp)).defaultPrevented)return;if(this._getTipElement().classList.remove(us),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))H.off(r,"mouseover",Ms);this._activeTrigger[Up]=!1,this._activeTrigger[Uo]=!1,this._activeTrigger[dr]=!1,this._isHovered=null;const i=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),H.trigger(this._element,this.constructor.eventName(Kp)))};this._queueCallback(i,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(jo,us),e.classList.add(`bs-${this.constructor.NAME}-auto`);const i=Ug(this.constructor.NAME).toString();return e.setAttribute("id",i),this._isAnimated()&&e.classList.add(jo),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new Gp({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[jp]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(jo)}_isShown(){return this.tip&&this.tip.classList.contains(us)}_createPopper(t){const e=ee(this._config.placement,[this,t,this._element]),i=iy[e.toUpperCase()];return ml(this._element,t,this._getPopperConfig(i))}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_resolvePossibleFunction(t){return ee(t,[this._element,this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:i=>{this._getTipElement().setAttribute("data-popper-placement",i.state.placement)}}]};return{...e,...ee(this._config.popperConfig,[void 0,e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if(e==="click")H.on(this._element,this.constructor.eventName(qp),this._config.selector,i=>{this._initializeOnDelegatedTarget(i).toggle()});else if(e!==Yp){const i=e===dr?this.constructor.eventName(ty):this.constructor.eventName(Jp),r=e===dr?this.constructor.eventName(ey):this.constructor.eventName(Qp);H.on(this._element,i,this._config.selector,s=>{const o=this._initializeOnDelegatedTarget(s);o._activeTrigger[s.type==="focusin"?Uo:dr]=!0,o._enter()}),H.on(this._element,r,this._config.selector,s=>{const o=this._initializeOnDelegatedTarget(s);o._activeTrigger[s.type==="focusout"?Uo:dr]=o._element.contains(s.relatedTarget),o._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},H.on(this._element.closest(jh),Uh,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=He.getDataAttributes(this._element);for(const i of Object.keys(e))Wp.has(i)&&delete e[i];return t={...e,...typeof t=="object"&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=t.container===!1?document.body:xi(t.container),typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),typeof t.title=="number"&&(t.title=t.title.toString()),typeof t.content=="number"&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,i]of Object.entries(this._config))this.constructor.Default[e]!==i&&(t[e]=i);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){const e=or.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}}be(or);const sy="popover",oy=".popover-header",ay=".popover-body",ly={...or.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},hy={...or.DefaultType,content:"(null|string|element|function)"};class vl extends or{static get Default(){return ly}static get DefaultType(){return hy}static get NAME(){return sy}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[oy]:this._getTitle(),[ay]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){const e=vl.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}}be(vl);const cy="scrollspy",uy="bs.scrollspy",wl=`.${uy}`,dy=".data-api",fy=`activate${wl}`,Yh=`click${wl}`,gy=`load${wl}${dy}`,_y="dropdown-item",mn="active",my='[data-bs-spy="scroll"]',Yo="[href]",py=".nav, .list-group",Xh=".nav-link",yy=".nav-item",Ey=".list-group-item",vy=`${Xh}, ${yy} > ${Xh}, ${Ey}`,wy=".dropdown",by=".dropdown-toggle",xy={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Cy={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ao extends Re{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return xy}static get DefaultType(){return Cy}static get NAME(){return cy}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=xi(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,typeof t.threshold=="string"&&(t.threshold=t.threshold.split(",").map(e=>Number.parseFloat(e))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(H.off(this._config.target,Yh),H.on(this._config.target,Yh,Yo,t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const i=this._rootElement||window,r=e.offsetTop-this._element.offsetTop;if(i.scrollTo){i.scrollTo({top:r,behavior:"smooth"});return}i.scrollTop=r}}))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),t)}_observerCallback(t){const e=o=>this._targetLinks.get(`#${o.target.id}`),i=o=>{this._previousScrollData.visibleEntryTop=o.target.offsetTop,this._process(e(o))},r=(this._rootElement||document.documentElement).scrollTop,s=r>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=r;for(const o of t){if(!o.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(o));continue}const a=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&a){if(i(o),!r)return;continue}!s&&!a&&i(o)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=st.find(Yo,this._config.target);for(const e of t){if(!e.hash||Ci(e))continue;const i=st.findOne(decodeURI(e.hash),this._element);rr(i)&&(this._targetLinks.set(decodeURI(e.hash),e),this._observableSections.set(e.hash,i))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(mn),this._activateParents(t),H.trigger(this._element,fy,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains(_y)){st.findOne(by,t.closest(wy)).classList.add(mn);return}for(const e of st.parents(t,py))for(const i of st.prev(e,vy))i.classList.add(mn)}_clearActiveClass(t){t.classList.remove(mn);const e=st.find(`${Yo}.${mn}`,t);for(const i of e)i.classList.remove(mn)}static jQueryInterface(t){return this.each(function(){const e=ao.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}H.on(window,gy,()=>{for(const n of st.find(my))ao.getOrCreateInstance(n)});be(ao);const Ty="tab",Sy="bs.tab",ln=`.${Sy}`,Ay=`hide${ln}`,Iy=`hidden${ln}`,Ry=`show${ln}`,Ly=`shown${ln}`,Oy=`click${ln}`,ky=`keydown${ln}`,Dy=`load${ln}`,My="ArrowLeft",Kh="ArrowRight",Py="ArrowUp",Vh="ArrowDown",Xo="Home",Hh="End",Yi="active",Zh="fade",Ko="show",Ny="dropdown",vd=".dropdown-toggle",Fy=".dropdown-menu",Vo=`:not(${vd})`,zy='.list-group, .nav, [role="tablist"]',Gy=".nav-item, .list-group-item",By=`.nav-link${Vo}, .list-group-item${Vo}, [role="tab"]${Vo}`,wd='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ho=`${By}, ${wd}`,Wy=`.${Yi}[data-bs-toggle="tab"], .${Yi}[data-bs-toggle="pill"], .${Yi}[data-bs-toggle="list"]`;class Vn extends Re{constructor(t){super(t),this._parent=this._element.closest(zy),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),H.on(this._element,ky,e=>this._keydown(e)))}static get NAME(){return Ty}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),i=e?H.trigger(e,Ay,{relatedTarget:t}):null;H.trigger(t,Ry,{relatedTarget:e}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){if(!t)return;t.classList.add(Yi),this._activate(st.getElementFromSelector(t));const i=()=>{if(t.getAttribute("role")!=="tab"){t.classList.add(Ko);return}t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),H.trigger(t,Ly,{relatedTarget:e})};this._queueCallback(i,t,t.classList.contains(Zh))}_deactivate(t,e){if(!t)return;t.classList.remove(Yi),t.blur(),this._deactivate(st.getElementFromSelector(t));const i=()=>{if(t.getAttribute("role")!=="tab"){t.classList.remove(Ko);return}t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),H.trigger(t,Iy,{relatedTarget:e})};this._queueCallback(i,t,t.classList.contains(Zh))}_keydown(t){if(![My,Kh,Py,Vh,Xo,Hh].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=this._getChildren().filter(r=>!Ci(r));let i;if([Xo,Hh].includes(t.key))i=e[t.key===Xo?0:e.length-1];else{const r=[Kh,Vh].includes(t.key);i=pl(e,t.target,r,!0)}i&&(i.focus({preventScroll:!0}),Vn.getOrCreateInstance(i).show())}_getChildren(){return st.find(Ho,this._parent)}_getActiveElem(){return this._getChildren().find(t=>this._elemIsActive(t))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const i of e)this._setInitialAttributesOnChild(i)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),i=this._getOuterElement(t);t.setAttribute("aria-selected",e),i!==t&&this._setAttributeIfNotExists(i,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=st.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const i=this._getOuterElement(t);if(!i.classList.contains(Ny))return;const r=(s,o)=>{const a=st.findOne(s,i);a&&a.classList.toggle(o,e)};r(vd,Yi),r(Fy,Ko),i.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,i){t.hasAttribute(e)||t.setAttribute(e,i)}_elemIsActive(t){return t.classList.contains(Yi)}_getInnerElement(t){return t.matches(Ho)?t:st.findOne(Ho,t)}_getOuterElement(t){return t.closest(Gy)||t}static jQueryInterface(t){return this.each(function(){const e=Vn.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}H.on(document,Oy,wd,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Ci(this)&&Vn.getOrCreateInstance(this).show()});H.on(window,Dy,()=>{for(const n of st.find(Wy))Vn.getOrCreateInstance(n)});be(Vn);const $y="toast",jy="bs.toast",Oi=`.${jy}`,Uy=`mouseover${Oi}`,Yy=`mouseout${Oi}`,Xy=`focusin${Oi}`,Ky=`focusout${Oi}`,Vy=`hide${Oi}`,Hy=`hidden${Oi}`,Zy=`show${Oi}`,qy=`shown${Oi}`,Jy="fade",qh="hide",ds="show",fs="showing",Qy={animation:"boolean",autohide:"boolean",delay:"number"},t0={animation:!0,autohide:!0,delay:5e3};class lo extends Re{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return t0}static get DefaultType(){return Qy}static get NAME(){return $y}show(){if(H.trigger(this._element,Zy).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Jy);const e=()=>{this._element.classList.remove(fs),H.trigger(this._element,qy),this._maybeScheduleHide()};this._element.classList.remove(qh),Vr(this._element),this._element.classList.add(ds,fs),this._queueCallback(e,this._element,this._config.animation)}hide(){if(!this.isShown()||H.trigger(this._element,Vy).defaultPrevented)return;const e=()=>{this._element.classList.add(qh),this._element.classList.remove(fs,ds),H.trigger(this._element,Hy)};this._element.classList.add(fs),this._queueCallback(e,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ds),super.dispose()}isShown(){return this._element.classList.contains(ds)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=e;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=e;break}}if(e){this._clearTimeout();return}const i=t.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){H.on(this._element,Uy,t=>this._onInteraction(t,!0)),H.on(this._element,Yy,t=>this._onInteraction(t,!1)),H.on(this._element,Xy,t=>this._onInteraction(t,!0)),H.on(this._element,Ky,t=>this._onInteraction(t,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){const e=lo.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}ro(lo);be(lo);const Jt={ADD:"add",REMOVE:"remove"},Hn={PROPERTYCHANGE:"propertychange"},dt={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class ho{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function e0(n,t,e){let i,r;e=e||Ze;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+e(n[i],t),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function Ze(n,t){return n>t?1:n<t?-1:0}function i0(n,t){return n<t?1:n>t?-1:0}function bl(n,t,e){if(n[0]<=t)return 0;const i=n.length;if(t<=n[i-1])return i-1;if(typeof e=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===t)return r;if(s<t)return e(t,n[r-1],s)>0?r-1:r}return i-1}if(e>0){for(let r=1;r<i;++r)if(n[r]<t)return r-1;return i-1}if(e<0){for(let r=1;r<i;++r)if(n[r]<=t)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==t)return r;if(n[r]<t)return n[r-1]-t<t-n[r]?r-1:r}return i-1}function n0(n,t,e){for(;t<e;){const i=n[t];n[t]=n[e],n[e]=i,++t,--e}}function Fe(n,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let r=0;r<i;r++)n[n.length]=e[r]}function ki(n,t){const e=n.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(n[i]!==t[i])return!1;return!0}function r0(n,t,e){const i=t||Ze;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function Mr(){return!0}function co(){return!1}function Pr(){}function bd(n){let t,e,i;return function(){const r=Array.prototype.slice.call(arguments);return(!e||this!==i||!ki(r,e))&&(i=this,e=r,t=n.apply(this,arguments)),t}}function s0(n){function t(){let e;try{e=n()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function Jr(n){for(const t in n)delete n[t]}function nn(n){let t;for(t in n)return!1;return!t}class ii{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class uo extends ho{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),r=i[t]||(i[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=e?new ii(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let c=0,h=r.length;c<h;++c)if("handleEvent"in r[c]?l=r[c].handleEvent(s):l=r[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let c=a[i];for(delete a[i];c--;)this.removeEventListener(i,Pr);delete o[i]}return l}disposeInternal(){this.listeners_&&Jr(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const r=i.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[r]=Pr,++this.pendingRemovals_[t]):(i.splice(r,1),i.length===0&&delete this.listeners_[t]))}}function wt(n,t,e,i,r){if(r){const o=e;e=function(a){return n.removeEventListener(t,e),o.call(i??this,a)}}else i&&i!==n&&(e=e.bind(i));const s={target:n,type:t,listener:e};return n.addEventListener(t,e),s}function Fs(n,t,e,i){return wt(n,t,e,i,!0)}function It(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Jr(n))}class Qr extends uo{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(dt.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=wt(this,t[s],e);return r}return wt(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const r=t.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Fs(this,t[s],e)}else i=Fs(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)o0(i);else if(Array.isArray(t))for(let r=0,s=t.length;r<s;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}}Qr.prototype.on;Qr.prototype.once;Qr.prototype.un;function o0(n){if(Array.isArray(n))for(let t=0,e=n.length;t<e;++t)It(n[t]);else It(n)}function ht(){throw new Error("Unimplemented abstract method.")}let a0=0;function xt(n){return n.ol_uid||(n.ol_uid=String(++a0))}class Jh extends ii{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}class Ge extends Qr{constructor(t){super(),this.on,this.once,this.un,xt(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new Jh(i,t,e)),i=Hn.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Jh(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const r=this.values_||(this.values_={});if(i)r[t]=e;else{const s=r[t];r[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],nn(this.values_)&&(this.values_=null),e||this.notify(t,i)}}}const Qh={LENGTH:"length"};class gs extends ii{constructor(t,e,i){super(t),this.element=e,this.index=i}}class De extends Ge{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let i=0,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Qh.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new gs(Jt.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new gs(Jt.REMOVE,e,t)),e}setAt(t,e){const i=this.getLength();if(t>=i){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new gs(Jt.REMOVE,r,t)),this.dispatchEvent(new gs(Jt.ADD,e,t))}updateLength_(){this.set(Qh.LENGTH,this.array_.length)}assertUnique_(t,e){for(let i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}}class In extends ii{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}}class di extends In{constructor(t,e,i,r,s,o){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Dt={SINGLECLICK:"singleclick",CLICK:dt.CLICK,DBLCLICK:dt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},rn=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",l0=rn.includes("safari")&&!rn.includes("chrom");l0&&(rn.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(rn));const h0=rn.includes("webkit")&&!rn.includes("edge"),xd=rn.includes("macintosh"),c0=typeof devicePixelRatio<"u"?devicePixelRatio:1,Cd=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Td=typeof Image<"u"&&Image.prototype.decode,Sd=function(){let n=!1;try{const t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return n}(),Ga={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class u0 extends uo{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=wt(i,Ga.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=wt(i,Ga.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(dt.TOUCHMOVE,this.boundHandleTouchMove_,Sd?{passive:!1}:!1)}emulateClick_(t){let e=new di(Dt.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new di(Dt.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new di(Dt.SINGLECLICK,this.map_,t);this.dispatchEvent(i)},250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==Dt.POINTERUP||e.type==Dt.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==Dt.POINTERDOWN||e.type==Dt.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new di(Dt.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(It),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new di(Dt.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(wt(i,Dt.POINTERMOVE,this.handlePointerMove_,this),wt(i,Dt.POINTERUP,this.handlePointerUp_,this),wt(this.element_,Dt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(wt(this.element_.getRootNode(),Dt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new di(Dt.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new di(Dt.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(It(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(dt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(It(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(It),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const fi={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},jt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},ot={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Tt(n,t){if(!n)throw new Error(t)}const zs=1/0;class d0{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Jr(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(t){Tt(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=zs?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,r=e.length,s=e[t],o=i[t],a=t;for(;t<r>>1;){const l=this.getLeftChildIndex_(t),c=this.getRightChildIndex_(t),h=c<r&&i[c]<i[l]?c:l;e[t]=e[h],i[t]=i[h],t=h}e[t]=s,i[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,r=this.priorities_,s=i[e],o=r[e];for(;e>t;){const a=this.getParentIndex_(e);if(r[a]>o)i[e]=i[a],r[e]=r[a],e=a;else break}i[e]=s,r[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let r=0;const s=e.length;let o,a,l;for(a=0;a<s;++a)o=e[a],l=t(o),l==zs?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=l,e[r++]=o);e.length=r,i.length=r,this.heapify_()}}class f0 extends d0{constructor(t,e){super(i=>t.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(dt.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===ot.LOADED||i===ot.ERROR||i===ot.EMPTY){i!==ot.ERROR&&e.removeEventListener(dt.CHANGE,this.boundHandleTileChange_);const r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===ot.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function g0(n,t,e,i,r){if(!n||!(e in n.wantedTiles)||!n.wantedTiles[e][t.getKey()])return zs;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}const Ut={ANIMATING:0,INTERACTING:1},Ce={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function Ot(n,t,e){return Math.min(Math.max(n,t),e)}function _0(n,t,e,i,r,s){const o=r-e,a=s-i;if(o!==0||a!==0){const l=((n-e)*o+(t-i)*a)/(o*o+a*a);l>1?(e=r,i=s):l>0&&(e+=o*l,i+=a*l)}return qi(n,t,e,i)}function qi(n,t,e,i){const r=e-n,s=i-t;return r*r+s*s}function m0(n){const t=n.length;for(let i=0;i<t;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<t;a++){const l=Math.abs(n[a][i]);l>s&&(s=l,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<t;a++){const l=-n[a][i]/n[i][i];for(let c=i;c<t+1;c++)i==c?n[a][c]=0:n[a][c]+=l*n[i][c]}}const e=new Array(t);for(let i=t-1;i>=0;i--){e[i]=n[i][t]/n[i][i];for(let r=i-1;r>=0;r--)n[r][t]-=n[r][i]*e[i]}return e}function tc(n){return n*180/Math.PI}function wi(n){return n*Math.PI/180}function zn(n,t){const e=n%t;return e*t<0?e+t:e}function oe(n,t,e){return n+e*(t-n)}function fo(n,t){const e=Math.pow(10,t);return Math.round(n*e)/e}function _s(n,t){return Math.floor(fo(n,t))}function ms(n,t){return Math.ceil(fo(n,t))}function Ba(n,t,e){if(n>=t&&n<e)return n;const i=e-t;return((n-t)%i+i)%i+t}function ec(n,t,e){return function(i,r,s,o,a){if(!i)return;if(!r&&!t)return i;const l=t?0:s[0]*r,c=t?0:s[1]*r,h=a?a[0]:0,u=a?a[1]:0;let f=n[0]+l/2+h,d=n[2]-l/2+h,_=n[1]+c/2+u,g=n[3]-c/2+u;f>d&&(f=(d+f)/2,d=f),_>g&&(_=(g+_)/2,g=_);let m=Ot(i[0],f,d),p=Ot(i[1],_,g);if(o&&e&&r){const v=30*r;m+=-v*Math.log(1+Math.max(0,f-i[0])/v)+v*Math.log(1+Math.max(0,i[0]-d)/v),p+=-v*Math.log(1+Math.max(0,_-i[1])/v)+v*Math.log(1+Math.max(0,i[1]-g)/v)}return[m,p]}}function p0(n){return n}const zt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function ic(n){const t=we();for(let e=0,i=n.length;e<i;++e)Or(t,n[e]);return t}function xl(n,t,e){return e?(e[0]=n[0]-t,e[1]=n[1]-t,e[2]=n[2]+t,e[3]=n[3]+t,e):[n[0]-t,n[1]-t,n[2]+t,n[3]+t]}function Ad(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n.slice()}function hn(n,t,e){let i,r;return t<n[0]?i=n[0]-t:n[2]<t?i=t-n[2]:i=0,e<n[1]?r=n[1]-e:n[3]<e?r=e-n[3]:r=0,i*i+r*r}function Zn(n,t){return Cl(n,t[0],t[1])}function wr(n,t){return n[0]<=t[0]&&t[2]<=n[2]&&n[1]<=t[1]&&t[3]<=n[3]}function Cl(n,t,e){return n[0]<=t&&t<=n[2]&&n[1]<=e&&e<=n[3]}function Wa(n,t){const e=n[0],i=n[1],r=n[2],s=n[3],o=t[0],a=t[1];let l=zt.UNKNOWN;return o<e?l=l|zt.LEFT:o>r&&(l=l|zt.RIGHT),a<i?l=l|zt.BELOW:a>s&&(l=l|zt.ABOVE),l===zt.UNKNOWN&&(l=zt.INTERSECTING),l}function we(){return[1/0,1/0,-1/0,-1/0]}function Si(n,t,e,i,r){return r?(r[0]=n,r[1]=t,r[2]=e,r[3]=i,r):[n,t,e,i]}function ts(n){return Si(1/0,1/0,-1/0,-1/0,n)}function Id(n,t){const e=n[0],i=n[1];return Si(e,i,e,i,t)}function Tl(n,t,e,i,r){const s=ts(r);return Ld(s,n,t,e,i)}function Nr(n,t){return n[0]==t[0]&&n[2]==t[2]&&n[1]==t[1]&&n[3]==t[3]}function Rd(n,t){return t[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3]),n}function Or(n,t){t[0]<n[0]&&(n[0]=t[0]),t[0]>n[2]&&(n[2]=t[0]),t[1]<n[1]&&(n[1]=t[1]),t[1]>n[3]&&(n[3]=t[1])}function Ld(n,t,e,i,r){for(;e<i;e+=r)y0(n,t[e],t[e+1]);return n}function y0(n,t,e){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}function Od(n,t){let e;return e=t(go(n)),e||(e=t(_o(n)),e)||(e=t(mo(n)),e)||(e=t(cn(n)),e)?e:!1}function $a(n){let t=0;return po(n)||(t=At(n)*Vt(n)),t}function go(n){return[n[0],n[1]]}function _o(n){return[n[2],n[1]]}function Ai(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function E0(n,t){let e;if(t==="bottom-left")e=go(n);else if(t==="bottom-right")e=_o(n);else if(t==="top-left")e=cn(n);else if(t==="top-right")e=mo(n);else throw new Error("Invalid corner");return e}function ja(n,t,e,i,r){const[s,o,a,l,c,h,u,f]=kd(n,t,e,i);return Si(Math.min(s,a,c,u),Math.min(o,l,h,f),Math.max(s,a,c,u),Math.max(o,l,h,f),r)}function kd(n,t,e,i){const r=t*i[0]/2,s=t*i[1]/2,o=Math.cos(e),a=Math.sin(e),l=r*o,c=r*a,h=s*o,u=s*a,f=n[0],d=n[1];return[f-l+u,d-c-h,f-l-u,d-c+h,f+l-u,d+c+h,f+l+u,d+c-h,f-l+u,d-c-h]}function Vt(n){return n[3]-n[1]}function Ji(n,t,e){const i=e||we();return ie(n,t)?(n[0]>t[0]?i[0]=n[0]:i[0]=t[0],n[1]>t[1]?i[1]=n[1]:i[1]=t[1],n[2]<t[2]?i[2]=n[2]:i[2]=t[2],n[3]<t[3]?i[3]=n[3]:i[3]=t[3]):ts(i),i}function cn(n){return[n[0],n[3]]}function mo(n){return[n[2],n[3]]}function At(n){return n[2]-n[0]}function ie(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function po(n){return n[2]<n[0]||n[3]<n[1]}function v0(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n}function w0(n,t,e){let i=!1;const r=Wa(n,t),s=Wa(n,e);if(r===zt.INTERSECTING||s===zt.INTERSECTING)i=!0;else{const o=n[0],a=n[1],l=n[2],c=n[3],h=t[0],u=t[1],f=e[0],d=e[1],_=(d-u)/(f-h);let g,m;s&zt.ABOVE&&!(r&zt.ABOVE)&&(g=f-(d-c)/_,i=g>=o&&g<=l),!i&&s&zt.RIGHT&&!(r&zt.RIGHT)&&(m=d-(f-l)*_,i=m>=a&&m<=c),!i&&s&zt.BELOW&&!(r&zt.BELOW)&&(g=f-(d-a)/_,i=g>=o&&g<=l),!i&&s&zt.LEFT&&!(r&zt.LEFT)&&(m=d-(f-o)*_,i=m>=a&&m<=c)}return i}function Dd(n,t){const e=t.getExtent(),i=Ai(n);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){const r=At(e),o=Math.floor((i[0]-e[0])/r)*r;n[0]-=o,n[2]-=o}return n}function Md(n,t,e){if(t.canWrapX()){const i=t.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];Dd(n,t);const r=At(i);if(At(n)>r&&!e)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function b0(n,t){return n[0]+=+t[0],n[1]+=+t[1],n}function Gs(n,t){let e=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=t[i]){e=!1;break}return e}function Sl(n,t){const e=Math.cos(t),i=Math.sin(t),r=n[0]*e-n[1]*i,s=n[1]*e+n[0]*i;return n[0]=r,n[1]=s,n}function x0(n,t){return n[0]*=t,n[1]*=t,n}function Pd(n,t){if(t.canWrapX()){const e=At(t.getExtent()),i=C0(n,t,e);i&&(n[0]-=i*e)}return n}function C0(n,t,e){const i=t.getExtent();let r=0;return t.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(e=e||At(i),r=Math.floor((n[0]-i[0])/e)),r}function Nd(n){return Math.pow(n,3)}function ar(n){return 1-Nd(1-n)}function T0(n){return 3*n*n-2*n*n*n}function S0(n){return n}const A0=63710088e-1;function nc(n,t,e){e=e||A0;const i=wi(n[1]),r=wi(t[1]),s=(r-i)/2,o=wi(t[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Fd(...n){console.warn(...n)}const Al={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Il{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Al[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const es=6378137,Mn=Math.PI*es,I0=[-Mn,-Mn,Mn,Mn],R0=[-180,-85,180,85],ps=es*Math.log(Math.tan(Math.PI/2));class pn extends Il{constructor(t){super({code:t,units:"m",extent:I0,global:!0,worldExtent:R0,getPointResolution:function(e,i){return e/Math.cosh(i[1]/es)}})}}const rc=[new pn("EPSG:3857"),new pn("EPSG:102100"),new pn("EPSG:102113"),new pn("EPSG:900913"),new pn("http://www.opengis.net/def/crs/EPSG/0/3857"),new pn("http://www.opengis.net/gml/srs/epsg.xml#3857")];function L0(n,t,e,i){const r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let s=0;s<r;s+=i){t[s]=Mn*n[s]/180;let o=es*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>ps?o=ps:o<-ps&&(o=-ps),t[s+1]=o}return t}function O0(n,t,e,i){const r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let s=0;s<r;s+=i)t[s]=180*n[s]/Mn,t[s+1]=360*Math.atan(Math.exp(n[s+1]/es))/Math.PI-90;return t}const k0=6378137,sc=[-180,-90,180,90],D0=Math.PI*k0/180;class zi extends Il{constructor(t,e){super({code:t,units:"degrees",extent:sc,axisOrientation:e,global:!0,metersPerUnit:D0,worldExtent:sc})}}const oc=[new zi("CRS:84"),new zi("EPSG:4326","neu"),new zi("urn:ogc:def:crs:OGC:1.3:CRS84"),new zi("urn:ogc:def:crs:OGC:2:84"),new zi("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new zi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new zi("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ua={};function M0(n){return Ua[n]||Ua[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function P0(n,t){Ua[n]=t}let Gn={};function Fr(n,t,e){const i=n.getCode(),r=t.getCode();i in Gn||(Gn[i]={}),Gn[i][r]=e}function Zo(n,t){return n in Gn&&t in Gn[n]?Gn[n][t]:null}const Bs=.9996,ye=.00669438,yo=ye*ye,Eo=yo*ye,Xi=ye/(1-ye),ac=Math.sqrt(1-ye),qn=(1-ac)/(1+ac),zd=qn*qn,Rl=zd*qn,Ll=Rl*qn,Gd=Ll*qn,Bd=1-ye/4-3*yo/64-5*Eo/256,N0=3*ye/8+3*yo/32+45*Eo/1024,F0=15*yo/256+45*Eo/1024,z0=35*Eo/3072,G0=3/2*qn-27/32*Rl+269/512*Gd,B0=21/16*zd-55/32*Ll,W0=151/96*Rl-417/128*Gd,$0=1097/512*Ll,Ws=6378137;function j0(n,t,e){const i=n-5e5,o=(e.north?t:t-1e7)/Bs/(Ws*Bd),a=o+G0*Math.sin(2*o)+B0*Math.sin(4*o)+W0*Math.sin(6*o)+$0*Math.sin(8*o),l=Math.sin(a),c=l*l,h=Math.cos(a),u=l/h,f=u*u,d=f*f,_=1-ye*c,g=Math.sqrt(1-ye*c),m=Ws/g,p=(1-ye)/_,v=Xi*h**2,b=v*v,w=i/(m*Bs),x=w*w,A=x*w,I=A*w,O=I*w,L=O*w,M=a-u/p*(x/2-I/24*(5+3*f+10*v-4*b-9*Xi))+L/720*(61+90*f+298*v+45*d-252*Xi-3*b);let U=(w-A/6*(1+2*f+v)+O/120*(5-2*v+28*f-3*b+8*Xi+24*d))/h;return U=Ba(U+wi(Wd(e.number)),-Math.PI,Math.PI),[tc(U),tc(M)]}const lc=-80,hc=84,U0=-180,Y0=180;function X0(n,t,e){n=Ba(n,U0,Y0),t<lc?t=lc:t>hc&&(t=hc);const i=wi(t),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,l=a*a,c=wi(n),h=Wd(e.number),u=wi(h),f=Ws/Math.sqrt(1-ye*r**2),d=Xi*s**2,_=s*Ba(c-u,-Math.PI,Math.PI),g=_*_,m=g*_,p=m*_,v=p*_,b=v*_,w=Ws*(Bd*i-N0*Math.sin(2*i)+F0*Math.sin(4*i)-z0*Math.sin(6*i)),x=Bs*f*(_+m/6*(1-a+d)+v/120*(5-18*a+l+72*d-58*Xi))+5e5;let A=Bs*(w+f*o*(g/2+p/24*(5-a+9*d+4*d**2)+b/720*(61-58*a+l+600*d-330*Xi)));return e.north||(A+=1e7),[x,A]}function Wd(n){return(n-1)*6-180+3}const K0=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function $d(n){let t=0;for(const r of K0){const s=n.match(r);if(s){t=parseInt(s[1]);break}}if(!t)return null;let e=0,i=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(i=!0,e=t-32600),e?{number:e,north:i}:null}function cc(n,t){return function(e,i,r,s){const o=e.length;r=r>1?r:2,s=s??r,i||(r>2?i=e.slice():i=new Array(o));for(let a=0;a<o;a+=s){const l=e[a],c=e[a+1],h=n(l,c,t);i[a]=h[0],i[a+1]=h[1]}return i}}function V0(n){return $d(n)?new Il({code:n,units:"m"}):null}function H0(n){const t=$d(n.getCode());return t?{forward:cc(X0,t),inverse:cc(j0,t)}:null}const Z0=[H0],q0=[V0];let Ya=!0;function J0(n){Ya=!1}function Ol(n,t){if(t!==void 0){for(let e=0,i=n.length;e<i;++e)t[e]=n[e];t=t}else t=n.slice();return t}function Xa(n){P0(n.getCode(),n),Fr(n,n,Ol)}function Q0(n){n.forEach(Xa)}function Mt(n){if(typeof n!="string")return n;const t=M0(n);if(t)return t;for(const e of q0){const i=e(n);if(i)return i}return null}function uc(n,t,e,i){n=Mt(n);let r;const s=n.getPointResolutionFunc();if(s)r=s(t,e);else{const o=n.getUnits();if(o=="degrees"||i=="degrees")r=t;else{const a=Dl(n,Mt("EPSG:4326"));if(!a&&o!=="degrees")r=t*n.getMetersPerUnit();else{let c=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];c=a(c,c,2);const h=nc(c.slice(0,2),c.slice(2,4)),u=nc(c.slice(4,6),c.slice(6,8));r=(h+u)/2}const l=n.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function dc(n){Q0(n),n.forEach(function(t){n.forEach(function(e){t!==e&&Fr(t,e,Ol)})})}function tE(n,t,e,i){n.forEach(function(r){t.forEach(function(s){Fr(r,s,e),Fr(s,r,i)})})}function kl(n,t){return n?typeof n=="string"?Mt(n):n:Mt(t)}function eE(n){return function(t,e,i,r){const s=t.length;i=i!==void 0?i:2,r=r??i,e=e!==void 0?e:new Array(s);for(let o=0;o<s;o+=r){const a=n(t.slice(o,o+i)),l=a.length;for(let c=0,h=r;c<h;++c)e[o+c]=c>=l?t[o+c]:a[c]}return e}}function Os(n,t){if(n===t)return!0;const e=n.getUnits()===t.getUnits();return(n.getCode()===t.getCode()||Dl(n,t)===Ol)&&e}function Dl(n,t){const e=n.getCode(),i=t.getCode();let r=Zo(e,i);if(r)return r;let s=null,o=null;for(const l of Z0)s||(s=l(n)),o||(o=l(t));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=qo(s.inverse,o.forward);else{const l=Zo(e,a);l&&(r=qo(l,o.forward))}else{const l=Zo(a,i);l&&(r=qo(s.inverse,l))}return r&&(Xa(n),Xa(t),Fr(n,t,r)),r}function qo(n,t){return function(e,i,r,s){return i=n(e,i,r,s),t(i,i,r,s)}}function zr(n,t){const e=Mt(n),i=Mt(t);return Dl(e,i)}function jd(n,t,e){const i=zr(t,e);if(!i){const r=Mt(t).getCode(),s=Mt(e).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Ka(n,t){return n}function Ye(n,t){return Ya&&!Gs(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Ya=!1,Fd("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function Ud(n,t){return n}function _i(n,t){return n}function iE(){dc(rc),dc(oc),tE(oc,rc,L0,O0)}iE();new Array(6);function Ae(){return[1,0,0,1,0,0]}function nE(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function Gt(n,t){const e=t[0],i=t[1];return t[0]=n[0]*e+n[2]*i+n[4],t[1]=n[1]*e+n[3]*i+n[5],t}function ti(n,t,e,i,r,s,o,a){const l=Math.sin(s),c=Math.cos(s);return n[0]=i*c,n[1]=r*l,n[2]=-i*l,n[3]=r*c,n[4]=o*i*c-a*i*l+t,n[5]=o*r*l+a*r*c+e,n}function Yd(n,t){const e=rE(t);Tt(e!==0,"Transformation matrix cannot be inverted");const i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5];return n[0]=o/e,n[1]=-r/e,n[2]=-s/e,n[3]=i/e,n[4]=(s*l-o*a)/e,n[5]=-(i*l-r*a)/e,n}function rE(n){return n[0]*n[3]-n[1]*n[2]}const sE=[1e5,1e5,1e5,1e5,2,2];function oE(n){return"matrix("+n.join(", ")+")"}function fc(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function aE(n,t){const e=fc(n),i=fc(t);for(let r=0;r<6;++r)if(Math.round((e[r]-i[r])*sE[r])!==0)return!1;return!0}function bi(n,t,e,i,r,s,o){s=s||[],o=o||2;let a=0;for(let l=t;l<e;l+=i){const c=n[l],h=n[l+1];s[a++]=r[0]*c+r[2]*h+r[4],s[a++]=r[1]*c+r[3]*h+r[5];for(let u=2;u<o;u++)s[a++]=n[l+u]}return s&&s.length!=a&&(s.length=a),s}function Xd(n,t,e,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),c=s[0],h=s[1];let u=0;for(let f=t;f<e;f+=i){const d=n[f]-c,_=n[f+1]-h;o[u++]=c+d*a-_*l,o[u++]=h+d*l+_*a;for(let g=f+2;g<f+i;++g)o[u++]=n[g]}return o&&o.length!=u&&(o.length=u),o}function lE(n,t,e,i,r,s,o,a){a=a||[];const l=o[0],c=o[1];let h=0;for(let u=t;u<e;u+=i){const f=n[u]-l,d=n[u+1]-c;a[h++]=l+r*f,a[h++]=c+s*d;for(let _=u+2;_<u+i;++_)a[h++]=n[_]}return a&&a.length!=h&&(a.length=h),a}function hE(n,t,e,i,r,s,o){o=o||[];let a=0;for(let l=t;l<e;l+=i){o[a++]=n[l]+r,o[a++]=n[l+1]+s;for(let c=l+2;c<l+i;++c)o[a++]=n[c]}return o&&o.length!=a&&(o.length=a),o}const gc=Ae(),cE=[NaN,NaN];class Kd extends Ge{constructor(){super(),this.extent_=we(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=bd((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return ht()}closestPointXY(t,e,i,r){return ht()}containsXY(t,e){return this.closestPointXY(t,e,cE,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return ht()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&ts(e),this.extentRevision_=this.getRevision()}return v0(this.extent_,t)}rotate(t,e){ht()}scale(t,e,i){ht()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return ht()}getType(){return ht()}applyTransform(t){ht()}intersectsExtent(t){return ht()}translate(t,e){ht()}transform(t,e){const i=Mt(t),r=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),c=i.getWorldExtent(),h=Vt(c)/Vt(l);ti(gc,c[0],c[3],h,-h,0,0,0);const u=bi(s,0,s.length,a,gc,o),f=zr(i,e);return f?f(u,u,a):u}:zr(i,e);return this.applyTransform(r),this}}class un extends Kd{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Tl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return ht()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=_c(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){ht()}setLayout(t,e,i){let r;if(t)r=_c(t);else{for(let s=0;s<i;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=dn(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Xd(i,0,i.length,r,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=Ai(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();lE(r,0,r.length,s,t,e,i,r),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();hE(i,0,i.length,r,t,e,i),this.changed()}}}function dn(n){let t;return n==2?t="XY":n==3?t="XYZ":n==4&&(t="XYZM"),t}function _c(n){let t;return n=="XY"?t=2:n=="XYZ"||n=="XYM"?t=3:n=="XYZM"&&(t=4),t}function uE(n,t,e){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return bi(i,0,i.length,r,t,e)}function Vd(n,t,e,i){let r=0;const s=n[e-i],o=n[e-i+1];let a=0,l=0;for(;t<e;t+=i){const c=n[t]-s,h=n[t+1]-o;r+=l*c-a*h,a=c,l=h}return r/2}function Hd(n,t,e,i){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=Vd(n,t,a,i),t=a}return r}function dE(n,t,e,i){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=Hd(n,t,a,i),t=a[a.length-1]}return r}function mc(n,t,e,i,r,s,o){const a=n[t],l=n[t+1],c=n[e]-a,h=n[e+1]-l;let u;if(c===0&&h===0)u=t;else{const f=((r-a)*c+(s-l)*h)/(c*c+h*h);if(f>1)u=e;else if(f>0){for(let d=0;d<i;++d)o[d]=oe(n[t+d],n[e+d],f);o.length=i;return}else u=t}for(let f=0;f<i;++f)o[f]=n[u+f];o.length=i}function Ml(n,t,e,i,r){let s=n[t],o=n[t+1];for(t+=i;t<e;t+=i){const a=n[t],l=n[t+1],c=qi(s,o,a,l);c>r&&(r=c),s=a,o=l}return r}function Pl(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=Ml(n,t,a,i,r),t=a}return r}function fE(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=Pl(n,t,a,i,r),t=a[a.length-1]}return r}function Nl(n,t,e,i,r,s,o,a,l,c,h){if(t==e)return c;let u,f;if(r===0){if(f=qi(o,a,n[t],n[t+1]),f<c){for(u=0;u<i;++u)l[u]=n[t+u];return l.length=i,f}return c}h=h||[NaN,NaN];let d=t+i;for(;d<e;)if(mc(n,d-i,d,i,o,a,h),f=qi(o,a,h[0],h[1]),f<c){for(c=f,u=0;u<i;++u)l[u]=h[u];l.length=i,d+=i}else d+=i*Math.max((Math.sqrt(f)-Math.sqrt(c))/r|0,1);if(s&&(mc(n,e-i,t,i,o,a,h),f=qi(o,a,h[0],h[1]),f<c)){for(c=f,u=0;u<i;++u)l[u]=h[u];l.length=i}return c}function Fl(n,t,e,i,r,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,f=e.length;u<f;++u){const d=e[u];c=Nl(n,t,d,i,r,s,o,a,l,c,h),t=d}return c}function gE(n,t,e,i,r,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,f=e.length;u<f;++u){const d=e[u];c=Fl(n,t,d,i,r,s,o,a,l,c,h),t=d[d.length-1]}return c}function _E(n,t,e,i){for(let r=0,s=e.length;r<s;++r)n[t++]=e[r];return t}function vo(n,t,e,i){for(let r=0,s=e.length;r<s;++r){const o=e[r];for(let a=0;a<i;++a)n[t++]=o[a]}return t}function is(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=vo(n,t,e[o],i);r[s++]=l,t=l}return r.length=s,r}function Zd(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=is(n,t,e[o],i,r[s]);l.length===0&&(l[0]=t),r[s++]=l,t=l[l.length-1]}return r.length=s,r}function mi(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=t;o<e;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Gr(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=mi(n,t,l,i,r[s]),t=l}return r.length=s,r}function Va(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=l.length===1&&l[0]===t?[]:Gr(n,t,l,i,r[s]),t=l[l.length-1]}return r.length=s,r}function wo(n,t,e,i,r,s,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)s[o++]=n[t],s[o++]=n[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[t,e-i];let h=0;for(;c.length>0;){const u=c.pop(),f=c.pop();let d=0;const _=n[f],g=n[f+1],m=n[u],p=n[u+1];for(let v=f+i;v<u;v+=i){const b=n[v],w=n[v+1],x=_0(b,w,_,g,m,p);x>d&&(h=v,d=x)}d>r&&(l[(h-t)/i]=1,f+i<h&&c.push(f,h),h+i<u&&c.push(h,u))}for(let u=0;u<a;++u)l[u]&&(s[o++]=n[t+u*i],s[o++]=n[t+u*i+1]);return o}function qd(n,t,e,i,r,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=wo(n,t,h,i,r,s,o),a.push(o),t=h}return o}function ji(n,t){return t*Math.round(n/t)}function mE(n,t,e,i,r,s,o){if(t==e)return o;let a=ji(n[t],r),l=ji(n[t+1],r);t+=i,s[o++]=a,s[o++]=l;let c,h;do if(c=ji(n[t],r),h=ji(n[t+1],r),t+=i,t==e)return s[o++]=c,s[o++]=h,o;while(c==a&&h==l);for(;t<e;){const u=ji(n[t],r),f=ji(n[t+1],r);if(t+=i,u==c&&f==h)continue;const d=c-a,_=h-l,g=u-a,m=f-l;if(d*m==_*g&&(d<0&&g<d||d==g||d>0&&g>d)&&(_<0&&m<_||_==m||_>0&&m>_)){c=u,h=f;continue}s[o++]=c,s[o++]=h,a=c,l=h,c=u,h=f}return s[o++]=c,s[o++]=h,o}function zl(n,t,e,i,r,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=mE(n,t,h,i,r,s,o),a.push(o),t=h}return o}function pE(n,t,e,i,r,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l],u=[];o=zl(n,t,h,i,r,s,o,u),a.push(u),t=h[h.length-1]}return o}class Br extends un{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Br(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,r){return r<hn(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ml(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Nl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,r))}getArea(){return Vd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return mi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=wo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Br(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=vo(this.flatCoordinates,0,t,this.stride),this.changed()}}class Jn extends un{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Jn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){const s=this.flatCoordinates,o=qi(t,e,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Id(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Cl(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_E(this.flatCoordinates,0,t,this.stride),this.changed()}}function yE(n,t,e,i,r){return!Od(r,function(o){return!Ki(n,t,e,i,o[0],o[1])})}function Ki(n,t,e,i,r,s){let o=0,a=n[e-i],l=n[e-i+1];for(;t<e;t+=i){const c=n[t],h=n[t+1];l<=s?h>s&&(c-a)*(s-l)-(r-a)*(h-l)>0&&o++:h<=s&&(c-a)*(s-l)-(r-a)*(h-l)<0&&o--,a=c,l=h}return o!==0}function Gl(n,t,e,i,r,s){if(e.length===0||!Ki(n,t,e[0],i,r,s))return!1;for(let o=1,a=e.length;o<a;++o)if(Ki(n,e[o-1],e[o],i,r,s))return!1;return!0}function EE(n,t,e,i,r,s){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const l=e[o];if(Gl(n,t,l,i,r,s))return!0;t=l[l.length-1]}return!1}function Bl(n,t,e,i,r,s,o){let a,l,c,h,u,f,d;const _=r[s+1],g=[];for(let v=0,b=e.length;v<b;++v){const w=e[v];for(h=n[w-i],f=n[w-i+1],a=t;a<w;a+=i)u=n[a],d=n[a+1],(_<=f&&d<=_||f<=_&&_<=d)&&(c=(_-f)/(d-f)*(u-h)+h,g.push(c)),h=u,f=d}let m=NaN,p=-1/0;for(g.sort(Ze),h=g[0],a=1,l=g.length;a<l;++a){u=g[a];const v=Math.abs(u-h);v>p&&(c=(h+u)/2,Gl(n,t,e,i,c,_)&&(m=c,p=v)),h=u}return isNaN(m)&&(m=r[s]),o?(o.push(m,_,p),o):[m,_,p]}function Jd(n,t,e,i,r){let s=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];s=Bl(n,t,l,i,r,2*o,s),t=l[l.length-1]}return s}function Qd(n,t,e,i,r){let s;for(t+=i;t<e;t+=i)if(s=r(n.slice(t-i,t),n.slice(t,t+i)),s)return s;return!1}function bo(n,t,e,i,r,s){return s=s??Ld(we(),n,t,e,i),ie(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:Qd(n,t,e,i,function(o,a){return w0(r,o,a)}):!1}function vE(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){if(bo(n,t,e[s],i,r))return!0;t=e[s]}return!1}function tf(n,t,e,i,r){return!!(bo(n,t,e,i,r)||Ki(n,t,e,i,r[0],r[1])||Ki(n,t,e,i,r[0],r[3])||Ki(n,t,e,i,r[2],r[1])||Ki(n,t,e,i,r[2],r[3]))}function ef(n,t,e,i,r){if(!tf(n,t,e[0],i,r))return!1;if(e.length===1)return!0;for(let s=1,o=e.length;s<o;++s)if(yE(n,e[s-1],e[s],i,r)&&!bo(n,e[s-1],e[s],i,r))return!1;return!0}function wE(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(ef(n,t,a,i,r))return!0;t=a[a.length-1]}return!1}function bE(n,t,e,i){for(;t<e-i;){for(let r=0;r<i;++r){const s=n[t+r];n[t+r]=n[e-i+r],n[e-i+r]=s}t+=i,e-=i}}function Wl(n,t,e,i){let r=0,s=n[e-i],o=n[e-i+1];for(;t<e;t+=i){const a=n[t],l=n[t+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function $l(n,t,e,i,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=Wl(n,t,a,i);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=a}return!0}function nf(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!$l(n,t,a,i,r))return!1;a.length&&(t=a[a.length-1])}return!0}function $s(n,t,e,i,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=Wl(n,t,a,i);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&bE(n,t,a,i),t=a}return t}function Ha(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s)t=$s(n,t,e[s],i,r);return t}function xE(n,t){const e=[];let i=0,r=0,s;for(let o=0,a=t.length;o<a;++o){const l=t[o],c=Wl(n,i,l,2);if(s===void 0&&(s=c),c===s)e.push(t.slice(r,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[r])}r=o+1,i=l}return e}class Ii extends un{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Fe(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Ii(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<hn(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Pl(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Fl(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return Gl(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Hd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),$s(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Gr(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Ai(this.getExtent());this.flatInteriorPoint_=Bl(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Jn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Br(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=new Br(e.slice(s,l),t);r.push(c),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;$l(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=$s(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=zl(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Ii(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return ef(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=is(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function pc(n){if(po(n))throw new Error("Cannot create polygon from empty extent");const t=n[0],e=n[1],i=n[2],r=n[3],s=[t,e,t,r,i,r,i,e,t,e];return new Ii(s,"XY",[s.length])}function jl(n,t,e,i){const r=At(t)/e[0],s=Vt(t)/e[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function Ul(n,t,e){let i=Math.min(n,t);const r=50;return i*=Math.log(1+r*Math.max(0,n/t-1))/r+1,e&&(i=Math.max(i,e),i/=Math.log(1+r*Math.max(0,e/n-1))/r+1),Ot(i,e/2,t*2)}function CE(n,t,e,i){return t=t!==void 0?t:!0,function(r,s,o,a){if(r!==void 0){const l=n[0],c=n[n.length-1],h=e?jl(l,e,o,i):l;if(a)return t?Ul(r,h,c):Ot(r,c,h);const u=Math.min(h,r),f=Math.floor(bl(n,u,s));return n[f]>h&&f<n.length-1?n[f+1]:n[f]}}}function TE(n,t,e,i,r,s){return i=i!==void 0?i:!0,e=e!==void 0?e:0,function(o,a,l,c){if(o!==void 0){const h=r?jl(t,r,l,s):t;if(c)return i?Ul(o,h,e):Ot(o,e,h);const u=1e-9,f=Math.ceil(Math.log(t/h)/Math.log(n)-u),d=-a*(.5-u)+.5,_=Math.min(h,o),g=Math.floor(Math.log(t/_)/Math.log(n)+d),m=Math.max(f,g),p=t/Math.pow(n,m);return Ot(p,e,h)}}}function yc(n,t,e,i,r){return e=e!==void 0?e:!0,function(s,o,a,l){if(s!==void 0){const c=i?jl(n,i,a,r):n;return!e||!l?Ot(s,t,c):Ul(s,c,t)}}}function Yl(n){if(n!==void 0)return 0}function Ec(n){if(n!==void 0)return n}function SE(n){const t=2*Math.PI/n;return function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function AE(n){const t=wi(5);return function(e,i){return i||e===void 0?e:Math.abs(e)<=t?0:e}}const IE=42,Xl=256,Jo=0;class Oe extends Ge{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=kl(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&J0(),t.center&&(t.center=Ye(t.center,this.projection_)),t.extent&&(t.extent=_i(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in Ce)delete e[a];this.setProperties(e,!0);const i=LE(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const r=RE(t),s=i.constraint,o=OE(t);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const r=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-e[3]+e[1]-r[1]),a=s/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Ye(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Ye(r.anchor,this.getProjection())),e[i]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){const h=arguments[r];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(r===e){i&&ys(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;r<e;++r){const h=arguments[r],u={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||T0,callback:i};if(h.center&&(u.sourceCenter=o,u.targetCenter=h.center.slice(),o=u.targetCenter),h.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(h.zoom),a=u.targetResolution):h.resolution&&(u.sourceResolution=a,u.targetResolution=h.resolution,a=u.targetResolution),h.rotation!==void 0){u.sourceRotation=l;const f=zn(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+f,l=u.targetRotation}kE(u)?u.complete=!0:s+=u.duration,c.push(u)}this.animations_.push(c),this.setHint(Ut.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ut.ANIMATING]>0}getInteracting(){return this.hints_[Ut.INTERACTING]>0}cancelAnimations(){this.setHint(Ut.ANIMATING,-this.hints_[Ut.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){const r=this.animations_[e];if(r[0].callback&&ys(r[0].callback,!1),!t)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const c=t-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const u=l.easing(h);if(l.sourceCenter){const f=l.sourceCenter[0],d=l.sourceCenter[1],_=l.targetCenter[0],g=l.targetCenter[1];this.nextCenter_=l.targetCenter;const m=f+u*(_-f),p=d+u*(g-d);this.targetCenter_=[m,p]}if(l.sourceResolution&&l.targetResolution){const f=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const d=this.getViewportSize_(this.getRotation()),_=this.constraints_.resolution(f,0,d,!0);this.targetCenter_=this.calculateCenterZoom(_,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const f=u===1?zn(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const d=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(d,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(Ut.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&ys(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-e[0],r[1]-e[1]],Sl(i,t-this.getRotation()),b0(i,e)),i}calculateCenterZoom(t,e){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=e[0]-t*(e[0]-r[0])/s,a=e[1]-t*(e[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],r=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Ka(t,this.getProjection())}getCenterInternal(){return this.get(Ce.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return Ud(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();Tt(e,"The view center is not defined");const i=this.getResolution();Tt(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return Tt(r!==void 0,"The view rotation is not defined"),ja(e,i,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Ce.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(_i(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=At(t)/e[0],r=Vt(t)/e[1];return Math.max(i,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(e/i)/Math.log(t);return function(s){return e/Math.pow(t,s*r)}}getRotation(){return this.get(Ce.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/e;return function(o){return Math.log(i/o)/e/s}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=Qo(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],e,i)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,r;if(this.resolutions_){const s=bl(this.resolutions_,t,1);e=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(i/t)/Math.log(r)}getResolutionForZoom(t){var e;if((e=this.resolutions_)!=null&&e.length){if(this.resolutions_.length===1)return this.resolutions_[0];const i=Ot(Math.floor(t),0,this.resolutions_.length-2),r=this.resolutions_[i]/this.resolutions_[i+1];return this.resolutions_[i]/Math.pow(r,Ot(t-i,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(Tt(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){Tt(!po(t),"Cannot fit empty extent provided as `geometry`");const r=_i(t,this.getProjection());i=pc(r)}else if(t.getType()==="Circle"){const r=_i(t.getExtent(),this.getProjection());i=pc(r),i.rotate(this.getRotation(),Ai(r))}else i=t;this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),r=Math.sin(-e),s=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,c=-1/0,h=-1/0;for(let u=0,f=s.length;u<f;u+=o){const d=s[u]*i-s[u+1]*r,_=s[u]*r+s[u+1]*i;a=Math.min(a,d),l=Math.min(l,_),c=Math.max(c,d),h=Math.max(h,_)}return[a,l,c,h]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());const r=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),u=Math.cos(c),f=Ai(a);f[0]+=(r[1]-r[3])/2*l,f[1]+=(r[0]-r[2])/2*l;const d=f[0]*u-f[1]*h,_=f[1]*u+f[0]*h,g=this.getConstrainedCenter([d,_],l),m=e.callback?e.callback:Pr;e.duration!==void 0?this.animateInternal({resolution:l,center:g,duration:e.duration,easing:e.easing},m):(this.targetResolution_=l,this.targetCenter_=g,this.applyTargetState_(!1,!0),ys(m,!0))}centerOn(t,e,i){this.centerOnInternal(Ye(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Qo(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,r){let s;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),l=Qo(t,r,[a[0]/2+o[3],a[1]/2+o[0]],e,i);s=[t[0]-l[0],t[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Ka(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Ye(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,r,i);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Ye(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Ye(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(Ce.ROTATION)!==r&&this.set(Ce.ROTATION,r),this.get(Ce.RESOLUTION)!==o&&(this.set(Ce.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Ce.CENTER)||!Gs(this.get(Ce.CENTER),a))&&this.set(Ce.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const r=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!Gs(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:t,easing:ar,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ut.INTERACTING,1)}endInteraction(t,e,i){i=i&&Ye(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(Ut.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}}function ys(n,t){setTimeout(function(){n(t)},0)}function RE(n){if(n.extent!==void 0){const e=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return ec(n.extent,n.constrainOnlyCenter,e)}const t=kl(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,ec(e,!1,!1)}return p0}function LE(n){let t,e,i,o=n.minZoom!==void 0?n.minZoom:Jo,a=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,u=n.showFullExtent!==void 0?n.showFullExtent:!1,f=kl(n.projection,"EPSG:3857"),d=f.getExtent();let _=n.constrainOnlyCenter,g=n.extent;if(!c&&!g&&f.isGlobal()&&(_=!1,g=d),n.resolutions!==void 0){const m=n.resolutions;e=m[o],i=m[a]!==void 0?m[a]:m[m.length-1],n.constrainResolution?t=CE(m,h,!_&&g,u):t=yc(e,i,h,!_&&g,u)}else{const p=(d?Math.max(At(d),Vt(d)):360*Al.degrees/f.getMetersPerUnit())/Xl/Math.pow(2,Jo),v=p/Math.pow(2,28-Jo);e=n.maxResolution,e!==void 0?o=0:e=p/Math.pow(l,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=e/Math.pow(l,a):i=p/Math.pow(l,a):i=v),a=o+Math.floor(Math.log(e/i)/Math.log(l)),i=e/Math.pow(l,a-o),n.constrainResolution?t=TE(l,e,i,h,!_&&g,u):t=yc(e,i,h,!_&&g,u)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:o,zoomFactor:l}}function OE(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const e=n.constrainRotation;return e===void 0||e===!0?AE():e===!1?Ec:typeof e=="number"?SE(e):Ec}return Yl}function kE(n){return!(n.sourceCenter&&n.targetCenter&&!Gs(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function Qo(n,t,e,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,l=n[1]*s+n[0]*o;a+=(t[0]/2-e[0])*i,l+=(e[1]-t[1]/2)*i,o=-o;const c=a*s-l*o,h=l*s+a*o;return[c,h]}const Es="ol-hidden",xo="ol-unselectable",Kl="ol-control",vc="ol-collapsed",DE=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),wc=["style","variant","weight","size","lineHeight","family"],rf=function(n){const t=n.match(DE);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,r=wc.length;i<r;++i){const s=t[i+1];s!==void 0&&(e[wc[i]]=s)}return e.families=e.family.split(/,\s?/),e};function Ft(n,t,e,i){let r;return e&&e.length?r=e.shift():Cd?r=new OffscreenCanvas(n||300,t||300):r=document.createElement("canvas"),n&&(r.width=n),t&&(r.height=t),r.getContext("2d",i)}let ta;function js(){return ta||(ta=Ft(1,1)),ta}function Co(n){const t=n.canvas;t.width=1,t.height=1,n.clearRect(0,0,1,1)}function bc(n,t){const e=t.parentNode;e&&e.replaceChild(n,t)}function ME(n){for(;n.lastChild;)n.lastChild.remove()}function PE(n,t){const e=n.childNodes;for(let i=0;;++i){const r=e[i],s=t[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}class Vl extends Ge{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){var t;(t=this.element)==null||t.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){var e;this.map_&&((e=this.element)==null||e.remove());for(let i=0,r=this.listenerKeys.length;i<r;++i)It(this.listenerKeys[i]);if(this.listenerKeys.length=0,this.map_=t,t){const i=this.target_??t.getOverlayContainerStopEvent();this.element&&i.appendChild(this.element),this.render!==Pr&&this.listenerKeys.push(wt(t,fi.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class NE extends Vl{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=t.className!==void 0?t.className:"ol-attribution",i=t.tipLabel!==void 0?t.tipLabel:"Attributions",r=t.expandClassName!==void 0?t.expandClassName:e+"-expand",s=t.collapseLabel!==void 0?t.collapseLabel:"",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(dt.CLICK,this.handleClick_.bind(this),!1);const c=e+" "+xo+" "+Kl+(this.collapsed_&&this.collapsible_?" "+vc:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),i=new Set(e.flatMap(r=>r.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!e.some(s=>{var o;return((o=s.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(r)}return Array.from(i)}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(r=>s0(()=>r))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!ki(e,this.renderedAttributions_)){ME(this.ulElement_);for(let r=0,s=e.length;r<s;++r){const o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(vc),this.collapsed_?bc(this.collapseLabel_,this.label_):bc(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class FE extends Vl{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",i=t.label!==void 0?t.label:"",r=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(dt.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+xo+" "+Kl,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Es)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const i=e.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:ar}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Es);!s&&i===0?this.element.classList.add(Es):s&&i!==0&&this.element.classList.remove(Es)}this.label_.style.transform=r}this.rotation_=i}}class zE extends Vl{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",i=t.delta!==void 0?t.delta:1,r=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",s=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",c=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=r,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(dt.CLICK,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=s,u.setAttribute("type","button"),u.title=c,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(dt.CLICK,this.handleClick_.bind(this,-i),!1);const f=e+" "+xo+" "+Kl,d=this.element;d.className=f,d.appendChild(h),d.appendChild(u),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:ar})):i.setZoom(s)}}}function GE(n){n=n||{};const t=new De;return(n.zoom!==void 0?n.zoom:!0)&&t.push(new zE(n.zoomOptions)),(n.rotate!==void 0?n.rotate:!0)&&t.push(new FE(n.rotateOptions)),(n.attribution!==void 0?n.attribution:!0)&&t.push(new NE(n.attributionOptions)),t}class BE{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const r=this.points_[e+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const xc={ACTIVE:"active"};class ns extends Ge{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(xc.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(xc.ACTIVE,t)}setMap(t){this.map_=t}}function WE(n,t,e){const i=n.getCenterInternal();if(i){const r=[i[0]+t[0],i[1]+t[1]];n.animateInternal({duration:e!==void 0?e:250,easing:S0,center:n.getConstrainedCenter(r)})}}function Hl(n,t,e,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+t),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:e,duration:i!==void 0?i:250,easing:ar})}class $E extends ns{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==Dt.DBLCLICK){const i=t.originalEvent,r=t.map,s=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();Hl(a,o,s,this.duration_),i.preventDefault(),e=!0}return!e}}function Za(n){const t=arguments;return function(e){let i=!0;for(let r=0,s=t.length;r<s&&(i=i&&t[r](e),!!i);++r);return i}}const jE=function(n){const t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},UE=function(n){const t=n.map.getTargetElement(),e=t.getRootNode(),i=n.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(i):t.contains(i)},sf=function(n){const t=n.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?UE(n):!0},YE=Mr,of=function(n){const t=n.originalEvent;return t instanceof PointerEvent&&t.button==0&&!(h0&&xd&&t.ctrlKey)},af=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},XE=function(n){const t=n.originalEvent;return xd?t.metaKey:t.ctrlKey},KE=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},lf=function(n){const t=n.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},ea=function(n){const t=n.originalEvent;return t instanceof PointerEvent&&t.pointerType=="mouse"},VE=function(n){const t=n.originalEvent;return t instanceof PointerEvent&&t.isPrimary&&t.button===0};class rs extends ns{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Dt.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Dt.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Dt.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==Dt.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function Zl(n){const t=n.length;let e=0,i=0;for(let r=0;r<t;r++)e+=n[r].clientX,i+=n[r].clientY;return{clientX:e/t,clientY:i/t}}class HE extends rs{constructor(t){super({stopDown:co}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Za(af,VE);this.condition_=t.onFocusOnly?Za(sf,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,r=e.getEventPixel(Zl(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=t.map.getView();x0(s,a.getResolution()),Sl(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),l=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:ar})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const i=t.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class ZE extends rs{constructor(t){t=t||{},super({stopDown:co}),this.condition_=t.condition?t.condition:jE,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!ea(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===Yl)return;const r=e.getSize(),s=t.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return ea(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return ea(t)&&of(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class qE extends ho{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+i,r.top=Math.min(t[1],e[1])+i,r.width=Math.abs(e[0]-t[0])+i,r.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Ii([r])}getGeometry(){return this.geometry_}}const yn={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class fr extends ii{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}class JE extends rs{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new qE(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??of,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const r=i[0]-e[0],s=i[1]-e[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new fr(yn.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new fr(e?yn.BOXEND:yn.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new fr(yn.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new fr(yn.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new fr(yn.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}}class QE extends JE{constructor(t){t=t||{};const e=t.condition?t.condition:KE;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:ar})}}const Gi={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class tv extends ns{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return af(e)&&lf(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==dt.KEYDOWN){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==Gi.DOWN||r==Gi.LEFT||r==Gi.RIGHT||r==Gi.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;r==Gi.DOWN?c=-a:r==Gi.LEFT?l=-a:r==Gi.RIGHT?l=a:c=a;const h=[l,c];Sl(h,o.getRotation()),WE(o,h,this.duration_),i.preventDefault(),e=!0}}return!e}}class ev extends ns{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!XE(e)&&lf(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==dt.KEYDOWN||t.type==dt.KEYPRESS){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==="+"||r==="-")){const s=t.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();Hl(a,o,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}}class iv extends ns{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:YE;this.condition_=t.onFocusOnly?Za(sf,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==dt.WHEEL)return!0;const i=t.map,r=t.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let s;if(t.type==dt.WHEEL&&(s=r.deltaY,r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-Ot(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Hl(e,i,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class nv extends rs{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=co),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=s;const o=t.map,a=o.getView();a.getConstraints().rotation!==Yl&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Zl(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class rv extends rs{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=co),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const l=t.map,c=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Zl(this.targetPointers))),l.render(),c.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const i=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function sv(n){n=n||{};const t=new De,e=new BE(-.005,.05,100);return(n.altShiftDragRotate!==void 0?n.altShiftDragRotate:!0)&&t.push(new ZE),(n.doubleClickZoom!==void 0?n.doubleClickZoom:!0)&&t.push(new $E({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan!==void 0?n.dragPan:!0)&&t.push(new HE({onFocusOnly:n.onFocusOnly,kinetic:e})),(n.pinchRotate!==void 0?n.pinchRotate:!0)&&t.push(new nv),(n.pinchZoom!==void 0?n.pinchZoom:!0)&&t.push(new rv({duration:n.zoomDuration})),(n.keyboard!==void 0?n.keyboard:!0)&&(t.push(new tv),t.push(new ev({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom!==void 0?n.mouseWheelZoom:!0)&&t.push(new iv({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom!==void 0?n.shiftDragZoom:!0)&&t.push(new QE({duration:n.zoomDuration})),t}const St={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class hf extends Ge{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[St.OPACITY]=t.opacity!==void 0?t.opacity:1,Tt(typeof e[St.OPACITY]=="number","Layer opacity must be a number"),e[St.VISIBLE]=t.visible!==void 0?t.visible:!0,e[St.Z_INDEX]=t.zIndex,e[St.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[St.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[St.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[St.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=Ot(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return ht()}getLayerStatesArray(t){return ht()}getExtent(){return this.get(St.EXTENT)}getMaxResolution(){return this.get(St.MAX_RESOLUTION)}getMinResolution(){return this.get(St.MIN_RESOLUTION)}getMinZoom(){return this.get(St.MIN_ZOOM)}getMaxZoom(){return this.get(St.MAX_ZOOM)}getOpacity(){return this.get(St.OPACITY)}getSourceState(){return ht()}getVisible(){return this.get(St.VISIBLE)}getZIndex(){return this.get(St.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(St.EXTENT,t)}setMaxResolution(t){this.set(St.MAX_RESOLUTION,t)}setMinResolution(t){this.set(St.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(St.MAX_ZOOM,t)}setMinZoom(t){this.set(St.MIN_ZOOM,t)}setOpacity(t){Tt(typeof t=="number","Layer opacity must be a number"),this.set(St.OPACITY,t)}setVisible(t){this.set(St.VISIBLE,t)}setZIndex(t){this.set(St.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class gi extends ii{constructor(t,e){super(t),this.layer=e}}const ia={LAYERS:"layers"};class lr extends hf{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(ia.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new De(i.slice(),{unique:!0}):Tt(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new De(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(It),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(wt(t,Jt.ADD,this.handleLayersAdd_,this),wt(t,Jt.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(It);Jr(this.listenerKeys_);const e=t.getArray();for(let i=0,r=e.length;i<r;i++){const s=e[i];this.registerLayerListeners_(s),this.dispatchEvent(new gi("addlayer",s))}this.changed()}registerLayerListeners_(t){const e=[wt(t,Hn.PROPERTYCHANGE,this.handleLayerChange_,this),wt(t,dt.CHANGE,this.handleLayerChange_,this)];t instanceof lr&&e.push(wt(t,"addlayer",this.handleLayerGroupAdd_,this),wt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[xt(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new gi("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new gi("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new gi("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=xt(e);this.listenerKeys_[i].forEach(It),delete this.listenerKeys_[i],this.dispatchEvent(new gi("removelayer",e)),this.changed()}getLayers(){return this.get(ia.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new gi("removelayer",i[r]))}this.set(ia.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const r=this.getLayerState();let s=r.zIndex;!t&&r.zIndex===void 0&&(s=0);for(let o=i,a=e.length;o<a;o++){const l=e[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=Ji(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return e}getSourceState(){return"ready"}}const _e={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class To extends hf{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(St.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(St.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(It(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=wt(t,dt.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0)),this.clearRenderer()),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof Oe?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(e.layerStatesArray){if(r=e.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return ql(r,e.viewState)&&(!s||ie(s,e.extent))}getAttributions(t){var s;if(!this.isVisible(t))return[];const e=(s=this.getSource())==null?void 0:s.getAttributions();if(!e)return[];const i=t instanceof Oe?t.getViewStateAndExtent():t;let r=e(i);return Array.isArray(r)||(r=[r]),r}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(St.MAP,t)}getMapInternal(){return this.get(St.MAP)}setMap(t){this.mapPrecomposeKey_&&(It(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(It(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=wt(t,_e.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=wt(this,dt.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);Tt(!e.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}setSource(t){this.set(St.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function ql(n,t){if(!n.visible)return!1;const e=t.resolution;if(e<n.minResolution||e>=n.maxResolution)return!1;const i=t.zoom;return i>n.minZoom&&i<=n.maxZoom}function cf(n,t,e=0,i=n.length-1,r=ov){for(;i>e;){if(i-e>600){const l=i-e+1,c=t-e+1,h=Math.log(l),u=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*u*(l-u)/l)*(c-l/2<0?-1:1),d=Math.max(e,Math.floor(t-c*u/l+f)),_=Math.min(i,Math.floor(t+(l-c)*u/l+f));cf(n,t,d,_,r)}const s=n[t];let o=e,a=i;for(gr(n,e,t),r(n[i],s)>0&&gr(n,e,i);o<a;){for(gr(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[e],s)===0?gr(n,e,a):(a++,gr(n,a,i)),a<=t&&(e=a+1),t<=a&&(i=a-1)}}function gr(n,t,e){const i=n[t];n[t]=n[e],n[e]=i}function ov(n,t){return n<t?-1:n>t?1:0}let uf=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!ws(t,e))return i;const r=this.toBBox,s=[];for(;e;){for(let o=0;o<e.children.length;o++){const a=e.children[o],l=e.leaf?r(a):a;ws(t,l)&&(e.leaf?i.push(a):ra(t,l)?this._all(a,i):s.push(a))}e=s.pop()}return i}collides(t){let e=this.data;if(!ws(t,e))return!1;const i=[];for(;e;){for(let r=0;r<e.children.length;r++){const s=e.children[r],o=e.leaf?this.toBBox(s):s;if(ws(t,o)){if(e.leaf||ra(t,o))return!0;i.push(s)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Rn([]),this}remove(t,e){if(!t)return this;let i=this.data;const r=this.toBBox(t),s=[],o=[];let a,l,c;for(;i||s.length;){if(i||(i=s.pop(),l=s[s.length-1],a=o.pop(),c=!0),i.leaf){const h=av(t,i.children,e);if(h!==-1)return i.children.splice(h,1),s.push(i),this._condense(s),this}!c&&!i.leaf&&ra(i,r)?(s.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],c=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,r){const s=i-e+1;let o=this._maxEntries,a;if(s<=o)return a=Rn(t.slice(e,i+1)),En(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Rn([]),a.leaf=!1,a.height=r;const l=Math.ceil(s/o),c=l*Math.ceil(Math.sqrt(o));Cc(t,e,i,c,this.compareMinX);for(let h=e;h<=i;h+=c){const u=Math.min(h+c-1,i);Cc(t,h,u,l,this.compareMinY);for(let f=h;f<=u;f+=l){const d=Math.min(f+l-1,u);a.children.push(this._build(t,f,d,r-1))}}return En(a,this.toBBox),a}_chooseSubtree(t,e,i,r){for(;r.push(e),!(e.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let l=0;l<e.children.length;l++){const c=e.children[l],h=na(c),u=cv(t,c)-h;u<o?(o=u,s=h<s?h:s,a=c):u===o&&h<s&&(s=h,a=c)}e=a||e.children[0]}return e}_insert(t,e,i){const r=i?t:this.toBBox(t),s=[],o=this._chooseSubtree(r,this.data,e,s);for(o.children.push(t),xr(o,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)}_split(t,e){const i=t[e],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=Rn(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,En(i,this.toBBox),En(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)}_splitRoot(t,e){this.data=Rn([t,e]),this.data.height=t.height+1,this.data.leaf=!1,En(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let r,s=1/0,o=1/0;for(let a=e;a<=i-e;a++){const l=br(t,0,a,this.toBBox),c=br(t,a,i,this.toBBox),h=uv(l,c),u=na(l)+na(c);h<s?(s=h,r=a,o=u<o?u:o):h===s&&u<o&&(o=u,r=a)}return r||i-e}_chooseSplitAxis(t,e,i){const r=t.leaf?this.compareMinX:lv,s=t.leaf?this.compareMinY:hv,o=this._allDistMargin(t,e,i,r),a=this._allDistMargin(t,e,i,s);o<a&&t.children.sort(r)}_allDistMargin(t,e,i,r){t.children.sort(r);const s=this.toBBox,o=br(t,0,e,s),a=br(t,i-e,i,s);let l=vs(o)+vs(a);for(let c=e;c<i-e;c++){const h=t.children[c];xr(o,t.leaf?s(h):h),l+=vs(o)}for(let c=i-e-1;c>=e;c--){const h=t.children[c];xr(a,t.leaf?s(h):h),l+=vs(a)}return l}_adjustParentBBoxes(t,e,i){for(let r=i;r>=0;r--)xr(e[r],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():En(t[e],this.toBBox)}};function av(n,t,e){if(!e)return t.indexOf(n);for(let i=0;i<t.length;i++)if(e(n,t[i]))return i;return-1}function En(n,t){br(n,0,n.children.length,t,n)}function br(n,t,e,i,r){r||(r=Rn(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=t;s<e;s++){const o=n.children[s];xr(r,n.leaf?i(o):o)}return r}function xr(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function lv(n,t){return n.minX-t.minX}function hv(n,t){return n.minY-t.minY}function na(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function vs(n){return n.maxX-n.minX+(n.maxY-n.minY)}function cv(n,t){return(Math.max(t.maxX,n.maxX)-Math.min(t.minX,n.minX))*(Math.max(t.maxY,n.maxY)-Math.min(t.minY,n.minY))}function uv(n,t){const e=Math.max(n.minX,t.minX),i=Math.max(n.minY,t.minY),r=Math.min(n.maxX,t.maxX),s=Math.min(n.maxY,t.maxY);return Math.max(0,r-e)*Math.max(0,s-i)}function ra(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function ws(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function Rn(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Cc(n,t,e,i,r){const s=[t,e];for(;s.length;){if(e=s.pop(),t=s.pop(),e-t<=i)continue;const o=t+Math.ceil((e-t)/i/2)*i;cf(n,o,t,e,r),s.push(t,o,o,e)}}const Jl=[NaN,NaN,NaN,0];let sa;function dv(){return sa||(sa=Ft(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),sa}const fv=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,gv=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,_v=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,mv=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function bs(n,t){return n.endsWith("%")?Number(n.substring(0,n.length-1))/t:Number(n)}function kr(n){throw new Error('failed to parse "'+n+'" as color')}function df(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(gv)||n.match(fv)||n.match(_v);if(s){const o=s[4],a=100/255;return[Ot(bs(s[1],a)+.5|0,0,255),Ot(bs(s[2],a)+.5|0,0,255),Ot(bs(s[3],a)+.5|0,0,255),o!==void 0?Ot(bs(o,100),0,1):1]}kr(n)}if(n.startsWith("#")){if(mv.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let h=parseInt(s.substring(l,l+o),16);o===1&&(h+=h<<4),a[l/o]=h}return a[3]=a[3]/255,a}kr(n)}const t=dv();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=n,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=n,t.fillStyle===e&&kr(n));const i=t.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return df(i);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const r=Array.from(t.getImageData(0,0,1,1).data);return r[3]=fo(r[3]/255,3),r}function pv(n){return typeof n=="string"?n:th(n)}const yv=1024,_r={};let oa=0;function Ev(n){if(n.length===4)return n;const t=n.slice();return t[3]=1,t}function aa(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function la(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function ha(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function ca(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function Tc(n){const t=ha(n[0]),e=ha(n[1]),i=ha(n[2]),r=ca(t*.222488403+e*.716873169+i*.06060791),s=500*(ca(t*.452247074+e*.399439023+i*.148375274)-r),o=200*(r-ca(t*.016863605+e*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function vv(n){const t=(n[0]+16)/116,e=n[1],i=n[2]*Math.PI/180,r=la(t),s=la(t+e/500*Math.cos(i)),o=la(t-e/200*Math.sin(i)),a=aa(s*3.021973625-r*1.617392459-o*.404875592),l=aa(s*-.943766287+r*1.916279586+o*.027607165),c=aa(s*.069407491-r*.22898585+o*1.159737864);return[Ot(a+.5|0,0,255),Ot(l+.5|0,0,255),Ot(c+.5|0,0,255),n[3]]}function Ql(n){if(n==="none")return Jl;if(_r.hasOwnProperty(n))return _r[n];if(oa>=yv){let e=0;for(const i in _r)(e++&3)===0&&(delete _r[i],--oa)}const t=df(n);t.length!==4&&kr(n);for(const e of t)isNaN(e)&&kr(n);return _r[n]=t,++oa,t}function Qn(n){return Array.isArray(n)?n:Ql(n)}function th(n){let t=n[0];t!=(t|0)&&(t=t+.5|0);let e=n[1];e!=(e|0)&&(e=e+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+t+","+e+","+i+","+r+")"}function Sc(n){return n[0]>0&&n[1]>0}function wv(n,t,e){return e===void 0&&(e=[0,0]),e[0]=n[0]*t+.5|0,e[1]=n[1]*t+.5|0,e}function re(n,t){return Array.isArray(n)?n:(t===void 0?t=[n,n]:(t[0]=n,t[1]=n),t)}let fn=0;const Kt=1<<fn++,yt=1<<fn++,Qt=1<<fn++,Se=1<<fn++,sn=1<<fn++,Cr=1<<fn++,xs=Math.pow(2,fn)-1,eh={[Kt]:"boolean",[yt]:"number",[Qt]:"string",[Se]:"color",[sn]:"number[]",[Cr]:"size"},bv=Object.keys(eh).map(Number).sort(Ze);function xv(n){return n in eh}function Tr(n){const t=[];for(const e of bv)Sr(n,e)&&t.push(eh[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function Sr(n,t){return(n&t)===t}function ai(n,t){return n===t}class Nt{constructor(t,e){if(!xv(t))throw new Error(`literal expressions must have a specific type, got ${Tr(t)}`);this.type=t,this.value=e}}class Cv{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function ff(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Wt(n,t,e){switch(typeof n){case"boolean":{if(ai(t,Qt))return new Nt(Qt,n?"true":"false");if(!Sr(t,Kt))throw new Error(`got a boolean, but expected ${Tr(t)}`);return new Nt(Kt,n)}case"number":{if(ai(t,Cr))return new Nt(Cr,re(n));if(ai(t,Kt))return new Nt(Kt,!!n);if(ai(t,Qt))return new Nt(Qt,n.toString());if(!Sr(t,yt))throw new Error(`got a number, but expected ${Tr(t)}`);return new Nt(yt,n)}case"string":{if(ai(t,Se))return new Nt(Se,Ql(n));if(ai(t,Kt))return new Nt(Kt,!!n);if(!Sr(t,Qt))throw new Error(`got a string, but expected ${Tr(t)}`);return new Nt(Qt,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return Pv(n,t,e);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(ai(t,Cr)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Nt(Cr,n)}if(ai(t,Se)){if(n.length===3)return new Nt(Se,[...n,1]);if(n.length===4)return new Nt(Se,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Sr(t,sn))throw new Error(`got an array of numbers, but expected ${Tr(t)}`);return new Nt(sn,n)}const j={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},Tv={[j.Get]:lt(gt(1,1/0),Ac),[j.Var]:lt(gt(1,1),Sv),[j.Has]:lt(gt(1,1/0),Ac),[j.Id]:lt(Av,vn),[j.Concat]:lt(gt(2,1/0),bt(Qt)),[j.GeometryType]:lt(Iv,vn),[j.LineMetric]:lt(vn),[j.Resolution]:lt(ua,vn),[j.Zoom]:lt(ua,vn),[j.Time]:lt(ua,vn),[j.Any]:lt(gt(2,1/0),bt(Kt)),[j.All]:lt(gt(2,1/0),bt(Kt)),[j.Not]:lt(gt(1,1),bt(Kt)),[j.Equal]:lt(gt(2,2),bt(xs)),[j.NotEqual]:lt(gt(2,2),bt(xs)),[j.GreaterThan]:lt(gt(2,2),bt(yt)),[j.GreaterThanOrEqualTo]:lt(gt(2,2),bt(yt)),[j.LessThan]:lt(gt(2,2),bt(yt)),[j.LessThanOrEqualTo]:lt(gt(2,2),bt(yt)),[j.Multiply]:lt(gt(2,1/0),Ic),[j.Coalesce]:lt(gt(2,1/0),Ic),[j.Divide]:lt(gt(2,2),bt(yt)),[j.Add]:lt(gt(2,1/0),bt(yt)),[j.Subtract]:lt(gt(2,2),bt(yt)),[j.Clamp]:lt(gt(3,3),bt(yt)),[j.Mod]:lt(gt(2,2),bt(yt)),[j.Pow]:lt(gt(2,2),bt(yt)),[j.Abs]:lt(gt(1,1),bt(yt)),[j.Floor]:lt(gt(1,1),bt(yt)),[j.Ceil]:lt(gt(1,1),bt(yt)),[j.Round]:lt(gt(1,1),bt(yt)),[j.Sin]:lt(gt(1,1),bt(yt)),[j.Cos]:lt(gt(1,1),bt(yt)),[j.Atan]:lt(gt(1,2),bt(yt)),[j.Sqrt]:lt(gt(1,1),bt(yt)),[j.Match]:lt(gt(4,1/0),Rc,Lv),[j.Between]:lt(gt(3,3),bt(yt)),[j.Interpolate]:lt(gt(6,1/0),Rc,Ov),[j.Case]:lt(gt(3,1/0),Rv,kv),[j.In]:lt(gt(2,2),Dv),[j.Number]:lt(gt(1,1/0),bt(xs)),[j.String]:lt(gt(1,1/0),bt(xs)),[j.Array]:lt(gt(1,1/0),bt(yt)),[j.Color]:lt(gt(1,4),bt(yt)),[j.Band]:lt(gt(1,3),bt(yt)),[j.Palette]:lt(gt(2,2),Mv),[j.ToString]:lt(gt(1,1),bt(Kt|yt|Qt|Se))};function Ac(n,t,e){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Nt(yt,o);break}case"string":{r[s]=new Nt(Qt,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&e.properties.add(String(o))}return r}function Sv(n,t,e){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return e.variables.add(i),[new Nt(Qt,i)]}function Av(n,t,e){e.featureId=!0}function Iv(n,t,e){e.geometryType=!0}function ua(n,t,e){e.mapState=!0}function vn(n,t,e){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function gt(n,t){return function(e,i,r){const s=e[0],o=e.length-1;if(n===t){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>t){const a=t===1/0?`${n} or more`:`${n} to ${t}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function Ic(n,t,e){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Wt(n[s+1],t,e);r[s]=o}return r}function bt(n){return function(t,e,i){const r=t.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Wt(t[o+1],n,i);s[o]=a}return s}}function Rv(n,t,e){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function Rc(n,t,e){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function Lv(n,t,e){const i=n.length-1,r=Qt|yt|Kt,s=Wt(n[1],r,e),o=Wt(n[n.length-1],t,e),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const c=Wt(n[l+2],s.type,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Wt(n[l+3],o.type,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function Ov(n,t,e){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);r=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Nt(yt,r);let o;try{o=Wt(n[2],yt,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(n.length-3);for(let l=0;l<a.length;l+=2){try{const c=Wt(n[l+3],yt,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Wt(n[l+4],t,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function kv(n,t,e){const i=Wt(n[n.length-1],t,e),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Wt(n[s+1],Kt,e);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Wt(n[s+2],i.type,e);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function Dv(n,t,e){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Qt}else r=yt;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const l=Wt(i[a],r,e);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[Wt(n[1],r,e),...s]}function Mv(n,t,e){let i;try{i=Wt(n[1],yt,e)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=Wt(r[o],Se,e)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof Nt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function lt(...n){return function(t,e,i){const r=t[0];let s;for(let o=0;o<n.length;o++){const a=n[o](t,e,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new Cv(e,r,...s)}}function Pv(n,t,e){const i=n[0],r=Tv[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,t,e)}function gf(n){if(!n)return"";const t=n.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return gf(n.getGeometries()[0]);default:return""}}function _f(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function ni(n,t,e){const i=Wt(n,t,e);return Ie(i)}function Ie(n,t){if(n instanceof Nt){if(n.type===Se&&typeof n.value=="string"){const i=Ql(n.value);return function(){return i}}return function(){return n.value}}const e=n.operator;switch(e){case j.Number:case j.String:case j.Coalesce:return Nv(n);case j.Get:case j.Var:case j.Has:return Fv(n);case j.Id:return i=>i.featureId;case j.GeometryType:return i=>i.geometryType;case j.Concat:{const i=n.args.map(r=>Ie(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case j.Resolution:return i=>i.resolution;case j.Any:case j.All:case j.Between:case j.In:case j.Not:return Gv(n);case j.Equal:case j.NotEqual:case j.LessThan:case j.LessThanOrEqualTo:case j.GreaterThan:case j.GreaterThanOrEqualTo:return zv(n);case j.Multiply:case j.Divide:case j.Add:case j.Subtract:case j.Clamp:case j.Mod:case j.Pow:case j.Abs:case j.Floor:case j.Ceil:case j.Round:case j.Sin:case j.Cos:case j.Atan:case j.Sqrt:return Bv(n);case j.Case:return Wv(n);case j.Match:return $v(n);case j.Interpolate:return jv(n);case j.ToString:return Uv(n);default:throw new Error(`Unsupported operator ${e}`)}}function Nv(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ie(n.args[s]);switch(e){case j.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case j.Number:case j.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function Fv(n,t){const i=n.args[0].value;switch(n.operator){case j.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;o=o[h]}return o};case j.Var:return r=>r.variables[i];case j.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;if(!o||!Object.hasOwn(o,h))return!1;o=o[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function zv(n,t){const e=n.operator,i=Ie(n.args[0]),r=Ie(n.args[1]);switch(e){case j.Equal:return s=>i(s)===r(s);case j.NotEqual:return s=>i(s)!==r(s);case j.LessThan:return s=>i(s)<r(s);case j.LessThanOrEqualTo:return s=>i(s)<=r(s);case j.GreaterThan:return s=>i(s)>r(s);case j.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${e}`)}}function Gv(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ie(n.args[s]);switch(e){case j.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case j.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case j.Between:return s=>{const o=r[0](s),a=r[1](s),l=r[2](s);return o>=a&&o<=l};case j.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case j.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${e}`)}}function Bv(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ie(n.args[s]);switch(e){case j.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case j.Divide:return s=>r[0](s)/r[1](s);case j.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case j.Subtract:return s=>r[0](s)-r[1](s);case j.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const l=r[2](s);return o>l?l:o};case j.Mod:return s=>r[0](s)%r[1](s);case j.Pow:return s=>Math.pow(r[0](s),r[1](s));case j.Abs:return s=>Math.abs(r[0](s));case j.Floor:return s=>Math.floor(r[0](s));case j.Ceil:return s=>Math.ceil(r[0](s));case j.Round:return s=>Math.round(r[0](s));case j.Sin:return s=>Math.sin(r[0](s));case j.Cos:return s=>Math.cos(r[0](s));case j.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case j.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${e}`)}}function Wv(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Ie(n.args[r]);return r=>{for(let s=0;s<e-1;s+=2)if(i[s](r))return i[s+1](r);return i[e-1](r)}}function $v(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Ie(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<e-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[e-1](r)}}function jv(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Ie(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,l;for(let c=2;c<e;c+=2){const h=i[c](r);let u=i[c+1](r);const f=Array.isArray(u);if(f&&(u=Ev(u)),h>=o)return c===2?u:f?Yv(s,o,a,l,h,u):Ar(s,o,a,l,h,u);a=h,l=u}return l}}function Uv(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Ie(n.args[s]);switch(e){case j.ToString:return s=>{const o=r[0](s);return n.args[0].type===Se?th(o):o.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function Ar(n,t,e,i,r,s){const o=r-e;if(o===0)return i;const a=t-e,l=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+l*(s-i)}function Yv(n,t,e,i,r,s){if(r-e===0)return i;const a=Tc(i),l=Tc(s);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const h=[Ar(n,t,e,a[0],r,l[0]),Ar(n,t,e,a[1],r,l[1]),a[2]+Ar(n,t,e,0,r,c),Ar(n,t,e,i[3],r,s[3])];return vv(h)}const _t={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Xv(n,t,e){const i=n;let r=!0,s=!1,o=!1;const a=[Fs(i,dt.LOAD,function(){o=!0,s||t()})];return i.src&&Td?(s=!0,i.decode().then(function(){r&&t()}).catch(function(l){r&&(o?t():e())})):a.push(Fs(i,dt.ERROR,e)),function(){r=!1,a.forEach(It)}}function Kv(n,t){return new Promise((e,i)=>{function r(){o(),e(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function Vv(n,t){return t&&(n.src=t),n.src&&Td?new Promise((e,i)=>n.decode().then(()=>e(n)).catch(r=>n.complete&&n.width?e(n):i(r))):Kv(n)}class Hv{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];(t++&3)===0&&!i.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const r=da(t,e,i);return r in this.cache_?this.cache_[r]:null}getPattern(t,e,i){const r=da(t,e,i);return r in this.patternCache_?this.patternCache_[r]:null}set(t,e,i,r,s){const o=da(t,e,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===_t.IDLE&&r.load(),r.getImageState()===_t.LOADING?r.ready().then(()=>{this.patternCache_[o]=js().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=js().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function da(n,t,e){const i=e?Qn(e):"null";return t+":"+n+":"+i}const me=new Hv;let mr=null;class mf extends uo{constructor(t,e,i,r,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?_t.IDLE:r,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===_t.LOADED){mr||(mr=Ft(1,1,void 0,{willReadFrequently:!0})),mr.drawImage(this.image_,0,0);try{mr.getImageData(0,0,1,1),this.tainted_=!1}catch{mr=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(dt.CHANGE)}handleImageError_(){this.imageState_=_t.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=_t.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Ft(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===_t.IDLE){this.image_||this.initializeImage_(),this.imageState_=_t.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Vv(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==_t.LOADED)return;const e=this.image_,i=Ft(Math.ceil(e.width*t),Math.ceil(e.height*t)),r=i.canvas;i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=pv(this.color_),i.fillRect(0,0,r.width/t,r.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=r}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===_t.LOADED||this.imageState_===_t.ERROR)t();else{const e=()=>{(this.imageState_===_t.LOADED||this.imageState_===_t.ERROR)&&(this.removeEventListener(dt.CHANGE,e),t())};this.addEventListener(dt.CHANGE,e)}})),this.ready_}}function ih(n,t,e,i,r,s){let o=t===void 0?void 0:me.get(t,e,r);return o||(o=new mf(n,n&&"src"in n?n.src||void 0:t,e,i,r),me.set(t,e,r,o,s)),s&&o&&!me.getPattern(t,e,r)&&me.set(t,e,r,o,s),o}function Me(n){return n?Array.isArray(n)?th(n):typeof n=="object"&&"src"in n?Zv(n):n:null}function Zv(n){if(!n.offset||!n.size)return me.getPattern(n.src,"anonymous",n.color);const t=n.src+":"+n.offset,e=me.getPattern(t,void 0,n.color);if(e)return e;const i=me.get(n.src,"anonymous",null);if(i.getImageState()!==_t.LOADED)return null;const r=Ft(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),ih(r.canvas,t,void 0,_t.LOADED,n.color,!0),me.getPattern(t,void 0,n.color)}const pf="10px sans-serif",te="#000",tr="round",qe=[],Je=0,er="round",Wr=10,$r="#000",jr="center",Us="middle",Vi=[0,0,0,0],Ur=1,Xe=new Ge;let Ln=null,qa;const Ja={},qv=function(){const t="32px ",e=["monospace","serif"],i=e.length,r="wmytzilWMYTZIL@#/&?$%10";let s,o;function a(c,h,u){let f=!0;for(let d=0;d<i;++d){const _=e[d];if(o=Ys(c+" "+h+" "+t+_,r),u!=_){const g=Ys(c+" "+h+" "+t+u+","+_,r);f=f&&g!=o}}return!!f}function l(){let c=!0;const h=Xe.getKeys();for(let u=0,f=h.length;u<f;++u){const d=h[u];if(Xe.get(d)<100){const[_,g,m]=d.split(`
`);a(_,g,m)?(Jr(Ja),Ln=null,qa=void 0,Xe.set(d,100)):(Xe.set(d,Xe.get(d)+1,!0),c=!1)}}c&&(clearInterval(s),s=void 0)}return function(c){const h=rf(c);if(!h)return;const u=h.families;for(let f=0,d=u.length;f<d;++f){const _=u[f],g=h.style+`
`+h.weight+`
`+_;Xe.get(g)===void 0&&(Xe.set(g,100,!0),a(h.style,h.weight,_)||(Xe.set(g,0,!0),s===void 0&&(s=setInterval(l,32))))}}}(),Jv=function(){let n;return function(t){let e=Ja[t];if(e==null){if(Cd){const i=rf(t),r=yf(t,"g");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=t,document.body.appendChild(n),e=n.offsetHeight,document.body.removeChild(n);Ja[t]=e}return e}}();function yf(n,t){return Ln||(Ln=Ft(1,1)),n!=qa&&(Ln.font=n,qa=Ln.font),Ln.measureText(t)}function Ys(n,t){return yf(n,t).width}function Lc(n,t,e){if(t in e)return e[t];const i=t.split(`
`).reduce((r,s)=>Math.max(r,Ys(n,s)),0);return e[t]=i,i}function Qv(n,t){const e=[],i=[],r=[];let s=0,o=0,a=0,l=0;for(let c=0,h=t.length;c<=h;c+=2){const u=t[c];if(u===`
`||c===h){s=Math.max(s,o),r.push(o),o=0,a+=l,l=0;continue}const f=t[c+1]||n.font,d=Ys(f,u);e.push(d),o+=d;const _=Jv(f);i.push(_),l=Math.max(l,_)}return{width:s,height:a,widths:e,heights:i,lineWidths:r}}function tw(n,t,e,i,r,s,o,a,l,c,h){n.save(),e!==1&&(n.globalAlpha===void 0?n.globalAlpha=u=>u.globalAlpha*=e:n.globalAlpha*=e),t&&n.transform.apply(n,t),i.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),ew(i,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,l,c,o*h[0],a*h[1]),n.restore()}function ew(n,t){const e=n.contextInstructions;for(let i=0,r=e.length;i<r;i+=2)Array.isArray(e[i+1])?t[e[i]].apply(t,e[i+1]):t[e[i]]=e[i+1]}class So{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=re(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new So({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return ht()}getImage(t){return ht()}getHitDetectionImage(){return ht()}getPixelRatio(t){return 1}getImageState(){return ht()}getImageSize(){return ht()}getOrigin(){return ht()}getSize(){return ht()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=re(t)}listenImageChange(t){ht()}load(){ht()}unlistenImageChange(t){ht()}ready(){return Promise.resolve()}}class Bt extends So{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?_t.LOADING:_t.LOADED,this.imageState_===_t.LOADING&&this.ready().then(()=>this.imageState_=_t.LOADED),this.render()}clone(){const t=this.getScale(),e=new Bt({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){var s,o;const e=(s=this.fill_)==null?void 0:s.getKey(),i=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let r=(o=me.get(i,null,null))==null?void 0:o.getImage(1);if(!r){const a=this.renderOptions_,l=Math.ceil(a.size*t),c=Ft(l,l);this.draw_(a,c,t),r=c.canvas,me.set(i,null,null,new mf(r,void 0,null,_t.LOADED,null))}return r}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const A=r;r=s,s=A}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),h=r-c,u=Math.sqrt(l*l+h*h),f=u/l;if(t==="miter"&&f<=i)return f*e;const d=e/2/f,_=e/2*(h/u),m=Math.sqrt((r+d)*(r+d)+_*_)-r;if(this.radius2_===void 0||t==="bevel")return m*2;const p=r*Math.sin(a),v=Math.sqrt(r*r-p*p),b=s-v,x=Math.sqrt(p*p+b*b)/p;if(x<=i){const A=x*e/2-s-r;return 2*Math.max(m,A)}return m*2}createRenderOptions(){let t=tr,e=er,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=Me(this.stroke_.getColor()??$r),a=this.stroke_.getWidth()??Ur,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??er,t=this.stroke_.getLineCap()??tr,i=this.stroke_.getMiterLimit()??Wr);const l=this.calculateLineJoinSize_(e,a,i),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:h,lineCap:t,lineDash:r,lineDashOffset:s,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let r=this.fill_.getColor();r===null&&(r=te),e.fillStyle=Me(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=Qn(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(e=Ft(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=s+a*o,c=a%2===0?i:r;t.lineTo(c*Math.cos(l),c*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=te,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Ao extends Bt{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Ao({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}class ut{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new ut({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=ih(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===_t.IDLE&&e.load(),e.getImageState()===_t.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?xt(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:Qn(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function Oc(n,t,e,i){return e!==void 0&&i!==void 0?[e/n,i/t]:e!==void 0?e/n:i!==void 0?i/t:1}class Io extends So{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,r=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:r,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;let a=t.src;Tt(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||xt(o)),Tt(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),Tt(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=_t.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?_t.LOADED:_t.IDLE:l=_t.LOADING:l=_t.LOADED),this.color_=t.color!==void 0?Qn(t.color):null,this.iconImage_=ih(o,a,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let c,h;if(t.size)[c,h]=t.size;else{const u=this.getImage(1);if(u.width&&u.height)c=u.width,h=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=t;const f=()=>{if(this.unlistenImageChange(f),!this.initialOptions_)return;const d=this.iconImage_.getSize();this.setScale(Oc(d[0],d[1],t.width,t.height))};this.listenImageChange(f);return}}c!==void 0&&this.setScale(Oc(c,h,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Io({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=r[0]),this.anchorYUnits_=="fraction"&&(t[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+r[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==_t.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==_t.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(dt.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(dt.CHANGE,t)}ready(){return this.iconImage_.ready()}}class Lt{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Lt({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}class at{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=kc,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new at({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=kc,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function iw(n){let t;if(typeof n=="function")t=n;else{let e;Array.isArray(n)?e=n:(Tt(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[n]),t=function(){return e}}return t}let fa=null;function Ef(n,t){if(!fa){const e=new ut({color:"rgba(255,255,255,0.4)"}),i=new Lt({color:"#3399CC",width:1.25});fa=[new at({image:new Ao({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return fa}function kc(n){return n.getGeometry()}const nw="#333";class nh{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=re(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new ut({color:nw}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new nh({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=re(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}function rw(n){return!0}function sw(n){const t=ff(),e=ow(n,t),i=_f();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,t.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return t.geometryType&&(i.geometryType=gf(r.getGeometry())),e(i)}}function Dc(n){const t=ff(),e=n.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=Qa(n[o],t);const r=_f(),s=new Array(e);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,t.featureId){const c=o.getId();c!==void 0?r.featureId=c:r.featureId=null}let l=0;for(let c=0;c<e;++c){const h=i[c](r);h&&(s[l]=h,l+=1)}return s.length=l,s}}function ow(n,t){const e=n.length,i=new Array(e);for(let r=0;r<e;++r){const s=n[r],o="filter"in s?ni(s.filter,Kt,t):rw;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=Qa(s.style[c],t)}else a=[Qa(s.style,t)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<e;++a){const l=i[a].filter;if(l(r)&&!(n[a].else&&o)){o=!0;for(const c of i[a].styles){const h=c(r);h&&s.push(h)}}}return s}}function Qa(n,t){const e=Yr(n,"",t),i=Xr(n,"",t),r=aw(n,t),s=lw(n,t),o=ne(n,"z-index",t);if(!e&&!i&&!r&&!s&&!nn(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new at;return function(l){let c=!0;if(e){const h=e(l);h&&(c=!1),a.setFill(h)}if(i){const h=i(l);h&&(c=!1),a.setStroke(h)}if(r){const h=r(l);h&&(c=!1),a.setText(h)}if(s){const h=s(l);h&&(c=!1),a.setImage(h)}return o&&a.setZIndex(o(l)),c?null:a}}function Yr(n,t,e){let i;if(t+"fill-pattern-src"in n)i=dw(n,t+"fill-",e);else{if(n[t+"fill-color"]==="none")return s=>null;i=rh(n,t+"fill-color",e)}if(!i)return null;const r=new ut;return function(s){const o=i(s);return o===Jl?null:(r.setColor(o),r)}}function Xr(n,t,e){const i=ne(n,t+"stroke-width",e),r=rh(n,t+"stroke-color",e);if(!i&&!r)return null;const s=Ke(n,t+"stroke-line-cap",e),o=Ke(n,t+"stroke-line-join",e),a=vf(n,t+"stroke-line-dash",e),l=ne(n,t+"stroke-line-dash-offset",e),c=ne(n,t+"stroke-miter-limit",e),h=new Lt;return function(u){if(r){const f=r(u);if(f===Jl)return null;h.setColor(f)}if(i&&h.setWidth(i(u)),s){const f=s(u);if(f!=="butt"&&f!=="round"&&f!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(f)}if(o){const f=o(u);if(f!=="bevel"&&f!=="round"&&f!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(f)}return a&&h.setLineDash(a(u)),l&&h.setLineDashOffset(l(u)),c&&h.setMiterLimit(c(u)),h}}function aw(n,t){const e="text-",i=Ke(n,e+"value",t);if(!i)return null;const r=Yr(n,e,t),s=Yr(n,e+"background-",t),o=Xr(n,e,t),a=Xr(n,e+"background-",t),l=Ke(n,e+"font",t),c=ne(n,e+"max-angle",t),h=ne(n,e+"offset-x",t),u=ne(n,e+"offset-y",t),f=Bn(n,e+"overflow",t),d=Ke(n,e+"placement",t),_=ne(n,e+"repeat",t),g=Ro(n,e+"scale",t),m=Bn(n,e+"rotate-with-view",t),p=ne(n,e+"rotation",t),v=Ke(n,e+"align",t),b=Ke(n,e+"justify",t),w=Ke(n,e+"baseline",t),x=Bn(n,e+"keep-upright",t),A=vf(n,e+"padding",t),I=Lo(n,e+"declutter-mode"),O=new nh({declutterMode:I});return function(L){if(O.setText(i(L)),r&&O.setFill(r(L)),s&&O.setBackgroundFill(s(L)),o&&O.setStroke(o(L)),a&&O.setBackgroundStroke(a(L)),l&&O.setFont(l(L)),c&&O.setMaxAngle(c(L)),h&&O.setOffsetX(h(L)),u&&O.setOffsetY(u(L)),f&&O.setOverflow(f(L)),d){const M=d(L);if(M!=="point"&&M!=="line")throw new Error("Expected point or line for text-placement");O.setPlacement(M)}if(_&&O.setRepeat(_(L)),g&&O.setScale(g(L)),m&&O.setRotateWithView(m(L)),p&&O.setRotation(p(L)),v){const M=v(L);if(M!=="left"&&M!=="center"&&M!=="right"&&M!=="end"&&M!=="start")throw new Error("Expected left, right, center, start, or end for text-align");O.setTextAlign(M)}if(b){const M=b(L);if(M!=="left"&&M!=="right"&&M!=="center")throw new Error("Expected left, right, or center for text-justify");O.setJustify(M)}if(w){const M=w(L);if(M!=="bottom"&&M!=="top"&&M!=="middle"&&M!=="alphabetic"&&M!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");O.setTextBaseline(M)}return A&&O.setPadding(A(L)),x&&O.setKeepUpright(x(L)),O}}function lw(n,t){return"icon-src"in n?hw(n,t):"shape-points"in n?cw(n,t):"circle-radius"in n?uw(n,t):null}function hw(n,t){const e="icon-",i=e+"src",r=wf(n[i],i),s=Xs(n,e+"anchor",t),o=Ro(n,e+"scale",t),a=ne(n,e+"opacity",t),l=Xs(n,e+"displacement",t),c=ne(n,e+"rotation",t),h=Bn(n,e+"rotate-with-view",t),u=Pc(n,e+"anchor-origin"),f=Nc(n,e+"anchor-x-units"),d=Nc(n,e+"anchor-y-units"),_=mw(n,e+"color"),g=gw(n,e+"cross-origin"),m=_w(n,e+"offset"),p=Pc(n,e+"offset-origin"),v=Ks(n,e+"width"),b=Ks(n,e+"height"),w=fw(n,e+"size"),x=Lo(n,e+"declutter-mode"),A=new Io({src:r,anchorOrigin:u,anchorXUnits:f,anchorYUnits:d,color:_,crossOrigin:g,offset:m,offsetOrigin:p,height:b,width:v,size:w,declutterMode:x});return function(I){return a&&A.setOpacity(a(I)),l&&A.setDisplacement(l(I)),c&&A.setRotation(c(I)),h&&A.setRotateWithView(h(I)),o&&A.setScale(o(I)),s&&A.setAnchor(s(I)),A}}function cw(n,t){const e="shape-",i=e+"points",r=e+"radius",s=tl(n[i],i),o=tl(n[r],r),a=Yr(n,e,t),l=Xr(n,e,t),c=Ro(n,e+"scale",t),h=Xs(n,e+"displacement",t),u=ne(n,e+"rotation",t),f=Bn(n,e+"rotate-with-view",t),d=Ks(n,e+"radius2"),_=Ks(n,e+"angle"),g=Lo(n,e+"declutter-mode"),m=new Bt({points:s,radius:o,radius2:d,angle:_,declutterMode:g});return function(p){return a&&m.setFill(a(p)),l&&m.setStroke(l(p)),h&&m.setDisplacement(h(p)),u&&m.setRotation(u(p)),f&&m.setRotateWithView(f(p)),c&&m.setScale(c(p)),m}}function uw(n,t){const e="circle-",i=Yr(n,e,t),r=Xr(n,e,t),s=ne(n,e+"radius",t),o=Ro(n,e+"scale",t),a=Xs(n,e+"displacement",t),l=ne(n,e+"rotation",t),c=Bn(n,e+"rotate-with-view",t),h=Lo(n,e+"declutter-mode"),u=new Ao({radius:5,declutterMode:h});return function(f){return s&&u.setRadius(s(f)),i&&u.setFill(i(f)),r&&u.setStroke(r(f)),a&&u.setDisplacement(a(f)),l&&u.setRotation(l(f)),c&&u.setRotateWithView(c(f)),o&&u.setScale(o(f)),u}}function ne(n,t,e){if(!(t in n))return;const i=ni(n[t],yt,e);return function(r){return tl(i(r),t)}}function Ke(n,t,e){if(!(t in n))return null;const i=ni(n[t],Qt,e);return function(r){return wf(i(r),t)}}function dw(n,t,e){const i=Ke(n,t+"pattern-src",e),r=Mc(n,t+"pattern-offset",e),s=Mc(n,t+"pattern-size",e),o=rh(n,t+"color",e);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function Bn(n,t,e){if(!(t in n))return null;const i=ni(n[t],Kt,e);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${t}`);return s}}function rh(n,t,e){if(!(t in n))return null;const i=ni(n[t],Se,e);return function(r){return bf(i(r),t)}}function vf(n,t,e){if(!(t in n))return null;const i=ni(n[t],sn,e);return function(r){return ss(i(r),t)}}function Xs(n,t,e){if(!(t in n))return null;const i=ni(n[t],sn,e);return function(r){const s=ss(i(r),t);if(s.length!==2)throw new Error(`Expected two numbers for ${t}`);return s}}function Mc(n,t,e){if(!(t in n))return null;const i=ni(n[t],sn,e);return function(r){return xf(i(r),t)}}function Ro(n,t,e){if(!(t in n))return null;const i=ni(n[t],sn|yt,e);return function(r){return pw(i(r),t)}}function Ks(n,t){const e=n[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function fw(n,t){const e=n[t];if(e!==void 0){if(typeof e=="number")return re(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function gw(n,t){const e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function Pc(n,t){const e=n[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function Nc(n,t){const e=n[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function _w(n,t){const e=n[t];if(e!==void 0)return ss(e,t)}function Lo(n,t){const e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function mw(n,t){const e=n[t];if(e!==void 0)return bf(e,t)}function ss(n,t){if(!Array.isArray(n))throw new Error(`Expected an array for ${t}`);const e=n.length;for(let i=0;i<e;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return n}function wf(n,t){if(typeof n!="string")throw new Error(`Expected a string for ${t}`);return n}function tl(n,t){if(typeof n!="number")throw new Error(`Expected a number for ${t}`);return n}function bf(n,t){if(typeof n=="string")return n;const e=ss(n,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function xf(n,t){const e=ss(n,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function pw(n,t){return typeof n=="number"?n:xf(n,t)}const Fc={RENDER_ORDER:"renderOrder"};class Cf extends To{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Fc.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter||(t.declutter[i]=new uf(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(Fc.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?Ef:t;const e=yw(t);this.styleFunction_=t===null?void 0:iw(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}}function yw(n){if(n===void 0)return Ef;if(!n)return null;if(typeof n=="function"||n instanceof at)return n;if(!Array.isArray(n))return Dc([n]);if(n.length===0)return[];const t=n.length,e=n[0];if(e instanceof at){const r=new Array(t);for(let s=0;s<t;++s){const o=n[s];if(!(o instanceof at))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in e){const r=new Array(t);for(let s=0;s<t;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return sw(r)}return Dc(n)}class Tf extends ii{constructor(t,e,i,r){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=r}}class Ew extends ho{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){ht()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;ti(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Yd(r,i)}forEachFeatureAtCoordinate(t,e,i,r,s,o,a,l){let c;const h=e.viewState;function u(w,x,A,I){return s.call(o,x,w?A:null,I)}const f=h.projection,d=Pd(t.slice(),f),_=[[0,0]];if(f.canWrapX()&&r){const w=f.getExtent(),x=At(w);_.push([-x,0],[x,0])}const g=e.layerStatesArray,m=g.length,p=[],v=[];for(let w=0;w<_.length;w++)for(let x=m-1;x>=0;--x){const A=g[x],I=A.layer;if(I.hasRenderer()&&ql(A,h)&&a.call(l,I)){const O=I.getRenderer(),L=I.getSource();if(O&&L){const M=L.getWrapX()?d:t,U=u.bind(null,A.managed);v[0]=M[0]+_[w][0],v[1]=M[1]+_[w][1],c=O.forEachFeatureAtCoordinate(v,e,i,U,p)}if(c)return c}}if(p.length===0)return;const b=1/p.length;return p.forEach((w,x)=>w.distanceSq+=x*b),p.sort((w,x)=>w.distanceSq-x.distanceSq),p.some(w=>c=w.callback(w.feature,w.layer,w.geometry)),c}hasFeatureAtCoordinate(t,e,i,r,s,o){return this.forEachFeatureAtCoordinate(t,e,i,r,Mr,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(t){ht()}scheduleExpireIconCache(t){me.canExpireCache()&&t.postRenderFunctions.push(vw)}}function vw(n,t){me.expire()}class ww extends Ew{constructor(t){super(t),this.fontChangeListenerKey_=wt(Xe,Hn.PROPERTYCHANGE,t.redrawText,t),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=xo+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const r=new Tf(t,void 0,e);i.dispatchEvent(r)}}disposeInternal(){It(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(_e.PRECOMPOSE,t);const e=t.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);e.some(a=>a.layer instanceof Cf&&a.layer.getDeclutter())&&(t.declutter={});const r=t.viewState;this.children_.length=0;const s=[];let o=null;for(let a=0,l=e.length;a<l;++a){const c=e[a];t.layerIndex=a;const h=c.layer,u=h.getSourceState();if(!ql(c,r)||u!="ready"&&u!="undefined"){h.unrender();continue}const f=h.render(t,o);f&&(f!==o&&(this.children_.push(f),o=f),s.push(c))}this.declutter(t,s),PE(this.element_,this.children_),this.dispatchRenderEvent(_e.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let i=e.length-1;i>=0;--i){const r=e[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(t,r)}e.forEach(i=>i.layer.renderDeferred(t))}}}function Sf(n){if(n instanceof To){n.setMapInternal(null);return}n instanceof lr&&n.getLayers().forEach(Sf)}function Af(n,t){if(n instanceof To){n.setMapInternal(t);return}if(n instanceof lr){const e=n.getLayers().getArray();for(let i=0,r=e.length;i<r;++i)Af(e[i],t)}}let bw=class extends Ge{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=xw(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:c0,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Ae(),this.pixelToCoordinateTransform_=Ae(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||GE(),this.interactions=e.interactions||sv({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new f0(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(jt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(jt.VIEW,this.handleViewChanged_),this.addChangeListener(jt.SIZE,this.handleSizeChanged_),this.addChangeListener(jt.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const i=this;t.view&&!(t.view instanceof Oe)&&t.view.then(function(r){i.setView(new Oe(r))}),this.controls.addEventListener(Jt.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Jt.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Jt.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Jt.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Jt.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Jt.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){Af(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Mr,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,e,null,o,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(r){i.push(r)},e),i}getAllLayers(){const t=[];function e(i){i.forEach(function(r){r instanceof lr?e(r.getLayers()):t.push(r)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const r=e.layerFilter!==void 0?e.layerFilter:Mr,s=e.hitTolerance!==void 0?e.hitTolerance:0,o=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(jt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Ka(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Gt(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(jt.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof De){e.setLayers(t);return}const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const r=t[e];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Ye(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Gt(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(jt.SIZE)}getView(){return this.get(jt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,r){return g0(this.frameState_,t,e,i,r)}handleBrowserEvent(t,e){e=e||t.type;const i=new di(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===Ga.POINTERDOWN||i===dt.WHEEL||i===dt.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=e.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,s=r;if(t){const o=t.viewHints;if(o[Ut.ANIMATING]||o[Ut.INTERACTING]){const a=Date.now()-t.time>8;r=a?0:8,s=a?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,s))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(_e.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(_e.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new In(fi.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new In(fi.LOADSTART,this,t))));const i=this.postRenderFunctions_;if(t)for(let r=0,s=i.length;r<s;++r)i[r](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)It(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(dt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(dt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new ww(this)),this.mapBrowserEventHandler_=new u0(this,this.moveTolerance_);for(const s in Dt)this.mapBrowserEventHandler_.addEventListener(Dt[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(dt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(dt.WHEEL,this.boundHandleBrowserEvent_,Sd?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const s=e.getRootNode();i=s instanceof ShadowRoot?s.host:e}this.targetChangeHandlerKeys_=[wt(i,dt.KEYDOWN,this.handleBrowserEvent,this),wt(i,dt.KEYPRESS,this.handleBrowserEvent,this)];const r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(It(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(It(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=wt(t,Hn.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=wt(t,dt.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(It),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new gi("addlayer",t)),this.layerGroupPropertyListenerKeys_=[wt(t,Hn.PROPERTYCHANGE,this.render,this),wt(t,dt.CHANGE,this.render,this),wt(t,"addlayer",this.handleLayerAdd_,this),wt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){Sf(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(e!==void 0&&Sc(e)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:ja(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:xt(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=ja(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!po(this.previousExtent_)&&!Nr(s.extent,this.previousExtent_))&&(this.dispatchEvent(new In(fi.MOVESTART,this,r)),this.previousExtent_=ts(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Ut.ANIMATING]&&!s.viewHints[Ut.INTERACTING]&&!Nr(s.extent,this.previousExtent_)&&(this.dispatchEvent(new In(fi.MOVEEND,this,s)),Ad(s.extent,this.previousExtent_))),this.dispatchEvent(new In(fi.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(fi.LOADSTART)||this.hasListener(fi.LOADEND)||this.hasListener(_e.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new gi("removelayer",e)),this.set(jt.LAYERGROUP,t)}setSize(t){this.set(jt.SIZE,t)}setTarget(t){this.set(jt.TARGET,t)}setView(t){if(!t||t instanceof Oe){this.set(jt.VIEW,t);return}this.set(jt.VIEW,new Oe);const e=this;t.then(function(i){e.setView(new Oe(i))})}updateSize(){const t=this.getTargetElement();let e;if(t){const r=getComputedStyle(t),s=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(e=[Math.max(0,s),Math.max(0,o)],!Sc(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Fd("No map visible because the map container's width or height are 0."))}const i=this.getSize();e&&(!i||!ki(e,i))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function xw(n){let t=null;n.keyboardEventTarget!==void 0&&(t=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const e={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new lr({layers:n.layers});e[jt.LAYERGROUP]=i,e[jt.TARGET]=n.target,e[jt.VIEW]=n.view instanceof Oe?n.view:new Oe;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new De(n.controls.slice()):(Tt(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new De(n.interactions.slice()):(Tt(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new De(n.overlays.slice()):(Tt(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new De,{controls:r,interactions:s,keyboardEventTarget:t,overlays:o,values:e}}class sh extends uo{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(dt.CHANGE)}release(){this.setState(ot.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==ot.EMPTY){if(this.state!==ot.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){ht()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(!i)i=e,this.transitionStarts_[t]=i;else if(i===-1)return 1;const r=e-i+1e3/60;return r>=this.transition_?1:Nd(r/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function el(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const Cw=new Error("disposed"),Tw=[256,256];class zc extends sh{constructor(t){const e=ot.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=el(this.data_);return t?[t.width,t.height]:Tw}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==ot.IDLE&&this.state!==ot.ERROR)return;this.state=ot.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=ot.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=ot.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(Cw),this.controller_=null),super.disposeInternal()}}class If extends sh{constructor(t,e,i,r,s,o){super(t,e,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=ot.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=ot.ERROR,this.unlistenImage_(),this.image_=Sw(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=ot.LOADED:this.state=ot.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==ot.ERROR&&(this.state=ot.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ot.IDLE&&(this.state=ot.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Xv(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function Sw(){const n=Ft(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}class oh{constructor(t,e,i,r){this.minX=t,this.maxX=e,this.minY=i,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function wn(n,t,e,i,r){return r!==void 0?(r.minX=n,r.maxX=t,r.minY=e,r.maxY=i,r):new oh(n,t,e,i)}let ga;const Wn=[];function Gc(n,t,e,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(t,e),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(t,i)+1,Math.max(e,r)),n.restore()}function _a(n,t){return Math.abs(n[t*4]-210)>2||Math.abs(n[t*4+3]-.75*255)>2}function Aw(){if(ga===void 0){const n=Ft(6,6,Wn);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",Gc(n,4,5,4,0),Gc(n,4,5,0,5);const t=n.getImageData(0,0,3,3).data;ga=_a(t,0)||_a(t,4)||_a(t,8),Co(n),Wn.push(n.canvas)}return ga}function Bc(n,t,e,i){const r=jd(e,t,n);let s=uc(t,i,e);const o=t.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const l=n.getExtent();if(!l||Zn(l,r)){const c=uc(n,s,r)/s;isFinite(c)&&c>0&&(s/=c)}return s}function Iw(n,t,e,i){const r=Ai(e);let s=Bc(n,t,r,i);return(!isFinite(s)||s<=0)&&Od(e,function(o){return s=Bc(n,t,o,i),isFinite(s)&&s>0}),s}function Rw(n,t,e,i,r,s,o,a,l,c,h,u,f,d){const _=Ft(Math.round(e*n),Math.round(e*t),Wn);if(u||(_.imageSmoothingEnabled=!1),l.length===0)return _.canvas;_.scale(e,e);function g(x){return Math.round(x*e)/e}_.globalCompositeOperation="lighter";const m=we();l.forEach(function(x,A,I){Rd(m,x.extent)});let p;const v=e/i,b=(u?1:1+Math.pow(2,-24))/v;p=Ft(Math.round(At(m)*v),Math.round(Vt(m)*v),Wn),u||(p.imageSmoothingEnabled=!1),l.forEach(function(x,A,I){if(x.image.width>0&&x.image.height>0){if(x.clipExtent){p.save();const T=(x.clipExtent[0]-m[0])*v,k=-(x.clipExtent[3]-m[3])*v,E=At(x.clipExtent)*v,F=Vt(x.clipExtent)*v;p.rect(u?T:Math.round(T),u?k:Math.round(k),u?E:Math.round(T+E)-Math.round(T),u?F:Math.round(k+F)-Math.round(k)),p.clip()}const O=(x.extent[0]-m[0])*v,L=-(x.extent[3]-m[3])*v,M=At(x.extent)*v,U=Vt(x.extent)*v;p.drawImage(x.image,c,c,x.image.width-2*c,x.image.height-2*c,u?O:Math.round(O),u?L:Math.round(L),u?M:Math.round(O+M)-Math.round(O),u?U:Math.round(L+U)-Math.round(L)),x.clipExtent&&p.restore()}});const w=cn(o);return a.getTriangles().forEach(function(x,A,I){const O=x.source,L=x.target;let M=O[0][0],U=O[0][1],T=O[1][0],k=O[1][1],E=O[2][0],F=O[2][1];const X=g((L[0][0]-w[0])/s),z=g(-(L[0][1]-w[1])/s),Z=g((L[1][0]-w[0])/s),B=g(-(L[1][1]-w[1])/s),Q=g((L[2][0]-w[0])/s),P=g(-(L[2][1]-w[1])/s),R=M,et=U;M=0,U=0,T-=R,k-=et,E-=R,F-=et;const J=[[T,k,0,0,Z-X],[E,F,0,0,Q-X],[0,0,T,k,B-z],[0,0,E,F,P-z]],K=m0(J);if(!K)return;if(_.save(),_.beginPath(),Aw()||!u){_.moveTo(Z,B);const pt=4,nt=X-Z,ct=z-B;for(let Et=0;Et<pt;Et++)_.lineTo(Z+g((Et+1)*nt/pt),B+g(Et*ct/(pt-1))),Et!=pt-1&&_.lineTo(Z+g((Et+1)*nt/pt),B+g((Et+1)*ct/(pt-1)));_.lineTo(Q,P)}else _.moveTo(Z,B),_.lineTo(X,z),_.lineTo(Q,P);_.clip(),_.transform(K[0],K[2],K[1],K[3],X,z),_.translate(m[0]-R,m[3]-et);let ft;if(p)ft=p.canvas,_.scale(b,-b);else{const pt=l[0],nt=pt.extent;ft=pt.image,_.scale(At(nt)/ft.width,-Vt(nt)/ft.height)}_.drawImage(ft,0,0),_.restore()}),p&&(Co(p),Wn.push(p.canvas)),h&&(_.save(),_.globalCompositeOperation="source-over",_.strokeStyle="black",_.lineWidth=1,a.getTriangles().forEach(function(x,A,I){const O=x.target,L=(O[0][0]-w[0])/s,M=-(O[0][1]-w[1])/s,U=(O[1][0]-w[0])/s,T=-(O[1][1]-w[1])/s,k=(O[2][0]-w[0])/s,E=-(O[2][1]-w[1])/s;_.beginPath(),_.moveTo(U,T),_.lineTo(L,M),_.lineTo(k,E),_.closePath(),_.stroke()}),_.restore()),_.canvas}const Lw=10,Wc=.25;class Ow{constructor(t,e,i,r,s,o,a){this.sourceProj_=t,this.targetProj_=e;let l={};const c=a?eE(b=>Gt(a,jd(b,this.targetProj_,this.sourceProj_))):zr(this.targetProj_,this.sourceProj_);this.transformInv_=function(b){const w=b[0]+"/"+b[1];return l[w]||(l[w]=c(b)),l[w]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&At(r)>=At(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?At(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?At(this.targetProj_.getExtent()):null;const h=cn(i),u=mo(i),f=_o(i),d=go(i),_=this.transformInv_(h),g=this.transformInv_(u),m=this.transformInv_(f),p=this.transformInv_(d),v=Lw+(o?Math.max(0,Math.ceil(Math.log2($a(i)/(o*o*256*256)))):0);if(this.addQuad_(h,u,f,d,_,g,m,p,v),this.wrapsXInSource_){let b=1/0;this.triangles_.forEach(function(w,x,A){b=Math.min(b,w.source[0][0],w.source[1][0],w.source[2][0])}),this.triangles_.forEach(w=>{if(Math.max(w.source[0][0],w.source[1][0],w.source[2][0])-b>this.sourceWorldWidth_/2){const x=[[w.source[0][0],w.source[0][1]],[w.source[1][0],w.source[1][1]],[w.source[2][0],w.source[2][1]]];x[0][0]-b>this.sourceWorldWidth_/2&&(x[0][0]-=this.sourceWorldWidth_),x[1][0]-b>this.sourceWorldWidth_/2&&(x[1][0]-=this.sourceWorldWidth_),x[2][0]-b>this.sourceWorldWidth_/2&&(x[2][0]-=this.sourceWorldWidth_);const A=Math.min(x[0][0],x[1][0],x[2][0]);Math.max(x[0][0],x[1][0],x[2][0])-A<this.sourceWorldWidth_/2&&(w.source=x)}})}l={}}addTriangle_(t,e,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[t,e,i]})}addQuad_(t,e,i,r,s,o,a,l,c){const h=ic([s,o,a,l]),u=this.sourceWorldWidth_?At(h)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&u>.5&&u<1;let _=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const m=ic([t,e,i,r]);_=At(m)/this.targetWorldWidth_>Wc||_}!d&&this.sourceProj_.isGlobal()&&u&&(_=u>Wc||_)}if(!_&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!ie(h,this.maxSourceExtent_))return;let g=0;if(!_&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)_=!0;else if(g=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),g!=1&&g!=2&&g!=4&&g!=8)return}if(c>0){if(!_){const m=[(t[0]+i[0])/2,(t[1]+i[1])/2],p=this.transformInv_(m);let v;d?v=(zn(s[0],f)+zn(a[0],f))/2-zn(p[0],f):v=(s[0]+a[0])/2-p[0];const b=(s[1]+a[1])/2-p[1];_=v*v+b*b>this.errorThresholdSquared_}if(_){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const m=[(e[0]+i[0])/2,(e[1]+i[1])/2],p=this.transformInv_(m),v=[(r[0]+t[0])/2,(r[1]+t[1])/2],b=this.transformInv_(v);this.addQuad_(t,e,m,v,s,o,p,b,c-1),this.addQuad_(v,m,i,r,b,p,a,l,c-1)}else{const m=[(t[0]+e[0])/2,(t[1]+e[1])/2],p=this.transformInv_(m),v=[(i[0]+r[0])/2,(i[1]+r[1])/2],b=this.transformInv_(v);this.addQuad_(t,m,v,r,s,p,b,l,c-1),this.addQuad_(m,e,i,v,p,o,a,b,c-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(g&11)==0&&this.addTriangle_(t,i,r,s,a,l),(g&14)==0&&this.addTriangle_(t,i,e,s,a,o),g&&((g&13)==0&&this.addTriangle_(e,r,t,o,l,s),(g&7)==0&&this.addTriangle_(e,r,i,o,l,a))}calculateSourceExtent(){const t=we();return this.triangles_.forEach(function(e,i,r){const s=e.source;Or(t,s[0]),Or(t,s[1]),Or(t,s[2])}),t}getTriangles(){return this.triangles_}}const kw=.5;class Rf extends sh{constructor(t,e,i,r,s,o,a,l,c,h,u,f){super(s,ot.IDLE,f),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const d=r.getTileCoordExtent(this.wrappedTileCoord_),_=this.targetTileGrid_.getExtent();let g=this.sourceTileGrid_.getExtent();const m=_?Ji(d,_):d;if($a(m)===0){this.state=ot.EMPTY;return}const p=t.getExtent();p&&(g?g=Ji(g,p):g=p);const v=r.getResolution(this.wrappedTileCoord_[0]),b=Iw(t,i,m,v);if(!isFinite(b)||b<=0){this.state=ot.EMPTY;return}const w=h!==void 0?h:kw;if(this.triangulation_=new Ow(t,i,m,g,b*w,v),this.triangulation_.getTriangles().length===0){this.state=ot.EMPTY;return}this.sourceZ_=e.getZForResolution(b);let x=this.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(x[1]=Ot(x[1],g[1],g[3]),x[3]=Ot(x[3],g[1],g[3])):x=Ji(x,g)),!$a(x))this.state=ot.EMPTY;else{let A=0,I=0;t.canWrapX()&&(A=At(p),I=Math.floor((x[0]-p[0])/A)),Md(x.slice(),t,!0).forEach(L=>{const M=e.getTileRangeForExtentAndZ(L,this.sourceZ_);for(let U=M.minX;U<=M.maxX;U++)for(let T=M.minY;T<=M.maxY;T++){const k=c(this.sourceZ_,U,T,a);if(k){const E=I*A;this.sourceTiles_.push({tile:k,offset:E})}}++I}),this.sourceTiles_.length===0&&(this.state=ot.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{var r;const i=e.tile;if(i&&i.getState()==ot.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);s[0]+=e.offset,s[2]+=e.offset;const o=(r=this.clipExtent_)==null?void 0:r.slice();o&&(o[0]+=e.offset,o[2]+=e.offset),t.push({extent:s,clipExtent:o,image:i.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=ot.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Rw(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=ot.LOADED}this.changed()}load(){if(this.state==ot.IDLE){this.state=ot.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(i==ot.IDLE||i==ot.LOADING){t++;const r=wt(e,dt.CHANGE,s=>{const o=e.getState();(o==ot.LOADED||o==ot.ERROR||o==ot.EMPTY)&&(It(r),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},i,r){e.getState()==ot.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(It),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Co(this.canvas_.getContext("2d")),Wn.push(this.canvas_),this.canvas_=null),super.release()}}class Dw{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof ho&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return Tt(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return Tt(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.key_;return t}getValues(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){var e;return(e=this.entries_[t])==null?void 0:e.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){Tt(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}}function Vs(n,t,e,i){return i!==void 0?(i[0]=n,i[1]=t,i[2]=e,i):[n,t,e]}function Mw(n,t,e){return n+"/"+t+"/"+e}function Pw(n){return Nw(n[0],n[1],n[2])}function Nw(n,t,e){return(t<<n)+e}function Fw(n,t){const e=n[0],i=n[1],r=n[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const s=t.getFullTileRange(e);return s?s.containsXY(i,r):!0}class Lf{constructor(){_h(this,"pushMethodArgs_",(...t)=>(this.push_(t),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(js(),{get:(t,e)=>{if(typeof js()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,i)=>(this.push_(e,i),!0)})}push_(...t){const e=this.instructions_,i=this.zIndex+this.offset_;e[i]||(e[i]=[]),e[i].push(...t)}pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,r=e.length;i<r;++i){const s=e[i];if(typeof s=="function"){s(t);continue}const o=e[++i];if(typeof t[s]=="function")t[s](...o);else{if(typeof o=="function"){t[s]=o(t);continue}t[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const zw=5;class Gw extends Qr{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=zw}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return ht()}getData(t){return null}prepareFrame(t){return ht()}renderFrame(t,e){return ht()}forEachFeatureAtCoordinate(t,e,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===_t.LOADED||e.getState()===_t.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=_t.LOADED&&e!=_t.ERROR&&t.addEventListener(dt.CHANGE,this.boundHandleImageChange_),e==_t.IDLE&&(t.load(),e=t.getState()),e==_t.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const $c=[];let On=null;function Bw(){On=Ft(1,1,void 0,{willReadFrequently:!0})}class Of extends Gw{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=Ae(),this.pixelTransform=Ae(),this.inversePixelTransform=Ae(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){On||Bw(),On.clearRect(0,0,1,1);let r;try{On.drawImage(t,e,i,1,1,0,0,1,1),r=On.getImageData(0,0,1,1).data}catch{return On=null,null}return r}getBackground(t){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0}useContainer(t,e,i){const r=this.getLayer().getClassName();let s,o;if(t&&t.className===r&&(!i||t&&t.style.backgroundColor&&ki(Qn(t.style.backgroundColor),Qn(i)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&aE(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Ft();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const r=cn(i),s=mo(i),o=_o(i),a=go(i);Gt(e.coordinateToPixelTransform,r),Gt(e.coordinateToPixelTransform,s),Gt(e.coordinateToPixelTransform,o),Gt(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Gt(l,r),Gt(l,s),Gt(l,o),Gt(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const i=t.extent,r=t.viewState.resolution,s=t.viewState.rotation,o=t.pixelRatio,a=Math.round(At(i)/r*o),l=Math.round(Vt(i)/r*o);ti(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,s,-a/2,-l/2),Yd(this.inversePixelTransform,this.pixelTransform);const c=oE(this.pixelTransform);if(this.useContainer(e,c,this.getBackground(t)),!this.containerReused){const h=this.context.canvas;h.width!=a||h.height!=l?(h.width=a,h.height=l):this.context.clearRect(0,0,a,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(t,e,i){const r=this.getLayer();if(r.hasListener(t)){const s=new Tf(t,this.inversePixelTransform,i,e);r.dispatchEvent(s)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(_e.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(_e.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new Lf),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(_e.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(_e.POSTRENDER,this.context,t))}getRenderTransform(t,e,i,r,s,o,a){const l=s/2,c=o/2,h=r/e,u=-h,f=-t[0]+a,d=-t[1];return ti(this.tempTransform,l,c,h,u,-i,f,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function ma(n,t,e,i){return`${n},${Mw(t,e,i)}`}function pa(n,t,e){if(!(e in n))return n[e]=new Set([t]),!0;const i=n[e],r=i.has(t);return r||i.add(t),!r}function Ww(n,t,e){const i=n[e];return i?i.delete(t):!1}function jc(n,t){const e=n.layerStatesArray[n.layerIndex];e.extent&&(t=Ji(t,_i(e.extent,n.viewState.projection)));const i=e.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(t=Ji(t,r))}return t}class $w extends Of{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision_,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=we(),this.tempTileRange_=new oh(0,0,0,0),this.tempTileCoord_=Vs(0,0,0);const i=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new Dw(i),this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),l=ma(a.getKey(),t,e,i);let c;if(s.containsKey(l))c=s.get(l);else{if(c=a.getTile(t,e,i,r.pixelRatio,r.viewState.projection),!c)return null;s.set(l,c)}return c}getTile(t,e,i,r){const s=this.getOrCreateTile(t,e,i,r);return s||null}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),r=Gt(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!Zn(s,r))return null;const o=e.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(e.pixelRatio);for(let h=l.getZForResolution(o.resolution);h>=l.getMinZoom();--h){const u=l.getTileCoordForCoordAndZ(r,h),f=this.getTile(h,u[1],u[2],e);if(!f||f.getState()!==ot.LOADED)continue;const d=l.getOrigin(h),_=re(l.getTileSize(h)),g=l.getResolution(h);let m;if(f instanceof If||f instanceof Rf)m=f.getImage();else if(f instanceof zc){if(m=el(f.getData()),!m)continue}else continue;const p=Math.floor(c*((r[0]-d[0])/g-u[1]*_[0])),v=Math.floor(c*((d[1]-r[1])/g-u[2]*_[1])),b=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(m,p+b,v+b)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const i=e.getRevision();return this.renderedRevision_?this.renderedRevision_!==i&&(this.renderedRevision_=i,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedRevision_=i,!0}enqueueTiles(t,e,i,r,s){const o=t.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=xt(l);h in t.wantedTiles||(t.wantedTiles[h]={});const u=t.wantedTiles[h],f=a.getMapInternal(),d=Math.max(i-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),_=o.rotation,g=_?kd(o.center,o.resolution,_,t.size):void 0;for(let m=i;m>=d;--m){const p=c.getTileRangeForExtentAndZ(e,m,this.tempTileRange_),v=c.getResolution(m);for(let b=p.minX;b<=p.maxX;++b)for(let w=p.minY;w<=p.maxY;++w){if(_&&!c.tileCoordIntersectsViewport([m,b,w],g))continue;const x=this.getTile(m,b,w,t);if(!x||!pa(r,x,m))continue;const I=x.getKey();if(u[I]=!0,x.getState()===ot.IDLE&&!t.tileQueue.isKeyQueued(I)){const O=Vs(m,b,w,this.tempTileCoord_);t.tileQueue.enqueue([x,h,c.getTileCoordCenter(O),v])}}}}findStaleTile_(t,e){const i=this.tileCache_,r=t[0],s=t[1],o=t[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=ma(a[l],r,s,o);if(i.containsKey(c)){const h=i.peek(c);if(h.getState()===ot.LOADED)return h.endTransition(xt(this)),pa(e,h,r),!0}}return!1}findAltTiles_(t,e,i,r){const s=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,c=this.getLayer().getRenderSource().getKey();for(let h=s.minX;h<=s.maxX;++h)for(let u=s.minY;u<=s.maxY;++u){const f=ma(c,i,h,u);let d=!1;if(a.containsKey(f)){const _=a.peek(f);_.getState()===ot.LOADED&&(pa(r,_,i),d=!0)}d||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const i=t.layerStatesArray[t.layerIndex],r=t.viewState,s=r.projection,o=r.resolution,a=r.center,l=t.pixelRatio,c=this.getLayer(),h=c.getSource(),u=h.getTileGridForProjection(s),f=u.getZForResolution(o,h.zDirection),d=u.getResolution(f),_=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==_&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=_):this.renderedSourceKey_=_;let g=t.extent;const m=h.getTilePixelRatio(l);this.prepareContainer(t,e);const p=this.context.canvas.width,v=this.context.canvas.height,b=i.extent&&_i(i.extent);b&&(g=Ji(g,_i(i.extent)));const w=d*p/2/m,x=d*v/2/m,A=[a[0]-w,a[1]-x,a[0]+w,a[1]+x],I={};this.renderedTiles.length=0;const O=c.getPreload();if(t.nextExtent){const Z=u.getZForResolution(r.nextResolution,h.zDirection),B=jc(t,t.nextExtent);this.enqueueTiles(t,B,Z,I,O)}const L=jc(t,g);if(this.enqueueTiles(t,L,f,I,0),O>0&&setTimeout(()=>{this.enqueueTiles(t,L,f-1,I,O-1)},0),!(f in I))return this.container;const M=xt(this),U=t.time;for(const Z of I[f]){const B=Z.getState();if(B===ot.EMPTY)continue;const Q=Z.tileCoord;if(B===ot.LOADED&&Z.getAlpha(M,U)===1){Z.endTransition(M);continue}if(B!==ot.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Q,I)){Ww(I,Z,f),t.animate=!0;continue}if(this.findAltTiles_(u,Q,f+1,I))continue;const et=u.getMinZoom();for(let J=f-1;J>=et&&!this.findAltTiles_(u,Q,J,I);--J);}const T=d/o*l/m,k=this.getRenderContext(t);ti(this.tempTransform,p/2,v/2,T,T,0,-p/2,-v/2),i.extent&&this.clipUnrotated(k,t,b),h.getInterpolate()||(k.imageSmoothingEnabled=!1),this.preRender(k,t);const E=Object.keys(I).map(Number);E.sort(Ze);let F;const X=[],z=[];for(let Z=E.length-1;Z>=0;--Z){const B=E[Z],Q=h.getTilePixelSize(B,l,s),R=u.getResolution(B)/d,et=Q[0]*R*T,J=Q[1]*R*T,K=u.getTileCoordForCoordAndZ(cn(A),B),ft=u.getTileCoordExtent(K),pt=Gt(this.tempTransform,[m*(ft[0]-A[0])/d,m*(A[3]-ft[3])/d]),nt=m*h.getGutterForProjection(s);for(const ct of I[B]){if(ct.getState()!==ot.LOADED)continue;const Et=ct.tileCoord,Ct=K[1]-Et[1],$t=Math.round(pt[0]-(Ct-1)*et),Pt=K[2]-Et[2],y=Math.round(pt[1]-(Pt-1)*J),W=Math.round(pt[0]-Ct*et),G=Math.round(pt[1]-Pt*J),S=$t-W,C=y-G,D=E.length===1;let $=!1;F=[W,G,W+S,G,W+S,G+C,W,G+C];for(let Y=0,N=X.length;Y<N;++Y)if(!D&&B<z[Y]){const V=X[Y];ie([W,G,W+S,G+C],[V[0],V[3],V[4],V[7]])&&($||(k.save(),$=!0),k.beginPath(),k.moveTo(F[0],F[1]),k.lineTo(F[2],F[3]),k.lineTo(F[4],F[5]),k.lineTo(F[6],F[7]),k.moveTo(V[6],V[7]),k.lineTo(V[4],V[5]),k.lineTo(V[2],V[3]),k.lineTo(V[0],V[1]),k.clip())}X.push(F),z.push(B),this.drawTile(ct,t,W,G,S,C,nt,D),$&&k.restore(),this.renderedTiles.unshift(ct),this.updateUsedTiles(t.usedTiles,h,ct)}}if(this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!Nr(this.renderedExtent_,A),this.renderedExtent_=A,this.renderedPixelRatio=l,this.postRender(this.context,t),i.extent&&k.restore(),k.imageSmoothingEnabled=!0,this.renderComplete){const Z=(B,Q)=>{const P=xt(h),R=Q.wantedTiles[P],et=R?Object.keys(R).length:0;this.updateCacheSize(et),this.tileCache_.expireCache()};t.postRenderFunctions.push(Z)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,i,r,s,o,a,l){let c;if(t instanceof zc){if(c=el(t.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(t);if(!c)return;const h=this.getRenderContext(e),u=xt(this),f=e.layerStatesArray[e.layerIndex],d=f.opacity*(l?t.getAlpha(u,e.time):1),_=d!==h.globalAlpha;_&&(h.save(),h.globalAlpha=d),h.drawImage(c,a,a,c.width-2*a,c.height-2*a,i,r,s,o),_&&h.restore(),d!==f.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){const r=xt(e);r in t||(t[r]={}),t[r][i.getKey()]=!0}}const Cs={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class jw extends To{constructor(t){t=t||{};const e=Object.assign({},t),i=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Cs.PRELOAD)}setPreload(t){this.set(Cs.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(Cs.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(Cs.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}class Uw extends jw{constructor(t){super(t)}createRenderer(){return new $w(this,{cacheSize:this.getCacheSize()})}}class kf{drawCustom(t,e,i,r,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const rt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ts=[rt.FILL],pi=[rt.STROKE],Hi=[rt.BEGIN_PATH],Uc=[rt.CLOSE_PATH];class os extends kf{constructor(t,e,i,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=t.length;a<l;a+=e)r[0]=t[a],r[1]=t[a+1],Zn(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(t,e,i,r,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(e+=r);let h=t[e],u=t[e+1];const f=this.tmpCoordinate_;let d=!0,_,g,m;for(_=e+r;_<i;_+=r)f[0]=t[_],f[1]=t[_+1],m=Wa(c,f),m!==g?(d&&(a[l++]=h,a[l++]=u,d=!1),a[l++]=f[0],a[l++]=f[1]):m===zt.INTERSECTING?(a[l++]=f[0],a[l++]=f[1],d=!1):d=!0,h=f[0],u=f[1],g=m;return(s&&d||_===e+r)&&(a[l++]=h,a[l++]=u),l}drawCustomCoordinates_(t,e,i,r,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],c=this.appendFlatLineCoordinates(t,e,l,r,!1,!1);s.push(c),e=l}return e}drawCustom(t,e,i,r,s){this.beginGeometry(t,e,s);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let c,h,u,f,d;switch(o){case"MultiPolygon":c=t.getOrientedFlatCoordinates(),f=[];const _=t.getEndss();d=0;for(let g=0,m=_.length;g<m;++g){const p=[];d=this.drawCustomCoordinates_(c,d,_[g],a,p),f.push(p)}this.instructions.push([rt.CUSTOM,l,f,t,i,Va,s]),this.hitDetectionInstructions.push([rt.CUSTOM,l,f,t,r||i,Va,s]);break;case"Polygon":case"MultiLineString":u=[],c=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(c,0,t.getEnds(),a,u),this.instructions.push([rt.CUSTOM,l,u,t,i,Gr,s]),this.hitDetectionInstructions.push([rt.CUSTOM,l,u,t,r||i,Gr,s]);break;case"LineString":case"Circle":c=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([rt.CUSTOM,l,h,t,i,mi,s]),this.hitDetectionInstructions.push([rt.CUSTOM,l,h,t,r||i,mi,s]);break;case"MultiPoint":c=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([rt.CUSTOM,l,h,t,i,mi,s]),this.hitDetectionInstructions.push([rt.CUSTOM,l,h,t,r||i,mi,s]));break;case"Point":c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([rt.CUSTOM,l,h,t,i,void 0,s]),this.hitDetectionInstructions.push([rt.CUSTOM,l,h,t,r||i,void 0,s]);break}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[rt.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[rt.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let r,s,o=-1;for(e=0;e<i;++e)r=t[e],s=r[0],s==rt.END_GEOMETRY?o=e:s==rt.BEGIN_GEOMETRY&&(r[2]=e,n0(this.hitDetectionInstructions,o,e),o=-1)}fillStyleToState(t,e={}){if(t){const i=t.getColor();e.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,e.fillStyle=Me(i||te)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){const i=t.getColor();e.strokeStyle=Me(i||$r);const r=t.getLineCap();e.lineCap=r!==void 0?r:tr;const s=t.getLineDash();e.lineDash=s?s.slice():qe;const o=t.getLineDashOffset();e.lineDashOffset=o||Je;const a=t.getLineJoin();e.lineJoin=a!==void 0?a:er;const l=t.getWidth();e.lineWidth=l!==void 0?l:Ur;const c=t.getMiterLimit();e.miterLimit=c!==void 0?c:Wr,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){const i=this.state;this.fillStyleToState(t,i),this.strokeStyleToState(e,i)}createFill(t){const e=t.fillStyle,i=[rt.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[rt.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,r=t.lineCap,s=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,c=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||s!=t.currentLineDash&&!ki(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=c)&&(i!==void 0&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=c)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[rt.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Ad(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;xl(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Yw extends os{constructor(t,e,i,r){super(t,e,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!Zn(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const r=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([rt.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([rt.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const r=t.getFlatCoordinates(),s=[];for(let l=0,c=r.length;l<c;l+=t.getStride())(!this.maxExtent||Zn(this.maxExtent,r.slice(l,l+2)))&&s.push(r[l],r[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([rt.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([rt.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),r=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class Xw extends os{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinates_(t,e,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,r,!1,!1),a=[rt.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([rt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,qe,Je],Hi);const a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(pi),this.endGeometry(e)}drawMultiLineString(t,e,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([rt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,qe,Je],Hi);const a=t.getEnds(),l=t.getFlatCoordinates(),c=t.getStride();let h=0;for(let u=0,f=a.length;u<f;++u)h=this.drawFlatCoordinates_(l,h,a[u],c);this.hitDetectionInstructions.push(pi),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(pi),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(pi),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Hi)}}class Yc extends os{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinatess_(t,e,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=i.length;this.instructions.push(Hi),this.hitDetectionInstructions.push(Hi);for(let c=0;c<l;++c){const h=i[c],u=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,h,r,!0,!a),d=[rt.MOVE_TO_LINE_TO,u,f];this.instructions.push(d),this.hitDetectionInstructions.push(d),a&&(this.instructions.push(Uc),this.hitDetectionInstructions.push(Uc)),e=h}return o&&(this.instructions.push(Ts),this.hitDetectionInstructions.push(Ts)),a&&(this.instructions.push(pi),this.hitDetectionInstructions.push(pi)),e}drawCircle(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([rt.SET_FILL_STYLE,te]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([rt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,qe,Je]);const a=t.getFlatCoordinates(),l=t.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[rt.CIRCLE,c];this.instructions.push(Hi,h),this.hitDetectionInstructions.push(Hi,h),r.fillStyle!==void 0&&(this.instructions.push(Ts),this.hitDetectionInstructions.push(Ts)),r.strokeStyle!==void 0&&(this.instructions.push(pi),this.hitDetectionInstructions.push(pi)),this.endGeometry(e)}drawPolygon(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([rt.SET_FILL_STYLE,te]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([rt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,qe,Je]);const a=t.getEnds(),l=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(e)}drawMultiPolygon(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([rt.SET_FILL_STYLE,te]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([rt.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,qe,Je]);const a=t.getEndss(),l=t.getOrientedFlatCoordinates(),c=t.getStride();let h=0;for(let u=0,f=a.length;u<f;++u)h=this.drawFlatCoordinatess_(l,h,a[u],c);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,r=e.length;i<r;++i)e[i]=ji(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}function Kw(n,t,e,i,r){const s=[];let o=e,a=0,l=t.slice(e,2);for(;a<n&&o+r<i;){const[c,h]=l.slice(-2),u=t[o+r],f=t[o+r+1],d=Math.sqrt((u-c)*(u-c)+(f-h)*(f-h));if(a+=d,a>=n){const _=(n-a+d)/d,g=oe(c,u,_),m=oe(h,f,_);l.push(g,m),s.push(l),l=[g,m],a==n&&(o+=r),a=0}else if(a<n)l.push(t[o+r],t[o+r+1]),o+=r;else{const _=d-a,g=oe(c,u,_/d),m=oe(h,f,_/d);l.push(g,m),s.push(l),l=[g,m],a=0,o+=r}}return a>0&&s.push(l),s}function Vw(n,t,e,i,r){let s=e,o=e,a=0,l=0,c=e,h,u,f,d,_,g,m,p,v,b;for(u=e;u<i;u+=r){const w=t[u],x=t[u+1];_!==void 0&&(v=w-_,b=x-g,d=Math.sqrt(v*v+b*b),m!==void 0&&(l+=f,h=Math.acos((m*v+p*b)/(f*d)),h>n&&(l>a&&(a=l,s=c,o=u),l=0,c=u-r)),f=d,m=v,p=b),_=w,g=x}return l+=d,l>a?[c,u]:[s,o]}const Hs={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Hw extends os{constructor(t,e,i,r){super(t,e,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[te]={fillStyle:te},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let l=a.length;const c=t.getType();let h=null,u=t.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!ie(this.maxExtent,t.getExtent()))return;let f;if(h=t.getFlatCoordinates(),c=="LineString")f=[h.length];else if(c=="MultiLineString")f=t.getEnds();else if(c=="Polygon")f=t.getEnds().slice(0,1);else if(c=="MultiPolygon"){const m=t.getEndss();f=[];for(let p=0,v=m.length;p<v;++p)f.push(m[p][0])}this.beginGeometry(t,e,i);const d=o.repeat,_=d?void 0:o.textAlign;let g=0;for(let m=0,p=f.length;m<p;++m){let v;d?v=Kw(d*this.resolution,h,g,f[m],u):v=[h.slice(g,f[m])];for(let b=0,w=v.length;b<w;++b){const x=v[b];let A=0,I=x.length;if(_==null){const L=Vw(o.maxAngle,x,0,x.length,2);A=L[0],I=L[1]}for(let L=A;L<I;L+=u)a.push(x[L],x[L+1]);const O=a.length;g=f[m],this.drawChars_(l,O),l=O}}this.endGeometry(e)}else{let f=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),u=2;break;case"Polygon":h=t.getFlatInteriorPoint(),o.overflow||f.push(h[2]/this.resolution),u=3;break;case"MultiPolygon":const w=t.getFlatInteriorPoints();h=[];for(let x=0,A=w.length;x<A;x+=3)o.overflow||f.push(w[x+2]/this.resolution),h.push(w[x],w[x+1]);if(h.length===0)return;u=2;break}const d=this.appendFlatPointCoordinates(h,u);if(d===l)return;if(f&&(d-l)/2!==h.length/u){let w=l/2;f=f.filter((x,A)=>{const I=a[(w+A)*2]===h[A*u]&&a[(w+A)*2+1]===h[A*u+1];return I||--w,I})}this.saveTextStates_();const _=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,g=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(t,e,i);let m=o.padding;if(m!=Vi&&(o.scale[0]<0||o.scale[1]<0)){let w=o.padding[0],x=o.padding[1],A=o.padding[2],I=o.padding[3];o.scale[0]<0&&(x=-x,I=-I),o.scale[1]<0&&(w=-w,A=-A),m=[w,x,A,I]}const p=this.pixelRatio;this.instructions.push([rt.DRAW_IMAGE,l,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,m==Vi?Vi:m.map(function(w){return w*p}),_,g,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);const v=1/p,b=_?_.slice(0):null;b&&(b[1]=te),this.hitDetectionInstructions.push([rt.DRAW_IMAGE,l,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[v,v],NaN,this.declutterMode_,this.declutterImageWithText_,m,b,g,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?te:this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||jr,justify:e.justify,textBaseline:e.textBaseline||Us,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=Hs[r.textBaseline],h=this.textOffsetY_*l,u=this.text_,f=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([rt.DRAW_CHARS,t,e,c,r.overflow,a,r.maxAngle,l,h,s,f*l,u,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([rt.DRAW_CHARS,t,e,c,r.overflow,a&&te,r.maxAngle,l,h,s,f*l,u,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,r,s;if(!t)this.text_="";else{const o=t.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Me(o.getColor()||te)):(r=null,this.textFillState_=r);const a=t.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const g=a.getLineDash(),m=a.getLineDashOffset(),p=a.getWidth(),v=a.getMiterLimit();s.lineCap=a.getLineCap()||tr,s.lineDash=g?g.slice():qe,s.lineDashOffset=m===void 0?Je:m,s.lineJoin=a.getLineJoin()||er,s.lineWidth=p===void 0?Ur:p,s.miterLimit=v===void 0?Wr:v,s.strokeStyle=Me(a.getColor()||$r)}i=this.textState_;const l=t.getFont()||pf;qv(l);const c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||Us,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Vi,i.scale=c===void 0?[1,1]:c;const h=t.getOffsetX(),u=t.getOffsetY(),f=t.getRotateWithView(),d=t.getKeepUpright(),_=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=f===void 0?!1:f,this.textKeepUpright_=d===void 0?!0:d,this.textRotation_=_===void 0?0:_,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:xt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+xt(r.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const Zw={Circle:Yc,Default:os,Image:Yw,LineString:Xw,Polygon:Yc,Text:Hw};class qw{constructor(t,e,i,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const r in i){const s=i[r].finish();t[e][r]=s}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[e];if(s===void 0){const o=Zw[e];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=s}return s}}function ah(n,t,e,i){let r=n[t],s=n[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=n[a],c=n[a+1];o+=Math.sqrt((l-r)*(l-r)+(c-s)*(c-s)),r=l,s=c}return o}function Jw(n,t,e,i,r,s,o,a,l,c,h,u,f=!0){let d=n[t],_=n[t+1],g=0,m=0,p=0,v=0;function b(){g=d,m=_,t+=i,d=n[t],_=n[t+1],v+=p,p=Math.sqrt((d-g)*(d-g)+(_-m)*(_-m))}do b();while(t<e-i&&v+p<s);let w=p===0?0:(s-v)/p;const x=oe(g,d,w),A=oe(m,_,w),I=t-i,O=v,L=s+a*l(c,r,h);for(;t<e-i&&v+p<L;)b();w=p===0?0:(L-v)/p;const M=oe(g,d,w),U=oe(m,_,w);let T=!1;if(f)if(u){const z=[x,A,M,U];Xd(z,0,4,2,u,z,z),T=z[0]>z[2]}else T=x>M;const k=Math.PI,E=[],F=I+i===t;t=I,p=0,v=O,d=n[t],_=n[t+1];let X;if(F){b(),X=Math.atan2(_-m,d-g),T&&(X+=X>0?-k:k);const z=(M+x)/2,Z=(U+A)/2;return E[0]=[z,Z,(L-s)/2,X,r],E}r=r.replace(/\n/g," ");for(let z=0,Z=r.length;z<Z;){b();let B=Math.atan2(_-m,d-g);if(T&&(B+=B>0?-k:k),X!==void 0){let K=B-X;if(K+=K>k?-2*k:K<-k?2*k:0,Math.abs(K)>o)return null}X=B;const Q=z;let P=0;for(;z<Z;++z){const K=T?Z-z-1:z,ft=a*l(c,r[K],h);if(t+i<e&&v+p<s+P+ft/2)break;P+=ft}if(z===Q)continue;const R=T?r.substring(Z-Q,Z-z):r.substring(Q,z);w=p===0?0:(s+P/2-v)/p;const et=oe(g,d,w),J=oe(m,_,w);E.push([et,J,P/2,B,R]),s+=P}return E}const bn=we(),li=[],je=[],Ue=[],hi=[];function Xc(n){return n[3].declutterBox}const Kc=new RegExp("[-----]");function ya(n,t){return t==="start"?t=Kc.test(n)?"right":"left":t==="end"&&(t=Kc.test(n)?"left":"right"),Hs[t]}function Qw(n,t,e){return e>0&&n.push(`
`,""),n.push(t,""),n}function tb(n,t,e){return e%2===0&&(n+=t),n}class eb{constructor(t,e,i,r,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Ae(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Lf:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,r){const s=t+e+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],u=l.justify?Hs[l.justify]:ya(Array.isArray(t)?t[0]:t,l.textAlign||jr),f=r&&o.lineWidth?o.lineWidth:0,d=Array.isArray(t)?t:String(t).split(`
`).reduce(Qw,[]),{width:_,height:g,widths:m,heights:p,lineWidths:v}=Qv(l,d),b=_+f,w=[],x=(b+2)*h[0],A=(g+f)*h[1],I={width:x<0?Math.floor(x):Math.ceil(x),height:A<0?Math.floor(A):Math.ceil(A),contextInstructions:w};(h[0]!=1||h[1]!=1)&&w.push("scale",h),r&&(w.push("strokeStyle",o.strokeStyle),w.push("lineWidth",f),w.push("lineCap",o.lineCap),w.push("lineJoin",o.lineJoin),w.push("miterLimit",o.miterLimit),w.push("setLineDash",[o.lineDash]),w.push("lineDashOffset",o.lineDashOffset)),i&&w.push("fillStyle",a.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");const O=.5-u;let L=u*b+O*f;const M=[],U=[];let T=0,k=0,E=0,F=0,X;for(let z=0,Z=d.length;z<Z;z+=2){const B=d[z];if(B===`
`){k+=T,T=0,L=u*b+O*f,++F;continue}const Q=d[z+1]||l.font;Q!==X&&(r&&M.push("font",Q),i&&U.push("font",Q),X=Q),T=Math.max(T,p[E]);const P=[B,L+O*m[E]+u*(m[E]-v[F]),.5*(f+T)+k];L+=m[E],r&&M.push("strokeText",P),i&&U.push("fillText",P),++E}return Array.prototype.push.apply(w,M),Array.prototype.push.apply(w,U),this.labels_[s]=I,I}replayTextBackground_(t,e,i,r,s,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],t.fillStyle=o[1],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,r,s,o,a,l,c,h,u,f,d,_,g,m){a*=f[0],l*=f[1];let p=i-a,v=r-l;const b=s+c>t?t-c:s,w=o+h>e?e-h:o,x=_[3]+b*f[0]+_[1],A=_[0]+w*f[1]+_[2],I=p-_[3],O=v-_[0];(g||u!==0)&&(li[0]=I,hi[0]=I,li[1]=O,je[1]=O,je[0]=I+x,Ue[0]=je[0],Ue[1]=O+A,hi[1]=Ue[1]);let L;return u!==0?(L=ti(Ae(),i,r,1,1,u,-i,-r),Gt(L,li),Gt(L,je),Gt(L,Ue),Gt(L,hi),Si(Math.min(li[0],je[0],Ue[0],hi[0]),Math.min(li[1],je[1],Ue[1],hi[1]),Math.max(li[0],je[0],Ue[0],hi[0]),Math.max(li[1],je[1],Ue[1],hi[1]),bn)):Si(Math.min(I,I+x),Math.min(O,O+A),Math.max(I,I+x),Math.max(O,O+A),bn),d&&(p=Math.round(p),v=Math.round(v)),{drawImageX:p,drawImageY:v,drawImageW:b,drawImageH:w,originX:c,originY:h,declutterBox:{minX:bn[0],minY:bn[1],maxX:bn[2],maxY:bn[3],value:m},canvasTransform:L,scale:f}}replayImageOrLabel_(t,e,i,r,s,o,a){const l=!!(o||a),c=r.declutterBox,h=a?a[2]*r.scale[0]/2:0;return c.minX-h<=e[0]&&c.maxX+h>=0&&c.minY-h<=e[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(t,li,je,Ue,hi,o,a),tw(t,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=Gt(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(i[0]%r,i[1]%r),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,r){const s=this.textStates[e],o=this.createLabel(t,e,r,i),a=this.strokeStates[i],l=this.pixelRatio,c=ya(Array.isArray(t)?t[0]:t,s.textAlign||jr),h=Hs[s.textBaseline||Us],u=a&&a.lineWidth?a.lineWidth:0,f=o.width/l-2*s.scale[0],d=c*f+2*(.5-c)*u,_=h*o.height/l+2*(.5-h)*u;return{label:o,anchorX:d,anchorY:_}}execute_(t,e,i,r,s,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&ki(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=bi(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),nE(this.renderedTransform_,i));let u=0;const f=r.length;let d=0,_,g,m,p,v,b,w,x,A,I,O,L,M,U=0,T=0;const k=this.coordinateCache_,E=this.viewRotation_,F=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,X={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:E},z=this.instructions!=r||this.overlaps?0:200;let Z,B,Q,P;for(;u<f;){const R=r[u];switch(R[0]){case rt.BEGIN_GEOMETRY:Z=R[1],P=R[3],Z.getGeometry()?a!==void 0&&!ie(a,P.getExtent())?u=R[2]+1:++u:u=R[2],c&&(c.zIndex=R[4]);break;case rt.BEGIN_PATH:U>z&&(this.fill_(t),U=0),T>z&&(t.stroke(),T=0),!U&&!T&&(t.beginPath(),v=NaN,b=NaN),++u;break;case rt.CIRCLE:d=R[1];const J=h[d],K=h[d+1],ft=h[d+2],pt=h[d+3],nt=ft-J,ct=pt-K,Et=Math.sqrt(nt*nt+ct*ct);t.moveTo(J+Et,K),t.arc(J,K,Et,0,2*Math.PI,!0),++u;break;case rt.CLOSE_PATH:t.closePath(),++u;break;case rt.CUSTOM:d=R[1],_=R[2];const Ct=R[3],$t=R[4],Pt=R[5];X.geometry=Ct,X.feature=Z,u in k||(k[u]=[]);const y=k[u];Pt?Pt(h,d,_,2,y):(y[0]=h[d],y[1]=h[d+1],y.length=2),c&&(c.zIndex=R[6]),$t(y,X),++u;break;case rt.DRAW_IMAGE:d=R[1],_=R[2],A=R[3],g=R[4],m=R[5];let W=R[6];const G=R[7],S=R[8],C=R[9],D=R[10];let $=R[11];const Y=R[12];let N=R[13];p=R[14]||"declutter";const V=R[15];if(!A&&R.length>=20){I=R[19],O=R[20],L=R[21],M=R[22];const ue=this.drawLabelWithPointPlacement_(I,O,L,M);A=ue.label,R[3]=A;const Fi=R[23];g=(ue.anchorX-Fi)*this.pixelRatio,R[4]=g;const de=R[24];m=(ue.anchorY-de)*this.pixelRatio,R[5]=m,W=A.height,R[6]=W,N=A.width,R[13]=N}let tt;R.length>25&&(tt=R[25]);let q,it,vt;R.length>17?(q=R[16],it=R[17],vt=R[18]):(q=Vi,it=null,vt=null),D&&F?$+=E:!D&&!F&&($-=E);let mt=0;for(;d<_;d+=2){if(tt&&tt[mt++]<N/this.pixelRatio)continue;const ue=this.calculateImageOrLabelDimensions_(A.width,A.height,h[d],h[d+1],N,W,g,m,S,C,$,Y,s,q,!!it||!!vt,Z),Fi=[t,e,A,ue,G,it,vt];if(l){let de,Le,fe;if(V){const kt=_-d;if(!V[kt]){V[kt]={args:Fi,declutterMode:p};continue}const Xt=V[kt];de=Xt.args,Le=Xt.declutterMode,delete V[kt],fe=Xc(de)}let Be,We;if(de&&(Le!=="declutter"||!l.collides(fe))&&(Be=!0),(p!=="declutter"||!l.collides(ue.declutterBox))&&(We=!0),Le==="declutter"&&p==="declutter"){const kt=Be&&We;Be=kt,We=kt}Be&&(Le!=="none"&&l.insert(fe),this.replayImageOrLabel_.apply(this,de)),We&&(p!=="none"&&l.insert(ue.declutterBox),this.replayImageOrLabel_.apply(this,Fi))}else this.replayImageOrLabel_.apply(this,Fi)}++u;break;case rt.DRAW_CHARS:const Yt=R[1],ri=R[2],qt=R[3],Di=R[4];M=R[5];const Rt=R[6],Mi=R[7],gn=R[8];L=R[9];const se=R[10];I=R[11],Array.isArray(I)&&(I=I.reduce(tb,"")),O=R[12];const hr=[R[13],R[13]];p=R[14]||"declutter";const Mo=R[15],cr=this.textStates[O],Pi=cr.font,si=[cr.scale[0]*Mi,cr.scale[1]*Mi];let xe;Pi in this.widths_?xe=this.widths_[Pi]:(xe={},this.widths_[Pi]=xe);const Ni=ah(h,Yt,ri,2),gh=Math.abs(si[0])*Lc(Pi,I,xe);if(Di||gh<=Ni){const ue=this.textStates[O].textAlign,Fi=(Ni-gh)*ya(I,ue),de=Jw(h,Yt,ri,2,I,Fi,Rt,Math.abs(si[0]),Lc,Pi,xe,F?0:this.viewRotation_,Mo);t:if(de){const Le=[];let fe,Be,We,kt,Xt;if(L)for(fe=0,Be=de.length;fe<Be;++fe){Xt=de[fe],We=Xt[4],kt=this.createLabel(We,O,"",L),g=Xt[2]+(si[0]<0?-se:se),m=qt*kt.height+(.5-qt)*2*se*si[1]/si[0]-gn;const $e=this.calculateImageOrLabelDimensions_(kt.width,kt.height,Xt[0],Xt[1],kt.width,kt.height,g,m,0,0,Xt[3],hr,!1,Vi,!1,Z);if(l&&p==="declutter"&&l.collides($e.declutterBox))break t;Le.push([t,e,kt,$e,1,null,null])}if(M)for(fe=0,Be=de.length;fe<Be;++fe){Xt=de[fe],We=Xt[4],kt=this.createLabel(We,O,M,""),g=Xt[2],m=qt*kt.height-gn;const $e=this.calculateImageOrLabelDimensions_(kt.width,kt.height,Xt[0],Xt[1],kt.width,kt.height,g,m,0,0,Xt[3],hr,!1,Vi,!1,Z);if(l&&p==="declutter"&&l.collides($e.declutterBox))break t;Le.push([t,e,kt,$e,1,null,null])}l&&p!=="none"&&l.load(Le.map(Xc));for(let $e=0,Jf=Le.length;$e<Jf;++$e)this.replayImageOrLabel_.apply(this,Le[$e])}}++u;break;case rt.END_GEOMETRY:if(o!==void 0){Z=R[1];const ue=o(Z,P,p);if(ue)return ue}++u;break;case rt.FILL:z?U++:this.fill_(t),++u;break;case rt.MOVE_TO_LINE_TO:for(d=R[1],_=R[2],B=h[d],Q=h[d+1],t.moveTo(B,Q),v=B+.5|0,b=Q+.5|0,d+=2;d<_;d+=2)B=h[d],Q=h[d+1],w=B+.5|0,x=Q+.5|0,(d==_-2||w!==v||x!==b)&&(t.lineTo(B,Q),v=w,b=x);++u;break;case rt.SET_FILL_STYLE:this.alignAndScaleFill_=R[2],U&&(this.fill_(t),U=0,T&&(t.stroke(),T=0)),t.fillStyle=R[1],++u;break;case rt.SET_STROKE_STYLE:T&&(t.stroke(),T=0),this.setStrokeStyle_(t,R),++u;break;case rt.STROKE:z?T++:t.stroke(),++u;break;default:++u;break}}U&&this.fill_(t),T&&t.stroke()}execute(t,e,i,r,s,o){this.viewRotation_=r,this.execute_(t,e,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(t,e,i,r,s){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,s)}}const Pn=["Polygon","Circle","LineString","Image","Text","Default"],Df=["Image","Text"],ib=Pn.filter(n=>!Df.includes(n));class nb{constructor(t,e,i,r,s,o,a){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Ae(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=t[i];for(const o in s){const a=s[o];r[o]=new eb(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let r=0,s=t.length;r<s;++r)if(t[r]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,r,s,o){r=Math.round(r);const a=r*2+1,l=ti(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-i,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Ft(a,a));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=we(),Or(u,t),xl(u,e*(this.renderBuffer_+r),u));const f=rb(r);let d;function _(x,A,I){const O=h.getImageData(0,0,a,a).data;for(let L=0,M=f.length;L<M;L++)if(O[f[L]]>0){if(!o||I==="none"||d!=="Image"&&d!=="Text"||o.includes(x)){const U=(f[L]-3)/4,T=r-U%a,k=r-(U/a|0),E=s(x,A,T*T+k*k);if(E)return E}h.clearRect(0,0,a,a);break}}const g=Object.keys(this.executorsByZIndex_).map(Number);g.sort(Ze);let m,p,v,b,w;for(m=g.length-1;m>=0;--m){const x=g[m].toString();for(v=this.executorsByZIndex_[x],p=Pn.length-1;p>=0;--p)if(d=Pn[p],b=v[d],b!==void 0&&(w=b.executeHitDetection(h,l,i,_,u),w))return w}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],r=e[1],s=e[2],o=e[3],a=[i,r,i,o,s,o,s,r];return bi(a,0,8,2,t,a),a}isEmpty(){return nn(this.executorsByZIndex_)}execute(t,e,i,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?i0:Ze),o=o||Pn;const c=Pn.length;for(let h=0,u=l.length;h<u;++h){const f=l[h].toString(),d=this.executorsByZIndex_[f];for(let _=0,g=o.length;_<g;++_){const m=o[_],p=d[m];if(p!==void 0){const v=a===null?void 0:p.getZIndexContext(),b=v?v.getContext():t,w=this.maxExtent_&&m!=="Image"&&m!=="Text";if(w&&(b.save(),this.clip(b,i)),!v||m==="Text"||m==="Image"?p.execute(b,e,i,r,s,a):v.pushFunction(x=>p.execute(x,e,i,r,s,a)),w&&b.restore(),v){v.offset();const x=l[h]*c+_;this.deferredZIndexContexts_[x]||(this.deferredZIndexContexts_[x]=[]),this.deferredZIndexContexts_[x].push(v)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(Ze);for(let i=0,r=e.length;i<r;++i)t[e[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),t[e[i]].length=0}}const Ea={};function rb(n){if(Ea[n]!==void 0)return Ea[n];const t=n*2+1,e=n*n,i=new Array(e+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((n+s)*t+(n+o))*4+3),s>0&&l.push(((n-s)*t+(n+o))*4+3),o>0&&(l.push(((n+s)*t+(n-o))*4+3),s>0&&l.push(((n-s)*t+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return Ea[n]=r,r}class sb extends kf{constructor(t,e,i,r,s,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=r,this.transformRotation_=r?fo(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Ae()}drawImages_(t,e,i,r){if(!this.image_)return;const s=bi(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,u=s.length;h<u;h+=2){const f=s[h]-this.imageAnchorX_,d=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const _=f+this.imageAnchorX_,g=d+this.imageAnchorY_;ti(a,_,g,1,1,c,-_,-g),o.save(),o.transform.apply(o,a),o.translate(_,g),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,d,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=bi(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=r){const l=s[e]+this.textOffsetX_,c=s[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(t,e,i,r,s){const o=this.context_,a=bi(t,e,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),i}drawRings_(t,e,i,r){for(let s=0,o=i.length;s<o;++s)e=this.moveToLineTo_(t,e,i[s],r,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ie(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=uE(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],r=e[3]-e[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,r=e.length;i<r;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ie(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(ie(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=t.getFlatCoordinates();let s=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ie(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ie(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let r=0;const s=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];r=this.drawRings_(i,r,c,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),ki(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,r=t.textAlign?t.textAlign:jr;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=r&&(i.textAlign=r,e.textAlign=r),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:Me(i||te)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),h=s||qe;this.strokeState_={lineCap:r!==void 0?r:tr,lineDash:this.pixelRatio_===1?h:h.map(u=>u*this.pixelRatio_),lineDashOffset:(o||Je)*this.pixelRatio_,lineJoin:a!==void 0?a:er,lineWidth:(l!==void 0?l:Ur)*this.pixelRatio_,miterLimit:c!==void 0?c:Wr,strokeStyle:Me(i||$r)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const d=e.getColor();this.textFillState_={fillStyle:Me(d||te)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const d=i.getColor(),_=i.getLineCap(),g=i.getLineDash(),m=i.getLineDashOffset(),p=i.getLineJoin(),v=i.getWidth(),b=i.getMiterLimit();this.textStrokeState_={lineCap:_!==void 0?_:tr,lineDash:g||qe,lineDashOffset:m||Je,lineJoin:p!==void 0?p:er,lineWidth:v!==void 0?v:Ur,miterLimit:b!==void 0?b:Wr,strokeStyle:Me(d||$r)}}const r=t.getFont(),s=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),c=t.getScaleArray(),h=t.getText(),u=t.getTextAlign(),f=t.getTextBaseline();this.textState_={font:r!==void 0?r:pf,textAlign:u!==void 0?u:jr,textBaseline:f!==void 0?f:Us},this.text_=h!==void 0?Array.isArray(h)?h.reduce((d,_,g)=>d+=g%2?" ":_,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const ke=.5;function ob(n,t,e,i,r,s,o,a,l){const c=r,h=n[0]*ke,u=n[1]*ke,f=Ft(h,u);f.imageSmoothingEnabled=!1;const d=f.canvas,_=new sb(f,ke,r,null,o,a,null),g=e.length,m=Math.floor((256*256*256-1)/g),p={};for(let b=1;b<=g;++b){const w=e[b-1],x=w.getStyleFunction()||i;if(!x)continue;let A=x(w,s);if(!A)continue;Array.isArray(A)||(A=[A]);const O=(b*m).toString(16).padStart(7,"#00000");for(let L=0,M=A.length;L<M;++L){const U=A[L],T=U.getGeometryFunction()(w);if(!T||!ie(c,T.getExtent()))continue;const k=U.clone(),E=k.getFill();E&&E.setColor(O);const F=k.getStroke();F&&(F.setColor(O),F.setLineDash(null)),k.setText(void 0);const X=U.getImage();if(X){const Q=X.getImageSize();if(!Q)continue;const P=Ft(Q[0],Q[1],void 0,{alpha:!1}),R=P.canvas;P.fillStyle=O,P.fillRect(0,0,R.width,R.height),k.setImage(new Io({img:R,anchor:X.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:X.getOrigin(),opacity:1,size:X.getSize(),scale:X.getScale(),rotation:X.getRotation(),rotateWithView:X.getRotateWithView()}))}const z=k.getZIndex()||0;let Z=p[z];Z||(Z={},p[z]=Z,Z.Polygon=[],Z.Circle=[],Z.LineString=[],Z.Point=[]);const B=T.getType();if(B==="GeometryCollection"){const Q=T.getGeometriesArrayRecursive();for(let P=0,R=Q.length;P<R;++P){const et=Q[P];Z[et.getType().replace("Multi","")].push(et,k)}}else Z[B.replace("Multi","")].push(T,k)}}const v=Object.keys(p).map(Number).sort(Ze);for(let b=0,w=v.length;b<w;++b){const x=p[v[b]];for(const A in x){const I=x[A];for(let O=0,L=I.length;O<L;O+=2){_.setStyle(I[O+1]);for(let M=0,U=t.length;M<U;++M)_.setTransform(t[M]),_.drawGeometry(I[O])}}}return f.getImageData(0,0,d.width,d.height)}function ab(n,t,e){const i=[];if(e){const r=Math.floor(Math.round(n[0])*ke),s=Math.floor(Math.round(n[1])*ke),o=(Ot(r,0,e.width-1)+Ot(s,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],h=e.data[o+2]+256*(l+256*a),u=Math.floor((256*256*256-1)/t.length);h&&h%u===0&&i.push(t[h/u-1])}return i}const lb=.5,Mf={Point:mb,LineString:fb,Polygon:yb,MultiPoint:pb,MultiLineString:gb,MultiPolygon:_b,GeometryCollection:db,Circle:cb};function hb(n,t){return parseInt(xt(n),10)-parseInt(xt(t),10)}function Vc(n,t){const e=Pf(n,t);return e*e}function Pf(n,t){return lb*n/t}function cb(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(s||o){const l=n.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(t,i,r)}const a=e.getText();if(a&&a.getText()){const l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i)}}function Hc(n,t,e,i,r,s,o,a){const l=[],c=e.getImage();if(c){let f=!0;const d=c.getImageState();d==_t.LOADED||d==_t.ERROR?f=!1:d==_t.IDLE&&c.load(),f&&l.push(c.ready())}const h=e.getFill();h&&h.loading()&&l.push(h.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>r(null)),ub(n,t,e,i,s,o,a),u}function ub(n,t,e,i,r,s,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(i,r);if(e.getRenderer())Nf(n,l,e,t,o);else{const h=Mf[l.getType()];h(n,l,e,t,o,s)}}function Nf(n,t,e,i,r){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let a=0,l=o.length;a<l;++a)Nf(n,o[a],e,i,r);return}n.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),r)}function db(n,t,e,i,r,s){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=Mf[o[a].getType()];c(n,o[a],e,i,r,s)}}function fb(n,t,e,i,r){const s=e.getStroke();if(s){const a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(t,i,r)}const o=e.getText();if(o&&o.getText()){const a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,r)}}function gb(n,t,e,i,r){const s=e.getStroke();if(s){const a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(t,i,r)}const o=e.getText();if(o&&o.getText()){const a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,r)}}function _b(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(o||s){const l=n.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(t,i,r)}const a=e.getText();if(a&&a.getText()){const l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,r)}}function mb(n,t,e,i,r,s){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=_t.LOADED)return;const h=n.getBuilder(e.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(t,i,r)}if(l){const h=n.getBuilder(e.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(t,i,r)}}function pb(n,t,e,i,r,s){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),c=l&&l.getText(),h=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=_t.LOADED)return;const u=n.getBuilder(e.getZIndex(),"Image");u.setImageStyle(o,h),u.drawMultiPoint(t,i,r)}if(c){const u=n.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l,h),u.drawText(t,i,r)}}function yb(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(s||o){const l=n.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(t,i,r)}const a=e.getText();if(a&&a.getText()){const l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,r)}}class Eb extends Of{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=we(),this.wrappedRenderedExtent_=we(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const r=e.extent,s=e.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),u=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),d=e.pixelRatio,_=e.viewHints,g=!(_[Ut.ANIMATING]||_[Ut.INTERACTING]),m=this.context,p=Math.round(At(r)/a*d),v=Math.round(Vt(r)/a*d),b=u.getWrapX()&&l.canWrapX(),w=b?At(h):null,x=b?Math.ceil((r[2]-h[2])/w)+1:1;let A=b?Math.floor((r[0]-h[0])/w):0;do{let I=this.getRenderTransform(o,a,0,d,p,v,A*w);e.declutter&&(I=I.slice(0)),t.execute(m,[m.canvas.width,m.canvas.height],I,c,g,i===void 0?Pn:i?Df:ib,i?f&&e.declutter[f]:void 0)}while(++A<x)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Ft(this.context.canvas.width,this.context.canvas.height,$c))}resetDrawContext_(){if(this.opacity_!==1){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Co(this.context),$c.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const r=t.viewState;this.prepareContainer(t,e);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(_e.PRERENDER)||this.getLayer().hasListener(_e.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,t),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=_i(i.extent);a=ie(l,t.extent),this.clipped_=a&&!wr(l,t.extent),this.clipped_&&this.clipUnrotated(s,t,l)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&s.restore(),this.postRender(s,t),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],u=i[0]*ke,f=i[1]*ke;h.push(this.getRenderTransform(r,s,o,ke,u,f,0).slice());const d=c.getSource(),_=a.getExtent();if(d.getWrapX()&&a.canWrapX()&&!wr(_,l)){let g=l[0];const m=At(_);let p=0,v;for(;g<_[0];)--p,v=m*p,h.push(this.getRenderTransform(r,s,o,ke,u,f,v).slice()),g+=m;for(p=0,g=l[2];g>_[2];)++p,v=m*p,h.push(this.getRenderTransform(r,s,o,ke,u,f,v).slice()),g-=m}this.hitDetectionImageData_=ob(i,h,this.renderedFeatures_,c.getStyleFunction(),l,s,o,Vc(s,this.renderedPixelRatio_))}e(ab(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,r,s){var f,d;if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),c={},h=function(_,g,m){const p=xt(_),v=c[p];if(v){if(v!==!0&&m<v.distanceSq){if(m===0)return c[p]=!0,s.splice(s.lastIndexOf(v),1),r(_,l,g);v.geometry=g,v.distanceSq=m}}else{if(m===0)return c[p]=!0,r(_,l,g);s.push(c[p]={feature:_,layer:l,geometry:g,distanceSq:m,callback:r})}},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,i,h,u?(d=(f=e.declutter)==null?void 0:f[u])==null?void 0:d.all().map(_=>_.value):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const r=t.viewHints[Ut.ANIMATING],s=t.viewHints[Ut.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,c=t.viewState,h=c.projection,u=c.resolution,f=t.pixelRatio,d=e.getRevision(),_=e.getRenderBuffer();let g=e.getRenderOrder();g===void 0&&(g=hb);const m=c.center.slice(),p=xl(l,_*u),v=p.slice(),b=[p.slice()],w=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!wr(w,t.extent)){const E=At(w),F=Math.max(At(p)/2,E);p[0]=w[0]-F,p[2]=w[2]+F,Pd(m,h);const X=Dd(b[0],h);X[0]<w[0]&&X[2]<w[2]?b.push([X[0]+E,X[1],X[2]+E,X[3]]):X[0]>w[0]&&X[2]>w[2]&&b.push([X[0]-E,X[1],X[2]-E,X[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==d&&this.renderedRenderOrder_==g&&this.renderedFrameDeclutter_===!!t.declutter&&wr(this.wrappedRenderedExtent_,p))return ki(this.renderedExtent_,v)||(this.hitDetectionImageData_=null,this.renderedExtent_=v),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const x=new qw(Pf(u,f),p,u,f);let A;for(let E=0,F=b.length;E<F;++E)i.loadFeatures(b[E],u,h);const I=Vc(u,f);let O=!0;const L=(E,F)=>{let X;const z=E.getStyleFunction()||e.getStyleFunction();if(z&&(X=z(E,u)),X){const Z=this.renderFeature(E,I,X,x,A,this.getLayer().getDeclutter(),F);O=O&&!Z}},M=Ud(p),U=i.getFeaturesInExtent(M);g&&U.sort(g);for(let E=0,F=U.length;E<F;++E)L(U[E],E);this.renderedFeatures_=U,this.ready=O;const T=x.finish(),k=new nb(p,u,f,i.getOverlaps(),T,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=d,this.renderedRenderOrder_=g,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=v,this.wrappedRenderedExtent_=p,this.renderedCenter_=m,this.renderedProjection_=h,this.renderedPixelRatio_=f,this.replayGroup_=k,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,r,s,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,h=i.length;c<h;++c)l=Hc(r,t,i[c],e,this.boundHandleStyleImageChange_,s,o,a)||l;else l=Hc(r,t,i,e,this.boundHandleStyleImageChange_,s,o,a);return l}}class vb extends Cf{constructor(t){super(t)}createRenderer(){return new Eb(this)}}let wb=!1;function bb(n,t,e,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(e,i,r):n,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=wb,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=t.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?s(t.readFeatures(h,{extent:e,featureProjection:r}),t.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function Zc(n,t){return function(e,i,r,s,o){bb(n,t,e,i,r,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function xb(n,t){return[[-1/0,-1/0,1/0,1/0]]}class Oo extends Ge{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new Oo(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(It(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=wt(t,dt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?Cb(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function Cb(n){if(typeof n=="function")return n;let t;return Array.isArray(n)?t=n:(Tt(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[n]),function(){return t}}function Ff(n,t,e,i){const r=[];let s=we();for(let o=0,a=e.length;o<a;++o){const l=e[o];s=Tl(n,t,l[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=l[l.length-1]}return r}function Zs(n,t,e,i,r,s,o){let a,l;const c=(e-t)/i;if(c===1)a=t;else if(c===2)a=t,l=r;else if(c!==0){let h=n[t],u=n[t+1],f=0;const d=[0];for(let m=t+i;m<e;m+=i){const p=n[m],v=n[m+1];f+=Math.sqrt((p-h)*(p-h)+(v-u)*(v-u)),d.push(f),h=p,u=v}const _=r*f,g=e0(d,_);g<0?(l=(_-d[-g-2])/(d[-g-1]-d[-g-2]),a=t+(-g-2)*i):a=t+g*i}o=o>1?o:2,s=s||new Array(o);for(let h=0;h<o;++h)s[h]=a===void 0?NaN:l===void 0?n[a+h]:oe(n[a+h],n[a+i+h],l);return s}function il(n,t,e,i,r,s){if(e==t)return null;let o;if(r<n[t+i-1])return s?(o=n.slice(t,t+i),o[i-1]=r,o):null;if(n[e-1]<r)return s?(o=n.slice(e-i,e),o[i-1]=r,o):null;if(r==n[t+i-1])return n.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const f=a+l>>1;r<n[(f+1)*i-1]?l=f:a=f+1}const c=n[a*i-1];if(r==c)return n.slice((a-1)*i,(a-1)*i+i);const h=n[(a+1)*i-1],u=(r-c)/(h-c);o=[];for(let f=0;f<i-1;++f)o.push(oe(n[(a-1)*i+f],n[a*i+f],u));return o.push(r),o}function Tb(n,t,e,i,r,s,o){if(o)return il(n,t,e[e.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let l=0,c=e.length;l<c;++l){const h=e[l];if(t!=h){if(r<n[t+i-1])return null;if(r<=n[h-1])return il(n,t,h,i,r,!1);t=h}}return null}class qs extends Kd{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(It),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(wt(t[e],dt.CHANGE,this.changed,this))}clone(){const t=new qs(va(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<hn(this.getExtent(),t,e))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(t,e,i,r);return r}containsXY(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(t,e))return!0;return!1}computeExtent(t){ts(t);const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)Rd(t,e[i].getExtent());return t}getGeometries(){return va(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let r=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(r=!0)}return r?new qs(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(t,e);this.changed()}scale(t,e,i){i||(i=Ai(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(va(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function va(n){return n.map(t=>t.clone())}class ir extends un{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){Fe(this.flatCoordinates,t),this.changed()}clone(){const t=new ir(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<hn(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ml(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Nl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,r))}forEachSegment(t){return Qd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,il(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return mi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Zs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return ah(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=wo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new ir(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return bo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=vo(this.flatCoordinates,0,t,this.stride),this.changed()}}class Js extends un{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const r=t,s=[],o=[];for(let l=0,c=r.length;l<c;++l){const h=r[l];Fe(s,h.getFlatCoordinates()),o.push(s.length)}const a=r.length===0?this.getLayout():r[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(t){Fe(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Js(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<hn(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Pl(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Fl(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,r))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,Tb(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return Gr(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new ir(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,r=[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=new ir(t.slice(s,l),i);r.push(c),s=l}return r}getLength(){const t=this.ends_;let e=0,i=0;for(let r=0,s=t.length;r<s;++r)i+=ah(this.flatCoordinates,e,t[r],this.stride),e=t[r];return i}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const l=r[o],c=Zs(e,i,l,s,.5);Fe(t,c),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=qd(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new Js(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return vE(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=is(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class ko extends un{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){Fe(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new ko(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<hn(this.getExtent(),t,e))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=qi(t,e,s[a],s[a+1]);if(c<r){r=c;for(let h=0;h<o;++h)i[h]=s[a+h];i.length=o}}return r}getCoordinates(){return mi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Jn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,r=[];for(let s=0,o=t.length;s<o;s+=i){const a=new Jn(t.slice(s,s+i),e);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let r=0,s=e.length;r<s;r+=i){const o=e[r],a=e[r+1];if(Cl(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=vo(this.flatCoordinates,0,t,this.stride),this.changed()}}class Qs extends un{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const r=t,s=[],o=[];for(let a=0,l=r.length;a<l;++a){const c=r[a],h=s.length,u=c.getEnds();for(let f=0,d=u.length;f<d;++f)u[f]+=h;Fe(s,c.getFlatCoordinates()),o.push(u)}e=r.length===0?this.getLayout():r[0].getLayout(),t=s,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;Fe(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let r=0,s=e.length;r<s;++r)e[r]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let r=0;r<t;++r)e[r]=this.endss_[r].slice();const i=new Qs(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,r){return r<hn(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(fE(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),gE(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return EE(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return dE(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Ha(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Va(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Ff(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Jd(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ko(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;nf(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ha(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=pE(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new Qs(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const i=this.endss_[t].slice(),r=i[i.length-1];if(e!==0)for(let s=0,o=i.length;s<o;++s)i[s]-=e;return new Ii(this.flatCoordinates.slice(e,r),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),c=l[l.length-1];if(s!==0)for(let u=0,f=l.length;u<f;++u)l[u]-=s;const h=new Ii(e.slice(s,c),t,l);r.push(h),s=c}return r}getType(){return"MultiPolygon"}intersectsExtent(t){return wE(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=Zd(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const r=i[i.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const qc=Ae();class ae{constructor(t,e,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Id(this.flatCoordinates_):Tl(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=Ai(this.getExtent());this.flatInteriorPoints_=Bl(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=xE(this.flatCoordinates_,this.ends_),e=Ff(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=Jd(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Zs(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=Zs(t,e,o,2,.5);Fe(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=Mt(t);const e=t.getExtent(),i=t.getWorldExtent();if(e&&i){const r=Vt(i)/Vt(e);ti(qc,i[0],i[3],r,-r,0,0,0),bi(this.flatCoordinates_,0,this.flatCoordinates_.length,2,qc,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var t;return new ae(this.type_,this.flatCoordinates_.slice(),(t=this.ends_)==null?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=bd((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=wo(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=qd(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,r);break;case"Polygon":r=[],i.length=zl(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,r);break}return r&&(this.simplifiedGeometry_=new ae(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}ae.prototype.getFlatCoordinates=ae.prototype.getOrientedFlatCoordinates;class Jc{constructor(t){this.rbush_=new uf(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[xt(e)]=i}load(t,e){const i=new Array(e.length);for(let r=0,s=e.length;r<s;r++){const o=t[r],a=e[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=l,this.items_[xt(a)]=l}this.rbush_.load(i)}remove(t){const e=xt(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[xt(e)],r=[i.minX,i.minY,i.maxX,i.maxY];Nr(r,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(r){return r.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let r=0,s=t.length;r<s;r++)if(i=e(t[r]),i)return i;return i}isEmpty(){return nn(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return Si(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class zf extends Ge{constructor(t){super(),this.projection=Mt(t.projection),this.attributions_=Qc(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,r){e.viewResolver=i,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Qc(t),this.changed()}setState(t){this.state_=t,this.changed()}}function Qc(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),t=>n):null}const ge={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class ci extends ii{constructor(t,e,i){super(t),this.feature=e,this.features=i}}class Sb extends zf{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Pr,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(Tt(this.format_,"`format` must be set when `url` is set"),this.loader_=Zc(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:xb;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new Jc:null,this.loadedExtentsRtree_=new Jc,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(t.features)?r=t.features:t.features&&(i=t.features,r=i.getArray()),!e&&i===void 0&&(i=new De(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=xt(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new ci(ge.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof ae||(this.featureChangeKeys_[t]=[wt(e,dt.CHANGE,this.handleFeatureChange_,this),wt(e,Hn.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const r=String(e.getId());if(!(r in this.idIndex_))this.idIndex_[r]=e;else if(e instanceof ae){const s=this.idIndex_[r];s instanceof ae?Array.isArray(s)?s.push(e):this.idIndex_[r]=[s,e]:i=!1}else i=!1}return i&&(Tt(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=xt(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=xt(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();e.push(h),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(ge.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new ci(ge.ADDFEATURE,i[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(ge.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(ge.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(Jt.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(Jt.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(It);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new ci(ge.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof ae||s.intersectsCoordinate(t))return e(r)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const r=i.getGeometry();if(r instanceof ae||r.intersectsExtent(t)){const s=e(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),nn(this.nullGeometryFeatures_)||Fe(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const r=Md(t,e);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],r=t[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||Mr,this.featuresRtree_.forEachInExtent(l,function(c){if(e(c)){const h=c.getGeometry(),u=a;if(a=h instanceof ae?0:h.closestPointXY(i,r,o,a),a<u){s=c;const f=Math.sqrt(a);l[0]=i-f,l[1]=r-f,l[2]=i+f,l[3]=r+f}}}),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=xt(e),r=e.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const s=e.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new ci(ge.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:xt(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&nn(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const r=this.loadedExtentsRtree_,s=this.strategy_(t,e,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(h){return wr(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new ci(ge.FEATURESLOADSTART)),this.loader_.call(this,l,e,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new ci(ge.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new ci(ge.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_,i=e.forEachInExtent(t,function(r){if(Nr(r.extent,t))return r});i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,r=t.length;i<r;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=xt(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const i=this.featureChangeKeys_[e];i==null||i.forEach(It),delete this.featureChangeKeys_[e];const r=t.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===t?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[e],this.hasListener(ge.REMOVEFEATURE)&&this.dispatchEvent(new ci(ge.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){Tt(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Zc(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}}const xn=[0,0,0],ui=5;class Gf{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,Tt(r0(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!e)e=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,Tt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=cn(i)),Tt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,Tt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:Xl,Tt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((r,s)=>{const o=new oh(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const r=this.getTileRangeForExtentAndZ(t,e);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)i([e,s,a])}forEachTileCoordParentTileRange(t,e,i,r){let s,o,a,l=null,c=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=wn(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,c,i),e(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const s=t[1]*2,o=t[2]*2;return wn(s,s+1,o,o+1,e)}const r=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],s=t[1],o=t[2];if(e===r)return wn(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-r),c=Math.floor(s*l),h=Math.floor(o*l);if(e<r)return wn(c,c,h,h,i);const u=Math.floor(l*(s+1))-1,f=Math.floor(l*(o+1))-1;return wn(c,u,h,f,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,xn);const r=xn[1],s=xn[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,xn);const o=xn[1],a=xn[2];return wn(r,o,s,a,i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=re(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*i,e[1]-(t[2]+.5)*r[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=re(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*s[0]*r,a=i[1]-(t[2]+1)*s[1]*r,l=o+s[0]*r,c=a+s[1]*r;return Si(o,a,l,c,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),c=re(this.getTileSize(o),this.tmpSize_);let h=a*(t-l[0])/i/c[0],u=a*(l[1]-e)/i/c[1];return r?(h=ms(h,ui)-1,u=ms(u,ui)-1):(h=_s(h,ui),u=_s(u,ui)),Vs(o,h,u,s)}getTileCoordForXYAndZ_(t,e,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),l=re(this.getTileSize(i),this.tmpSize_);let c=(t-o[0])/a/l[0],h=(o[1]-e)/a/l[1];return r?(c=ms(c,ui)-1,h=ms(h,ui)-1):(c=_s(c,ui),h=_s(h,ui)),Vs(i,c,h,s)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const i=bl(this.resolutions_,t,e||0);return Ot(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return tf(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let r=this.minZoom;r<e;++r)i[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=i}}function Bf(n){let t=n.getDefaultTileGrid();return t||(t=Lb(n),n.setDefaultTileGrid(t)),t}function Ab(n,t,e){const i=t[0],r=n.getTileCoordCenter(t),s=lh(e);if(!Zn(s,r)){const o=At(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return t}function Ib(n,t,e,i){i=i!==void 0?i:"top-left";const r=Wf(n,t,e);return new Gf({extent:n,origin:E0(n,i),resolutions:r,tileSize:e})}function Rb(n){const t=n||{},e=t.extent||Mt("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:Wf(e,t.maxZoom,t.tileSize,t.maxResolution)};return new Gf(i)}function Wf(n,t,e,i){t=t!==void 0?t:IE,e=re(e!==void 0?e:Xl);const r=Vt(n),s=At(n);i=i>0?i:Math.max(s/e[0],r/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function Lb(n,t,e,i){const r=lh(n);return Ib(r,t,e,i)}function lh(n){n=Mt(n);let t=n.getExtent();if(!t){const e=180*Al.degrees/n.getMetersPerUnit();t=Si(-e,-e,e,e)}return t}const Ob=/\{z\}/g,kb=/\{x\}/g,Db=/\{y\}/g,Mb=/\{-y\}/g;function Pb(n,t,e,i,r){return n.replace(Ob,t.toString()).replace(kb,e.toString()).replace(Db,i.toString()).replace(Mb,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function Nb(n){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(n);if(e){const i=e[1].charCodeAt(0),r=e[2].charCodeAt(0);let s;for(s=i;s<=r;++s)t.push(n.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(n),e){const i=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=i;r++)t.push(n.replace(e[0],r.toString()));return t}return t.push(n),t}function Fb(n,t){return function(e,i,r){if(!e)return;let s;const o=e[0];if(t){const a=t.getFullTileRange(o);a&&(s=a.getHeight()-1)}return Pb(n,o,e[1],e[2],s)}}function zb(n,t){const e=n.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Fb(n[r],t);return Gb(i)}function Gb(n){return n.length===1?n[0]:function(t,e,i){if(!t)return;const r=Pw(t),s=zn(r,n.length);return n[s](t,e,i)}}class Bb extends zf{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&re(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||xt(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,r,s){return ht()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:Bf(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(e),o=re(r.getTileSize(t),this.tmpSize);return s==1?o:wv(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){const i=e!==void 0?e:this.getProjection(),r=e!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=Ab(r,t,i)),Fw(t,r)?t:null}clear(){}refresh(){this.clear(),super.refresh()}}class Wb extends ii{constructor(t,e){super(t),this.tile=e}}const wa={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class hh extends Bb{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===hh.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=xt(e),r=e.getState();let s;r==ot.LOADING?(this.tileLoadingKeys_[i]=!0,s=wa.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==ot.ERROR?wa.TILELOADERROR:r==ot.LOADED?wa.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new Wb(s,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=Nb(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(zb(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}}class $b extends hh{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:jb,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:If,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!Os(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Os(e,t)))return this.tileGrid;const i=xt(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Bf(t)),this.tileGridForProjection[i]}createTile_(t,e,i,r,s,o){const a=[t,e,i],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,r,s):void 0,h=new this.tileClass(a,c!==void 0?ot.IDLE:ot.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=o,h.addEventListener(dt.CHANGE,this.handleTileChange.bind(this)),h}getTile(t,e,i,r,s){const o=this.getProjection();if(!o||!s||Os(o,s))return this.getTileInternal(t,e,i,r,o||s);const a=[t,e,i],l=this.getKey(),c=this.getTileGridForProjection(o),h=this.getTileGridForProjection(s),u=this.getTileCoordForTileUrlFunction(a,s),f=new Rf(o,c,s,h,a,u,this.getTilePixelRatio(r),this.getGutter(),(d,_,g,m)=>this.getTileInternal(d,_,g,m,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=l,f}getTileInternal(t,e,i,r,s){const o=this.getKey();return this.createTile_(t,e,i,r,s,o)}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){const i=Mt(t);if(i){const r=xt(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}}function jb(n,t){n.getImage().src=t}class Ub extends $b{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",i=t.tileGrid!==void 0?t.tileGrid:Rb({extent:lh(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const Yb='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class Xb extends Ub{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[Yb];const i=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",r=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}}class Kb{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Oo,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?Mt(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=Mt(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return ht()}readFeature(t,e){return ht()}readFeatures(t,e){return ht()}readGeometry(t,e){return ht()}readProjection(t){return ht()}writeFeature(t,e){return ht()}writeFeatures(t,e){return ht()}writeGeometry(t,e){return ht()}}function ch(n,t,e){const i=e?Mt(e.featureProjection):null,r=e?Mt(e.dataProjection):null;let s=n;if(i&&r&&!Os(i,r)){t&&(s=n.clone());const o=t?i:r,a=t?r:i;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(zr(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*o)/o;return l};s===n&&(s=n.clone()),s.applyTransform(a)}return s}const Vb={Point:Jn,LineString:ir,Polygon:Ii,MultiPoint:ko,MultiLineString:Js,MultiPolygon:Qs};function Hb(n,t,e){return Array.isArray(t[0])?(nf(n,0,t,e)||(n=n.slice(),Ha(n,0,t,e)),n):($l(n,0,t,e)||(n=n.slice(),$s(n,0,t,e)),n)}function $f(n,t){var s;const e=n.geometry;if(!e)return[];if(Array.isArray(e))return e.map(o=>$f({...n,geometry:o})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const r=e.layout.length;return ch(new ae(i,i==="Polygon"?Hb(e.flatCoordinates,e.ends,r):e.flatCoordinates,(s=e.ends)==null?void 0:s.flat(),r,n.properties||{},n.id).enableSimplifyTransformed(),!1,t)}function uh(n,t){if(!n)return null;if(Array.isArray(n)){const i=n.map(r=>uh(r,t));return new qs(i)}const e=Vb[n.type];return ch(new e(n.flatCoordinates,n.layout||"XY",n.ends),!1,t)}class Zb extends Kb{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Ss(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Ss(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return ht()}readFeaturesFromObject(t,e){return ht()}readGeometry(t,e){return this.readGeometryFromObject(Ss(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return ht()}readProjection(t){return this.readProjectionFromObject(Ss(t))}readProjectionFromObject(t){return ht()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return ht()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return ht()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return ht()}}function Ss(n){if(typeof n=="string"){const t=JSON.parse(n);return t||null}return n!==null?n:null}class qb extends Zb{constructor(t){t=t||{},super(),this.dataProjection=Mt(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Mt(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const r=dh(i.geometry);if(this.featureClass===ae)return $f({geometry:r,id:i.id,properties:i.properties},e);const s=new Oo;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&s.setGeometryName(i.geometry_name),s.setGeometry(uh(r,e)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(t,e){const i=t;let r=null;if(i.type==="FeatureCollection"){const s=t;r=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],e);c&&r.push(c)}}else r=[this.readFeatureFromObject(t,e)];return r.flat()}readGeometryFromObject(t,e){return Jb(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=Mt(e.properties.name);else if(e.type==="EPSG")i=Mt("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},r=t.getId();if(r!==void 0&&(i.id=r),!t.hasProperties())return i;const s=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=nl(o,e),delete s[t.getGeometryName()]),nn(s)||(i.properties=s),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let r=0,s=t.length;r<s;++r)i.push(this.writeFeatureObject(t[r],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return nl(t,this.adaptOptions(e))}}function dh(n,t){if(!n)return null;let e;switch(n.type){case"Point":{e=t1(n);break}case"LineString":{e=e1(n);break}case"Polygon":{e=s1(n);break}case"MultiPoint":{e=n1(n);break}case"MultiLineString":{e=i1(n);break}case"MultiPolygon":{e=r1(n);break}case"GeometryCollection":{e=Qb(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return e}function Jb(n,t){const e=dh(n);return uh(e,t)}function Qb(n,t){return n.geometries.map(function(i){return dh(i)})}function t1(n){const t=n.coordinates;return{type:"Point",flatCoordinates:t,layout:dn(t.length)}}function e1(n){var i;const t=n.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:dn(((i=t[0])==null?void 0:i.length)||2)}}function i1(n){var s,o;const t=n.coordinates,e=((o=(s=t[0])==null?void 0:s[0])==null?void 0:o.length)||2,i=[],r=is(i,0,t,e);return{type:"MultiLineString",flatCoordinates:i,ends:r,layout:dn(e)}}function n1(n){var e;const t=n.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:dn(((e=t[0])==null?void 0:e.length)||2)}}function r1(n){var s,o;const t=n.coordinates,e=[],i=((o=(s=t[0])==null?void 0:s[0])==null?void 0:o[0].length)||2,r=Zd(e,0,t,i);return{type:"MultiPolygon",flatCoordinates:e,ends:r,layout:dn(i)}}function s1(n){var s,o;const t=n.coordinates,e=[],i=(o=(s=t[0])==null?void 0:s[0])==null?void 0:o.length,r=is(e,0,t,i);return{type:"Polygon",flatCoordinates:e,ends:r,layout:dn(i)}}function nl(n,t){n=ch(n,!0,t);const e=n.getType();let i;switch(e){case"Point":{i=u1(n);break}case"LineString":{i=a1(n);break}case"Polygon":{i=d1(n,t);break}case"MultiPoint":{i=h1(n);break}case"MultiLineString":{i=l1(n);break}case"MultiPolygon":{i=c1(n,t);break}case"GeometryCollection":{i=o1(n,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function o1(n,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(i){return nl(i,t)})}}function a1(n,t){return{type:"LineString",coordinates:n.getCoordinates()}}function l1(n,t){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function h1(n,t){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function c1(n,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(e)}}function u1(n,t){return{type:"Point",coordinates:n.getCoordinates()}}function d1(n,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(e)}}var yi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function As(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ba={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var tu;function Uf(){return tu||(tu=1,function(n,t){(function(e){n.exports=e()})(function(){return function e(i,r,s){function o(c,h){if(!r[c]){if(!i[c]){var u=typeof As=="function"&&As;if(!h&&u)return u(c,!0);if(a)return a(c,!0);var f=new Error("Cannot find module '"+c+"'");throw f.code="MODULE_NOT_FOUND",f}var d=r[c]={exports:{}};i[c][0].call(d.exports,function(_){var g=i[c][1][_];return o(g||_)},d,d.exports,e,i,r,s)}return r[c].exports}for(var a=typeof As=="function"&&As,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(e,i,r){var s=e("./utils"),o=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(l){for(var c,h,u,f,d,_,g,m=[],p=0,v=l.length,b=v,w=s.getTypeOf(l)!=="string";p<l.length;)b=v-p,u=w?(c=l[p++],h=p<v?l[p++]:0,p<v?l[p++]:0):(c=l.charCodeAt(p++),h=p<v?l.charCodeAt(p++):0,p<v?l.charCodeAt(p++):0),f=c>>2,d=(3&c)<<4|h>>4,_=1<b?(15&h)<<2|u>>6:64,g=2<b?63&u:64,m.push(a.charAt(f)+a.charAt(d)+a.charAt(_)+a.charAt(g));return m.join("")},r.decode=function(l){var c,h,u,f,d,_,g=0,m=0,p="data:";if(l.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var v,b=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&b--,l.charAt(l.length-2)===a.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=o.uint8array?new Uint8Array(0|b):new Array(0|b);g<l.length;)c=a.indexOf(l.charAt(g++))<<2|(f=a.indexOf(l.charAt(g++)))>>4,h=(15&f)<<4|(d=a.indexOf(l.charAt(g++)))>>2,u=(3&d)<<6|(_=a.indexOf(l.charAt(g++))),v[m++]=c,d!==64&&(v[m++]=h),_!==64&&(v[m++]=u);return v}},{"./support":30,"./utils":32}],2:[function(e,i,r){var s=e("./external"),o=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function c(h,u,f,d,_){this.compressedSize=h,this.uncompressedSize=u,this.crc32=f,this.compression=d,this.compressedContent=_}c.prototype={getContentWorker:function(){var h=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),u=this;return h.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(h,u,f){return h.pipe(new a).pipe(new l("uncompressedSize")).pipe(u.compressWorker(f)).pipe(new l("compressedSize")).withStreamInfo("compression",u)},i.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,i,r){var s=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,i,r){var s=e("./utils"),o=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var h=0;h<8;h++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();i.exports=function(a,l){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?function(c,h,u,f){var d=o,_=f+u;c^=-1;for(var g=f;g<_;g++)c=c>>>8^d[255&(c^h[g])];return-1^c}(0|l,a,a.length,0):function(c,h,u,f){var d=o,_=f+u;c^=-1;for(var g=f;g<_;g++)c=c>>>8^d[255&(c^h.charCodeAt(g))];return-1^c}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(e,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,i,r){var s=null;s=typeof Promise<"u"?Promise:e("lie"),i.exports={Promise:s}},{lie:37}],7:[function(e,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),a=e("./utils"),l=e("./stream/GenericWorker"),c=s?"uint8array":"array";function h(u,f){l.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=f,this.meta={}}r.magic="\b\0",a.inherits(h,l),h.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,u.data),!1)},h.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(f){u.push({data:f,meta:u.meta})}},r.compressWorker=function(u){return new h("Deflate",u)},r.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,i,r){function s(d,_){var g,m="";for(g=0;g<_;g++)m+=String.fromCharCode(255&d),d>>>=8;return m}function o(d,_,g,m,p,v){var b,w,x=d.file,A=d.compression,I=v!==c.utf8encode,O=a.transformTo("string",v(x.name)),L=a.transformTo("string",c.utf8encode(x.name)),M=x.comment,U=a.transformTo("string",v(M)),T=a.transformTo("string",c.utf8encode(M)),k=L.length!==x.name.length,E=T.length!==M.length,F="",X="",z="",Z=x.dir,B=x.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};_&&!g||(Q.crc32=d.crc32,Q.compressedSize=d.compressedSize,Q.uncompressedSize=d.uncompressedSize);var P=0;_&&(P|=8),I||!k&&!E||(P|=2048);var R=0,et=0;Z&&(R|=16),p==="UNIX"?(et=798,R|=function(K,ft){var pt=K;return K||(pt=ft?16893:33204),(65535&pt)<<16}(x.unixPermissions,Z)):(et=20,R|=function(K){return 63&(K||0)}(x.dosPermissions)),b=B.getUTCHours(),b<<=6,b|=B.getUTCMinutes(),b<<=5,b|=B.getUTCSeconds()/2,w=B.getUTCFullYear()-1980,w<<=4,w|=B.getUTCMonth()+1,w<<=5,w|=B.getUTCDate(),k&&(X=s(1,1)+s(h(O),4)+L,F+="up"+s(X.length,2)+X),E&&(z=s(1,1)+s(h(U),4)+T,F+="uc"+s(z.length,2)+z);var J="";return J+=`
\0`,J+=s(P,2),J+=A.magic,J+=s(b,2),J+=s(w,2),J+=s(Q.crc32,4),J+=s(Q.compressedSize,4),J+=s(Q.uncompressedSize,4),J+=s(O.length,2),J+=s(F.length,2),{fileRecord:u.LOCAL_FILE_HEADER+J+O+F,dirRecord:u.CENTRAL_FILE_HEADER+s(et,2)+J+s(U.length,2)+"\0\0\0\0"+s(R,4)+s(m,4)+O+F+U}}var a=e("../utils"),l=e("../stream/GenericWorker"),c=e("../utf8"),h=e("../crc32"),u=e("../signature");function f(d,_,g,m){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=g,this.encodeFileName=m,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(f,l),f.prototype.push=function(d){var _=d.meta.percent||0,g=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:g?(_+100*(g-m-1))/g:100}}))},f.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var _=this.streamFiles&&!d.file.dir;if(_){var g=o(d,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},f.prototype.closedSource=function(d){this.accumulate=!1;var _=this.streamFiles&&!d.file.dir,g=o(d,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),_)this.push({data:function(m){return u.DATA_DESCRIPTOR+s(m.crc32,4)+s(m.compressedSize,4)+s(m.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},f.prototype.flush=function(){for(var d=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var g=this.bytesWritten-d,m=function(p,v,b,w,x){var A=a.transformTo("string",x(w));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(p,2)+s(p,2)+s(v,4)+s(b,4)+s(A.length,2)+A}(this.dirRecords.length,g,d,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},f.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},f.prototype.registerPrevious=function(d){this._sources.push(d);var _=this;return d.on("data",function(g){_.processChunk(g)}),d.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),d.on("error",function(g){_.error(g)}),this},f.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},f.prototype.error=function(d){var _=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var g=0;g<_.length;g++)try{_[g].error(d)}catch{}return!0},f.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,_=0;_<d.length;_++)d[_].lock()},i.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,i,r){var s=e("../compressions"),o=e("./ZipFileWorker");r.generateWorker=function(a,l,c){var h=new o(l.streamFiles,c,l.platform,l.encodeFileName),u=0;try{a.forEach(function(f,d){u++;var _=function(v,b){var w=v||b,x=s[w];if(!x)throw new Error(w+" is not a valid compression method !");return x}(d.options.compression,l.compression),g=d.options.compressionOptions||l.compressionOptions||{},m=d.dir,p=d.date;d._compressWorker(_,g).withStreamInfo("file",{name:f,dir:m,date:p,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(h)}),h.entriesCount=u}catch(f){h.error(f)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,i,r){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(o,a){return new s().loadAsync(o,a)},s.external=e("./external"),i.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,i,r){var s=e("./utils"),o=e("./external"),a=e("./utf8"),l=e("./zipEntries"),c=e("./stream/Crc32Probe"),h=e("./nodejsUtils");function u(f){return new o.Promise(function(d,_){var g=f.decompressed.getContentWorker().pipe(new c);g.on("error",function(m){_(m)}).on("end",function(){g.streamInfo.crc32!==f.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}i.exports=function(f,d){var _=this;return d=s.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),h.isNode&&h.isStream(f)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",f,!0,d.optimizedBinaryString,d.base64).then(function(g){var m=new l(d);return m.load(g),m}).then(function(g){var m=[o.Promise.resolve(g)],p=g.files;if(d.checkCRC32)for(var v=0;v<p.length;v++)m.push(u(p[v]));return o.Promise.all(m)}).then(function(g){for(var m=g.shift(),p=m.files,v=0;v<p.length;v++){var b=p[v],w=b.fileNameStr,x=s.resolve(b.fileNameStr);_.file(x,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:d.createFolders}),b.dir||(_.file(x).unsafeOriginalName=w)}return m.zipComment.length&&(_.comment=m.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,i,r){var s=e("../utils"),o=e("../stream/GenericWorker");function a(l,c){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(a,o),a.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(h){c.push({data:h,meta:{percent:0}})}).on("error",function(h){c.isPaused?this.generatedError=h:c.error(h)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,i,r){var s=e("readable-stream").Readable;function o(a,l,c){s.call(this,l),this._helper=a;var h=this;a.on("data",function(u,f){h.push(u)||h._helper.pause(),c&&c(f)}).on("error",function(u){h.emit("error",u)}).on("end",function(){h.push(null)})}e("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,i,r){function s(x,A,I){var O,L=a.getTypeOf(A),M=a.extend(I||{},h);M.date=M.date||new Date,M.compression!==null&&(M.compression=M.compression.toUpperCase()),typeof M.unixPermissions=="string"&&(M.unixPermissions=parseInt(M.unixPermissions,8)),M.unixPermissions&&16384&M.unixPermissions&&(M.dir=!0),M.dosPermissions&&16&M.dosPermissions&&(M.dir=!0),M.dir&&(x=p(x)),M.createFolders&&(O=m(x))&&v.call(this,O,!0);var U=L==="string"&&M.binary===!1&&M.base64===!1;I&&I.binary!==void 0||(M.binary=!U),(A instanceof u&&A.uncompressedSize===0||M.dir||!A||A.length===0)&&(M.base64=!1,M.binary=!0,A="",M.compression="STORE",L="string");var T=null;T=A instanceof u||A instanceof l?A:_.isNode&&_.isStream(A)?new g(x,A):a.prepareContent(x,A,M.binary,M.optimizedBinaryString,M.base64);var k=new f(x,T,M);this.files[x]=k}var o=e("./utf8"),a=e("./utils"),l=e("./stream/GenericWorker"),c=e("./stream/StreamHelper"),h=e("./defaults"),u=e("./compressedObject"),f=e("./zipObject"),d=e("./generate"),_=e("./nodejsUtils"),g=e("./nodejs/NodejsStreamInputAdapter"),m=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var A=x.lastIndexOf("/");return 0<A?x.substring(0,A):""},p=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},v=function(x,A){return A=A!==void 0?A:h.createFolders,x=p(x),this.files[x]||s.call(this,x,null,{dir:!0,createFolders:A}),this.files[x]};function b(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var A,I,O;for(A in this.files)O=this.files[A],(I=A.slice(this.root.length,A.length))&&A.slice(0,this.root.length)===this.root&&x(I,O)},filter:function(x){var A=[];return this.forEach(function(I,O){x(I,O)&&A.push(O)}),A},file:function(x,A,I){if(arguments.length!==1)return x=this.root+x,s.call(this,x,A,I),this;if(b(x)){var O=x;return this.filter(function(M,U){return!U.dir&&O.test(M)})}var L=this.files[this.root+x];return L&&!L.dir?L:null},folder:function(x){if(!x)return this;if(b(x))return this.filter(function(L,M){return M.dir&&x.test(L)});var A=this.root+x,I=v.call(this,A),O=this.clone();return O.root=I.name,O},remove:function(x){x=this.root+x;var A=this.files[x];if(A||(x.slice(-1)!=="/"&&(x+="/"),A=this.files[x]),A&&!A.dir)delete this.files[x];else for(var I=this.filter(function(L,M){return M.name.slice(0,x.length)===x}),O=0;O<I.length;O++)delete this.files[I[O].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var A,I={};try{if((I=a.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");a.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var O=I.comment||this.comment||"";A=d.generateWorker(this,I,O)}catch(L){(A=new l("error")).error(L)}return new c(A,I.type||"string",I.mimeType)},generateAsync:function(x,A){return this.generateInternalStream(x).accumulate(A)},generateNodeStream:function(x,A){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(A)}};i.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,i,r){i.exports=e("stream")},{stream:void 0}],17:[function(e,i,r){var s=e("./DataReader");function o(a){s.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}e("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),c=a.charCodeAt(1),h=a.charCodeAt(2),u=a.charCodeAt(3),f=this.length-4;0<=f;--f)if(this.data[f]===l&&this.data[f+1]===c&&this.data[f+2]===h&&this.data[f+3]===u)return f-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),c=a.charCodeAt(1),h=a.charCodeAt(2),u=a.charCodeAt(3),f=this.readData(4);return l===f[0]&&c===f[1]&&h===f[2]&&u===f[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,i,r){var s=e("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,c=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=a,c},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},i.exports=o},{"../utils":32}],19:[function(e,i,r){var s=e("./Uint8ArrayReader");function o(a){s.call(this,a)}e("../utils").inherits(o,s),o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,i,r){var s=e("./DataReader");function o(a){s.call(this,a)}e("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,i,r){var s=e("./ArrayReader");function o(a){s.call(this,a)}e("../utils").inherits(o,s),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,i,r){var s=e("../utils"),o=e("../support"),a=e("./ArrayReader"),l=e("./StringReader"),c=e("./NodeBufferReader"),h=e("./Uint8ArrayReader");i.exports=function(u){var f=s.getTypeOf(u);return s.checkSupport(f),f!=="string"||o.uint8array?f==="nodebuffer"?new c(u):o.uint8array?new h(s.transformTo("uint8array",u)):new a(s.transformTo("array",u)):new l(u)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,i,r){var s=e("./GenericWorker"),o=e("../utils");function a(l){s.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(a,s),a.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},i.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,i,r){var s=e("./GenericWorker"),o=e("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,s),a.prototype.processChunk=function(l){this.streamInfo.crc32=o(l.data,this.streamInfo.crc32||0),this.push(l)},i.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,i,r){var s=e("../utils"),o=e("./GenericWorker");function a(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(a,o),a.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}o.prototype.processChunk.call(this,l)},i.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,i,r){var s=e("../utils"),o=e("./GenericWorker");function a(l){o.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(h){c.dataIsReady=!0,c.data=h,c.max=h&&h.length||0,c.type=s.getTypeOf(h),c.isPaused||c._tickAndRepeat()},function(h){c.error(h)})}s.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,i,r){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(l){a.processChunk(l)}),o.on("end",function(){a.end()}),o.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},i.exports=s},{}],29:[function(e,i,r){var s=e("../utils"),o=e("./ConvertWorker"),a=e("./GenericWorker"),l=e("../base64"),c=e("../support"),h=e("../external"),u=null;if(c.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function f(_,g){return new h.Promise(function(m,p){var v=[],b=_._internalType,w=_._outputType,x=_._mimeType;_.on("data",function(A,I){v.push(A),g&&g(I)}).on("error",function(A){v=[],p(A)}).on("end",function(){try{var A=function(I,O,L){switch(I){case"blob":return s.newBlob(s.transformTo("arraybuffer",O),L);case"base64":return l.encode(O);default:return s.transformTo(I,O)}}(w,function(I,O){var L,M=0,U=null,T=0;for(L=0;L<O.length;L++)T+=O[L].length;switch(I){case"string":return O.join("");case"array":return Array.prototype.concat.apply([],O);case"uint8array":for(U=new Uint8Array(T),L=0;L<O.length;L++)U.set(O[L],M),M+=O[L].length;return U;case"nodebuffer":return Buffer.concat(O);default:throw new Error("concat : unsupported type '"+I+"'")}}(b,v),x);m(A)}catch(I){p(I)}v=[]}).resume()})}function d(_,g,m){var p=g;switch(g){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=g,this._mimeType=m,s.checkSupport(p),this._worker=_.pipe(new o(p)),_.lock()}catch(v){this._worker=new a("error"),this._worker.error(v)}}d.prototype={accumulate:function(_){return f(this,_)},on:function(_,g){var m=this;return _==="data"?this._worker.on(_,function(p){g.call(m,p.data,p.meta)}):this._worker.on(_,function(){s.delay(g,arguments,m)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},_)}},i.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var s=new ArrayBuffer(0);try{r.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),r.blob=o.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(e,i,r){for(var s=e("./utils"),o=e("./support"),a=e("./nodejsUtils"),l=e("./stream/GenericWorker"),c=new Array(256),h=0;h<256;h++)c[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;c[254]=c[254]=1;function u(){l.call(this,"utf-8 decode"),this.leftOver=null}function f(){l.call(this,"utf-8 encode")}r.utf8encode=function(d){return o.nodebuffer?a.newBufferFrom(d,"utf-8"):function(_){var g,m,p,v,b,w=_.length,x=0;for(v=0;v<w;v++)(64512&(m=_.charCodeAt(v)))==55296&&v+1<w&&(64512&(p=_.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(p-56320),v++),x+=m<128?1:m<2048?2:m<65536?3:4;for(g=o.uint8array?new Uint8Array(x):new Array(x),v=b=0;b<x;v++)(64512&(m=_.charCodeAt(v)))==55296&&v+1<w&&(64512&(p=_.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(p-56320),v++),m<128?g[b++]=m:(m<2048?g[b++]=192|m>>>6:(m<65536?g[b++]=224|m>>>12:(g[b++]=240|m>>>18,g[b++]=128|m>>>12&63),g[b++]=128|m>>>6&63),g[b++]=128|63&m);return g}(d)},r.utf8decode=function(d){return o.nodebuffer?s.transformTo("nodebuffer",d).toString("utf-8"):function(_){var g,m,p,v,b=_.length,w=new Array(2*b);for(g=m=0;g<b;)if((p=_[g++])<128)w[m++]=p;else if(4<(v=c[p]))w[m++]=65533,g+=v-1;else{for(p&=v===2?31:v===3?15:7;1<v&&g<b;)p=p<<6|63&_[g++],v--;1<v?w[m++]=65533:p<65536?w[m++]=p:(p-=65536,w[m++]=55296|p>>10&1023,w[m++]=56320|1023&p)}return w.length!==m&&(w.subarray?w=w.subarray(0,m):w.length=m),s.applyFromCharCode(w)}(d=s.transformTo(o.uint8array?"uint8array":"array",d))},s.inherits(u,l),u.prototype.processChunk=function(d){var _=s.transformTo(o.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var g=_;(_=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),_.set(g,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var m=function(v,b){var w;for((b=b||v.length)>v.length&&(b=v.length),w=b-1;0<=w&&(192&v[w])==128;)w--;return w<0||w===0?b:w+c[v[w]]>b?w:b}(_),p=_;m!==_.length&&(o.uint8array?(p=_.subarray(0,m),this.leftOver=_.subarray(m,_.length)):(p=_.slice(0,m),this.leftOver=_.slice(m,_.length))),this.push({data:r.utf8decode(p),meta:d.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=u,s.inherits(f,l),f.prototype.processChunk=function(d){this.push({data:r.utf8encode(d.data),meta:d.meta})},r.Utf8EncodeWorker=f},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,i,r){var s=e("./support"),o=e("./base64"),a=e("./nodejsUtils"),l=e("./external");function c(g){return g}function h(g,m){for(var p=0;p<g.length;++p)m[p]=255&g.charCodeAt(p);return m}e("setimmediate"),r.newBlob=function(g,m){r.checkSupport("blob");try{return new Blob([g],{type:m})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(g),p.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(g,m,p){var v=[],b=0,w=g.length;if(w<=p)return String.fromCharCode.apply(null,g);for(;b<w;)m==="array"||m==="nodebuffer"?v.push(String.fromCharCode.apply(null,g.slice(b,Math.min(b+p,w)))):v.push(String.fromCharCode.apply(null,g.subarray(b,Math.min(b+p,w)))),b+=p;return v.join("")},stringifyByChar:function(g){for(var m="",p=0;p<g.length;p++)m+=String.fromCharCode(g[p]);return m},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function f(g){var m=65536,p=r.getTypeOf(g),v=!0;if(p==="uint8array"?v=u.applyCanBeUsed.uint8array:p==="nodebuffer"&&(v=u.applyCanBeUsed.nodebuffer),v)for(;1<m;)try{return u.stringifyByChunk(g,p,m)}catch{m=Math.floor(m/2)}return u.stringifyByChar(g)}function d(g,m){for(var p=0;p<g.length;p++)m[p]=g[p];return m}r.applyFromCharCode=f;var _={};_.string={string:c,array:function(g){return h(g,new Array(g.length))},arraybuffer:function(g){return _.string.uint8array(g).buffer},uint8array:function(g){return h(g,new Uint8Array(g.length))},nodebuffer:function(g){return h(g,a.allocBuffer(g.length))}},_.array={string:f,array:c,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(g)}},_.arraybuffer={string:function(g){return f(new Uint8Array(g))},array:function(g){return d(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:c,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(new Uint8Array(g))}},_.uint8array={string:f,array:function(g){return d(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:c,nodebuffer:function(g){return a.newBufferFrom(g)}},_.nodebuffer={string:f,array:function(g){return d(g,new Array(g.length))},arraybuffer:function(g){return _.nodebuffer.uint8array(g).buffer},uint8array:function(g){return d(g,new Uint8Array(g.length))},nodebuffer:c},r.transformTo=function(g,m){if(m=m||"",!g)return m;r.checkSupport(g);var p=r.getTypeOf(m);return _[p][g](m)},r.resolve=function(g){for(var m=g.split("/"),p=[],v=0;v<m.length;v++){var b=m[v];b==="."||b===""&&v!==0&&v!==m.length-1||(b===".."?p.pop():p.push(b))}return p.join("/")},r.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(g)?"nodebuffer":s.uint8array&&g instanceof Uint8Array?"uint8array":s.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(g){if(!s[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(g){var m,p,v="";for(p=0;p<(g||"").length;p++)v+="\\x"+((m=g.charCodeAt(p))<16?"0":"")+m.toString(16).toUpperCase();return v},r.delay=function(g,m,p){setImmediate(function(){g.apply(p||null,m||[])})},r.inherits=function(g,m){function p(){}p.prototype=m.prototype,g.prototype=new p},r.extend=function(){var g,m,p={};for(g=0;g<arguments.length;g++)for(m in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],m)&&p[m]===void 0&&(p[m]=arguments[g][m]);return p},r.prepareContent=function(g,m,p,v,b){return l.Promise.resolve(m).then(function(w){return s.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new l.Promise(function(x,A){var I=new FileReader;I.onload=function(O){x(O.target.result)},I.onerror=function(O){A(O.target.error)},I.readAsArrayBuffer(w)}):w}).then(function(w){var x=r.getTypeOf(w);return x?(x==="arraybuffer"?w=r.transformTo("uint8array",w):x==="string"&&(b?w=o.decode(w):p&&v!==!0&&(w=function(A){return h(A,s.uint8array?new Uint8Array(A.length):new Array(A.length))}(w))),w):l.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,i,r){var s=e("./reader/readerFor"),o=e("./utils"),a=e("./signature"),l=e("./zipEntry"),c=e("./support");function h(u){this.files=[],this.loadOptions=u}h.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(f)+", expected "+o.pretty(u)+")")}},isSignature:function(u,f){var d=this.reader.index;this.reader.setIndex(u);var _=this.reader.readString(4)===f;return this.reader.setIndex(d),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),f=c.uint8array?"uint8array":"array",d=o.transformTo(f,u);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u,f,d,_=this.zip64EndOfCentralSize-44;0<_;)u=this.reader.readInt(2),f=this.reader.readInt(4),d=this.reader.readData(f),this.zip64ExtensibleData[u]={id:u,length:f,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,f;for(u=0;u<this.files.length;u++)f=this.files[u],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(u=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(u<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(u);var f=u;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(u=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var _=f-d;if(0<_)this.isSignature(f,a.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(u){this.reader=s(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,i,r){var s=e("./reader/readerFor"),o=e("./utils"),a=e("./compressedObject"),l=e("./crc32"),c=e("./utf8"),h=e("./compressions"),u=e("./support");function f(d,_){this.options=d,this.loadOptions=_}f.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var _,g;if(d.skip(22),this.fileNameLength=d.readInt(2),g=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((_=function(m){for(var p in h)if(Object.prototype.hasOwnProperty.call(h,p)&&h[p].magic===m)return h[p];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,_,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var _=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(_),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var _,g,m,p=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<p;)_=d.readInt(2),g=d.readInt(2),m=d.readData(g),this.extraFields[_]={id:_,length:g,value:m};d.setIndex(p)},handleUTF8:function(){var d=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(_!==null)this.fileNameStr=_;else{var g=o.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var p=o.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var _=s(d.value);return _.readInt(1)!==1||l(this.fileName)!==_.readInt(4)?null:c.utf8decode(_.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var _=s(d.value);return _.readInt(1)!==1||l(this.fileComment)!==_.readInt(4)?null:c.utf8decode(_.readData(d.length-5))}return null}},i.exports=f},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,i,r){function s(_,g,m){this.name=_,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=g,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var o=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),l=e("./utf8"),c=e("./compressedObject"),h=e("./stream/GenericWorker");s.prototype={internalStream:function(_){var g=null,m="string";try{if(!_)throw new Error("No output type specified.");var p=(m=_.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),g=this._decompressWorker();var v=!this._dataBinary;v&&!p&&(g=g.pipe(new l.Utf8EncodeWorker)),!v&&p&&(g=g.pipe(new l.Utf8DecodeWorker))}catch(b){(g=new h("error")).error(b)}return new o(g,m,"")},async:function(_,g){return this.internalStream(_).accumulate(g)},nodeStream:function(_,g){return this.internalStream(_||"nodebuffer").toNodejsStream(g)},_compressWorker:function(_,g){if(this._data instanceof c&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(m,_,g)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof h?this._data:new a(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<u.length;d++)s.prototype[u[d]]=f;i.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,i,r){(function(s){var o,a,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,h=new l(_),u=s.document.createTextNode("");h.observe(u,{characterData:!0}),o=function(){u.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var g=s.document.createElement("script");g.onreadystatechange=function(){_(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},s.document.documentElement.appendChild(g)}:function(){setTimeout(_,0)};else{var f=new s.MessageChannel;f.port1.onmessage=_,o=function(){f.port2.postMessage(0)}}var d=[];function _(){var g,m;a=!0;for(var p=d.length;p;){for(m=d,d=[],g=-1;++g<p;)m[g]();p=d.length}a=!1}i.exports=function(g){d.push(g)!==1||a||o()}}).call(this,typeof yi<"u"?yi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,i,r){var s=e("immediate");function o(){}var a={},l=["REJECTED"],c=["FULFILLED"],h=["PENDING"];function u(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,p!==o&&g(this,p)}function f(p,v,b){this.promise=p,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function d(p,v,b){s(function(){var w;try{w=v(b)}catch(x){return a.reject(p,x)}w===p?a.reject(p,new TypeError("Cannot resolve promise with itself")):a.resolve(p,w)})}function _(p){var v=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof v=="function")return function(){v.apply(p,arguments)}}function g(p,v){var b=!1;function w(I){b||(b=!0,a.reject(p,I))}function x(I){b||(b=!0,a.resolve(p,I))}var A=m(function(){v(x,w)});A.status==="error"&&w(A.value)}function m(p,v){var b={};try{b.value=p(v),b.status="success"}catch(w){b.status="error",b.value=w}return b}(i.exports=u).prototype.finally=function(p){if(typeof p!="function")return this;var v=this.constructor;return this.then(function(b){return v.resolve(p()).then(function(){return b})},function(b){return v.resolve(p()).then(function(){throw b})})},u.prototype.catch=function(p){return this.then(null,p)},u.prototype.then=function(p,v){if(typeof p!="function"&&this.state===c||typeof v!="function"&&this.state===l)return this;var b=new this.constructor(o);return this.state!==h?d(b,this.state===c?p:v,this.outcome):this.queue.push(new f(b,p,v)),b},f.prototype.callFulfilled=function(p){a.resolve(this.promise,p)},f.prototype.otherCallFulfilled=function(p){d(this.promise,this.onFulfilled,p)},f.prototype.callRejected=function(p){a.reject(this.promise,p)},f.prototype.otherCallRejected=function(p){d(this.promise,this.onRejected,p)},a.resolve=function(p,v){var b=m(_,v);if(b.status==="error")return a.reject(p,b.value);var w=b.value;if(w)g(p,w);else{p.state=c,p.outcome=v;for(var x=-1,A=p.queue.length;++x<A;)p.queue[x].callFulfilled(v)}return p},a.reject=function(p,v){p.state=l,p.outcome=v;for(var b=-1,w=p.queue.length;++b<w;)p.queue[b].callRejected(v);return p},u.resolve=function(p){return p instanceof this?p:a.resolve(new this(o),p)},u.reject=function(p){var v=new this(o);return a.reject(v,p)},u.all=function(p){var v=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=p.length,w=!1;if(!b)return this.resolve([]);for(var x=new Array(b),A=0,I=-1,O=new this(o);++I<b;)L(p[I],I);return O;function L(M,U){v.resolve(M).then(function(T){x[U]=T,++A!==b||w||(w=!0,a.resolve(O,x))},function(T){w||(w=!0,a.reject(O,T))})}},u.race=function(p){var v=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=p.length,w=!1;if(!b)return this.resolve([]);for(var x=-1,A=new this(o);++x<b;)I=p[x],v.resolve(I).then(function(O){w||(w=!0,a.resolve(A,O))},function(O){w||(w=!0,a.reject(A,O))});var I;return A}},{immediate:36}],38:[function(e,i,r){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),i.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,i,r){var s=e("./zlib/deflate"),o=e("./utils/common"),a=e("./utils/strings"),l=e("./zlib/messages"),c=e("./zlib/zstream"),h=Object.prototype.toString,u=0,f=-1,d=0,_=8;function g(p){if(!(this instanceof g))return new g(p);this.options=o.assign({level:f,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},p||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var b=s.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(b!==u)throw new Error(l[b]);if(v.header&&s.deflateSetHeader(this.strm,v.header),v.dictionary){var w;if(w=typeof v.dictionary=="string"?a.string2buf(v.dictionary):h.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(b=s.deflateSetDictionary(this.strm,w))!==u)throw new Error(l[b]);this._dict_set=!0}}function m(p,v){var b=new g(v);if(b.push(p,!0),b.err)throw b.msg||l[b.err];return b.result}g.prototype.push=function(p,v){var b,w,x=this.strm,A=this.options.chunkSize;if(this.ended)return!1;w=v===~~v?v:v===!0?4:0,typeof p=="string"?x.input=a.string2buf(p):h.call(p)==="[object ArrayBuffer]"?x.input=new Uint8Array(p):x.input=p,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new o.Buf8(A),x.next_out=0,x.avail_out=A),(b=s.deflate(x,w))!==1&&b!==u)return this.onEnd(b),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(x.output,x.next_out))):this.onData(o.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&b!==1);return w===4?(b=s.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===u):w!==2||(this.onEnd(u),!(x.avail_out=0))},g.prototype.onData=function(p){this.chunks.push(p)},g.prototype.onEnd=function(p){p===u&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},r.Deflate=g,r.deflate=m,r.deflateRaw=function(p,v){return(v=v||{}).raw=!0,m(p,v)},r.gzip=function(p,v){return(v=v||{}).gzip=!0,m(p,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,i,r){var s=e("./zlib/inflate"),o=e("./utils/common"),a=e("./utils/strings"),l=e("./zlib/constants"),c=e("./zlib/messages"),h=e("./zlib/zstream"),u=e("./zlib/gzheader"),f=Object.prototype.toString;function d(g){if(!(this instanceof d))return new d(g);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},g||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||g&&g.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&(15&m.windowBits)==0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var p=s.inflateInit2(this.strm,m.windowBits);if(p!==l.Z_OK)throw new Error(c[p]);this.header=new u,s.inflateGetHeader(this.strm,this.header)}function _(g,m){var p=new d(m);if(p.push(g,!0),p.err)throw p.msg||c[p.err];return p.result}d.prototype.push=function(g,m){var p,v,b,w,x,A,I=this.strm,O=this.options.chunkSize,L=this.options.dictionary,M=!1;if(this.ended)return!1;v=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof g=="string"?I.input=a.binstring2buf(g):f.call(g)==="[object ArrayBuffer]"?I.input=new Uint8Array(g):I.input=g,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new o.Buf8(O),I.next_out=0,I.avail_out=O),(p=s.inflate(I,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&L&&(A=typeof L=="string"?a.string2buf(L):f.call(L)==="[object ArrayBuffer]"?new Uint8Array(L):L,p=s.inflateSetDictionary(this.strm,A)),p===l.Z_BUF_ERROR&&M===!0&&(p=l.Z_OK,M=!1),p!==l.Z_STREAM_END&&p!==l.Z_OK)return this.onEnd(p),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&p!==l.Z_STREAM_END&&(I.avail_in!==0||v!==l.Z_FINISH&&v!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=a.utf8border(I.output,I.next_out),w=I.next_out-b,x=a.buf2string(I.output,b),I.next_out=w,I.avail_out=O-w,w&&o.arraySet(I.output,I.output,b,w,0),this.onData(x)):this.onData(o.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(M=!0)}while((0<I.avail_in||I.avail_out===0)&&p!==l.Z_STREAM_END);return p===l.Z_STREAM_END&&(v=l.Z_FINISH),v===l.Z_FINISH?(p=s.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===l.Z_OK):v!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(I.avail_out=0))},d.prototype.onData=function(g){this.chunks.push(g)},d.prototype.onEnd=function(g){g===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},r.Inflate=d,r.inflate=_,r.inflateRaw=function(g,m){return(m=m||{}).raw=!0,_(g,m)},r.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var h=c.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var u in h)h.hasOwnProperty(u)&&(l[u]=h[u])}}return l},r.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var o={arraySet:function(l,c,h,u,f){if(c.subarray&&l.subarray)l.set(c.subarray(h,h+u),f);else for(var d=0;d<u;d++)l[f+d]=c[h+d]},flattenChunks:function(l){var c,h,u,f,d,_;for(c=u=0,h=l.length;c<h;c++)u+=l[c].length;for(_=new Uint8Array(u),c=f=0,h=l.length;c<h;c++)d=l[c],_.set(d,f),f+=d.length;return _}},a={arraySet:function(l,c,h,u,f){for(var d=0;d<u;d++)l[f+d]=c[h+d]},flattenChunks:function(l){return[].concat.apply([],l)}};r.setTyped=function(l){l?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,o)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,a))},r.setTyped(s)},{}],42:[function(e,i,r){var s=e("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function h(u,f){if(f<65537&&(u.subarray&&a||!u.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(u,f));for(var d="",_=0;_<f;_++)d+=String.fromCharCode(u[_]);return d}l[254]=l[254]=1,r.string2buf=function(u){var f,d,_,g,m,p=u.length,v=0;for(g=0;g<p;g++)(64512&(d=u.charCodeAt(g)))==55296&&g+1<p&&(64512&(_=u.charCodeAt(g+1)))==56320&&(d=65536+(d-55296<<10)+(_-56320),g++),v+=d<128?1:d<2048?2:d<65536?3:4;for(f=new s.Buf8(v),g=m=0;m<v;g++)(64512&(d=u.charCodeAt(g)))==55296&&g+1<p&&(64512&(_=u.charCodeAt(g+1)))==56320&&(d=65536+(d-55296<<10)+(_-56320),g++),d<128?f[m++]=d:(d<2048?f[m++]=192|d>>>6:(d<65536?f[m++]=224|d>>>12:(f[m++]=240|d>>>18,f[m++]=128|d>>>12&63),f[m++]=128|d>>>6&63),f[m++]=128|63&d);return f},r.buf2binstring=function(u){return h(u,u.length)},r.binstring2buf=function(u){for(var f=new s.Buf8(u.length),d=0,_=f.length;d<_;d++)f[d]=u.charCodeAt(d);return f},r.buf2string=function(u,f){var d,_,g,m,p=f||u.length,v=new Array(2*p);for(d=_=0;d<p;)if((g=u[d++])<128)v[_++]=g;else if(4<(m=l[g]))v[_++]=65533,d+=m-1;else{for(g&=m===2?31:m===3?15:7;1<m&&d<p;)g=g<<6|63&u[d++],m--;1<m?v[_++]=65533:g<65536?v[_++]=g:(g-=65536,v[_++]=55296|g>>10&1023,v[_++]=56320|1023&g)}return h(v,_)},r.utf8border=function(u,f){var d;for((f=f||u.length)>u.length&&(f=u.length),d=f-1;0<=d&&(192&u[d])==128;)d--;return d<0||d===0?f:d+l[u[d]]>f?d:f}},{"./common":41}],43:[function(e,i,r){i.exports=function(s,o,a,l){for(var c=65535&s|0,h=s>>>16&65535|0,u=0;a!==0;){for(a-=u=2e3<a?2e3:a;h=h+(c=c+o[l++]|0)|0,--u;);c%=65521,h%=65521}return c|h<<16|0}},{}],44:[function(e,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,i,r){var s=function(){for(var o,a=[],l=0;l<256;l++){o=l;for(var c=0;c<8;c++)o=1&o?3988292384^o>>>1:o>>>1;a[l]=o}return a}();i.exports=function(o,a,l,c){var h=s,u=c+l;o^=-1;for(var f=c;f<u;f++)o=o>>>8^h[255&(o^a[f])];return-1^o}},{}],46:[function(e,i,r){var s,o=e("../utils/common"),a=e("./trees"),l=e("./adler32"),c=e("./crc32"),h=e("./messages"),u=0,f=4,d=0,_=-2,g=-1,m=4,p=2,v=8,b=9,w=286,x=30,A=19,I=2*w+1,O=15,L=3,M=258,U=M+L+1,T=42,k=113,E=1,F=2,X=3,z=4;function Z(y,W){return y.msg=h[W],W}function B(y){return(y<<1)-(4<y?9:0)}function Q(y){for(var W=y.length;0<=--W;)y[W]=0}function P(y){var W=y.state,G=W.pending;G>y.avail_out&&(G=y.avail_out),G!==0&&(o.arraySet(y.output,W.pending_buf,W.pending_out,G,y.next_out),y.next_out+=G,W.pending_out+=G,y.total_out+=G,y.avail_out-=G,W.pending-=G,W.pending===0&&(W.pending_out=0))}function R(y,W){a._tr_flush_block(y,0<=y.block_start?y.block_start:-1,y.strstart-y.block_start,W),y.block_start=y.strstart,P(y.strm)}function et(y,W){y.pending_buf[y.pending++]=W}function J(y,W){y.pending_buf[y.pending++]=W>>>8&255,y.pending_buf[y.pending++]=255&W}function K(y,W){var G,S,C=y.max_chain_length,D=y.strstart,$=y.prev_length,Y=y.nice_match,N=y.strstart>y.w_size-U?y.strstart-(y.w_size-U):0,V=y.window,tt=y.w_mask,q=y.prev,it=y.strstart+M,vt=V[D+$-1],mt=V[D+$];y.prev_length>=y.good_match&&(C>>=2),Y>y.lookahead&&(Y=y.lookahead);do if(V[(G=W)+$]===mt&&V[G+$-1]===vt&&V[G]===V[D]&&V[++G]===V[D+1]){D+=2,G++;do;while(V[++D]===V[++G]&&V[++D]===V[++G]&&V[++D]===V[++G]&&V[++D]===V[++G]&&V[++D]===V[++G]&&V[++D]===V[++G]&&V[++D]===V[++G]&&V[++D]===V[++G]&&D<it);if(S=M-(it-D),D=it-M,$<S){if(y.match_start=W,Y<=($=S))break;vt=V[D+$-1],mt=V[D+$]}}while((W=q[W&tt])>N&&--C!=0);return $<=y.lookahead?$:y.lookahead}function ft(y){var W,G,S,C,D,$,Y,N,V,tt,q=y.w_size;do{if(C=y.window_size-y.lookahead-y.strstart,y.strstart>=q+(q-U)){for(o.arraySet(y.window,y.window,q,q,0),y.match_start-=q,y.strstart-=q,y.block_start-=q,W=G=y.hash_size;S=y.head[--W],y.head[W]=q<=S?S-q:0,--G;);for(W=G=q;S=y.prev[--W],y.prev[W]=q<=S?S-q:0,--G;);C+=q}if(y.strm.avail_in===0)break;if($=y.strm,Y=y.window,N=y.strstart+y.lookahead,V=C,tt=void 0,tt=$.avail_in,V<tt&&(tt=V),G=tt===0?0:($.avail_in-=tt,o.arraySet(Y,$.input,$.next_in,tt,N),$.state.wrap===1?$.adler=l($.adler,Y,tt,N):$.state.wrap===2&&($.adler=c($.adler,Y,tt,N)),$.next_in+=tt,$.total_in+=tt,tt),y.lookahead+=G,y.lookahead+y.insert>=L)for(D=y.strstart-y.insert,y.ins_h=y.window[D],y.ins_h=(y.ins_h<<y.hash_shift^y.window[D+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[D+L-1])&y.hash_mask,y.prev[D&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=D,D++,y.insert--,!(y.lookahead+y.insert<L)););}while(y.lookahead<U&&y.strm.avail_in!==0)}function pt(y,W){for(var G,S;;){if(y.lookahead<U){if(ft(y),y.lookahead<U&&W===u)return E;if(y.lookahead===0)break}if(G=0,y.lookahead>=L&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+L-1])&y.hash_mask,G=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),G!==0&&y.strstart-G<=y.w_size-U&&(y.match_length=K(y,G)),y.match_length>=L)if(S=a._tr_tally(y,y.strstart-y.match_start,y.match_length-L),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=L){for(y.match_length--;y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+L-1])&y.hash_mask,G=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart,--y.match_length!=0;);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else S=a._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(S&&(R(y,!1),y.strm.avail_out===0))return E}return y.insert=y.strstart<L-1?y.strstart:L-1,W===f?(R(y,!0),y.strm.avail_out===0?X:z):y.last_lit&&(R(y,!1),y.strm.avail_out===0)?E:F}function nt(y,W){for(var G,S,C;;){if(y.lookahead<U){if(ft(y),y.lookahead<U&&W===u)return E;if(y.lookahead===0)break}if(G=0,y.lookahead>=L&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+L-1])&y.hash_mask,G=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=L-1,G!==0&&y.prev_length<y.max_lazy_match&&y.strstart-G<=y.w_size-U&&(y.match_length=K(y,G),y.match_length<=5&&(y.strategy===1||y.match_length===L&&4096<y.strstart-y.match_start)&&(y.match_length=L-1)),y.prev_length>=L&&y.match_length<=y.prev_length){for(C=y.strstart+y.lookahead-L,S=a._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-L),y.lookahead-=y.prev_length-1,y.prev_length-=2;++y.strstart<=C&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+L-1])&y.hash_mask,G=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),--y.prev_length!=0;);if(y.match_available=0,y.match_length=L-1,y.strstart++,S&&(R(y,!1),y.strm.avail_out===0))return E}else if(y.match_available){if((S=a._tr_tally(y,0,y.window[y.strstart-1]))&&R(y,!1),y.strstart++,y.lookahead--,y.strm.avail_out===0)return E}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(S=a._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<L-1?y.strstart:L-1,W===f?(R(y,!0),y.strm.avail_out===0?X:z):y.last_lit&&(R(y,!1),y.strm.avail_out===0)?E:F}function ct(y,W,G,S,C){this.good_length=y,this.max_lazy=W,this.nice_length=G,this.max_chain=S,this.func=C}function Et(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*I),this.dyn_dtree=new o.Buf16(2*(2*x+1)),this.bl_tree=new o.Buf16(2*(2*A+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(O+1),this.heap=new o.Buf16(2*w+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*w+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ct(y){var W;return y&&y.state?(y.total_in=y.total_out=0,y.data_type=p,(W=y.state).pending=0,W.pending_out=0,W.wrap<0&&(W.wrap=-W.wrap),W.status=W.wrap?T:k,y.adler=W.wrap===2?0:1,W.last_flush=u,a._tr_init(W),d):Z(y,_)}function $t(y){var W=Ct(y);return W===d&&function(G){G.window_size=2*G.w_size,Q(G.head),G.max_lazy_match=s[G.level].max_lazy,G.good_match=s[G.level].good_length,G.nice_match=s[G.level].nice_length,G.max_chain_length=s[G.level].max_chain,G.strstart=0,G.block_start=0,G.lookahead=0,G.insert=0,G.match_length=G.prev_length=L-1,G.match_available=0,G.ins_h=0}(y.state),W}function Pt(y,W,G,S,C,D){if(!y)return _;var $=1;if(W===g&&(W=6),S<0?($=0,S=-S):15<S&&($=2,S-=16),C<1||b<C||G!==v||S<8||15<S||W<0||9<W||D<0||m<D)return Z(y,_);S===8&&(S=9);var Y=new Et;return(y.state=Y).strm=y,Y.wrap=$,Y.gzhead=null,Y.w_bits=S,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=C+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+L-1)/L),Y.window=new o.Buf8(2*Y.w_size),Y.head=new o.Buf16(Y.hash_size),Y.prev=new o.Buf16(Y.w_size),Y.lit_bufsize=1<<C+6,Y.pending_buf_size=4*Y.lit_bufsize,Y.pending_buf=new o.Buf8(Y.pending_buf_size),Y.d_buf=1*Y.lit_bufsize,Y.l_buf=3*Y.lit_bufsize,Y.level=W,Y.strategy=D,Y.method=G,$t(y)}s=[new ct(0,0,0,0,function(y,W){var G=65535;for(G>y.pending_buf_size-5&&(G=y.pending_buf_size-5);;){if(y.lookahead<=1){if(ft(y),y.lookahead===0&&W===u)return E;if(y.lookahead===0)break}y.strstart+=y.lookahead,y.lookahead=0;var S=y.block_start+G;if((y.strstart===0||y.strstart>=S)&&(y.lookahead=y.strstart-S,y.strstart=S,R(y,!1),y.strm.avail_out===0)||y.strstart-y.block_start>=y.w_size-U&&(R(y,!1),y.strm.avail_out===0))return E}return y.insert=0,W===f?(R(y,!0),y.strm.avail_out===0?X:z):(y.strstart>y.block_start&&(R(y,!1),y.strm.avail_out),E)}),new ct(4,4,8,4,pt),new ct(4,5,16,8,pt),new ct(4,6,32,32,pt),new ct(4,4,16,16,nt),new ct(8,16,32,32,nt),new ct(8,16,128,128,nt),new ct(8,32,128,256,nt),new ct(32,128,258,1024,nt),new ct(32,258,258,4096,nt)],r.deflateInit=function(y,W){return Pt(y,W,v,15,8,0)},r.deflateInit2=Pt,r.deflateReset=$t,r.deflateResetKeep=Ct,r.deflateSetHeader=function(y,W){return y&&y.state?y.state.wrap!==2?_:(y.state.gzhead=W,d):_},r.deflate=function(y,W){var G,S,C,D;if(!y||!y.state||5<W||W<0)return y?Z(y,_):_;if(S=y.state,!y.output||!y.input&&y.avail_in!==0||S.status===666&&W!==f)return Z(y,y.avail_out===0?-5:_);if(S.strm=y,G=S.last_flush,S.last_flush=W,S.status===T)if(S.wrap===2)y.adler=0,et(S,31),et(S,139),et(S,8),S.gzhead?(et(S,(S.gzhead.text?1:0)+(S.gzhead.hcrc?2:0)+(S.gzhead.extra?4:0)+(S.gzhead.name?8:0)+(S.gzhead.comment?16:0)),et(S,255&S.gzhead.time),et(S,S.gzhead.time>>8&255),et(S,S.gzhead.time>>16&255),et(S,S.gzhead.time>>24&255),et(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),et(S,255&S.gzhead.os),S.gzhead.extra&&S.gzhead.extra.length&&(et(S,255&S.gzhead.extra.length),et(S,S.gzhead.extra.length>>8&255)),S.gzhead.hcrc&&(y.adler=c(y.adler,S.pending_buf,S.pending,0)),S.gzindex=0,S.status=69):(et(S,0),et(S,0),et(S,0),et(S,0),et(S,0),et(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),et(S,3),S.status=k);else{var $=v+(S.w_bits-8<<4)<<8;$|=(2<=S.strategy||S.level<2?0:S.level<6?1:S.level===6?2:3)<<6,S.strstart!==0&&($|=32),$+=31-$%31,S.status=k,J(S,$),S.strstart!==0&&(J(S,y.adler>>>16),J(S,65535&y.adler)),y.adler=1}if(S.status===69)if(S.gzhead.extra){for(C=S.pending;S.gzindex<(65535&S.gzhead.extra.length)&&(S.pending!==S.pending_buf_size||(S.gzhead.hcrc&&S.pending>C&&(y.adler=c(y.adler,S.pending_buf,S.pending-C,C)),P(y),C=S.pending,S.pending!==S.pending_buf_size));)et(S,255&S.gzhead.extra[S.gzindex]),S.gzindex++;S.gzhead.hcrc&&S.pending>C&&(y.adler=c(y.adler,S.pending_buf,S.pending-C,C)),S.gzindex===S.gzhead.extra.length&&(S.gzindex=0,S.status=73)}else S.status=73;if(S.status===73)if(S.gzhead.name){C=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>C&&(y.adler=c(y.adler,S.pending_buf,S.pending-C,C)),P(y),C=S.pending,S.pending===S.pending_buf_size)){D=1;break}D=S.gzindex<S.gzhead.name.length?255&S.gzhead.name.charCodeAt(S.gzindex++):0,et(S,D)}while(D!==0);S.gzhead.hcrc&&S.pending>C&&(y.adler=c(y.adler,S.pending_buf,S.pending-C,C)),D===0&&(S.gzindex=0,S.status=91)}else S.status=91;if(S.status===91)if(S.gzhead.comment){C=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>C&&(y.adler=c(y.adler,S.pending_buf,S.pending-C,C)),P(y),C=S.pending,S.pending===S.pending_buf_size)){D=1;break}D=S.gzindex<S.gzhead.comment.length?255&S.gzhead.comment.charCodeAt(S.gzindex++):0,et(S,D)}while(D!==0);S.gzhead.hcrc&&S.pending>C&&(y.adler=c(y.adler,S.pending_buf,S.pending-C,C)),D===0&&(S.status=103)}else S.status=103;if(S.status===103&&(S.gzhead.hcrc?(S.pending+2>S.pending_buf_size&&P(y),S.pending+2<=S.pending_buf_size&&(et(S,255&y.adler),et(S,y.adler>>8&255),y.adler=0,S.status=k)):S.status=k),S.pending!==0){if(P(y),y.avail_out===0)return S.last_flush=-1,d}else if(y.avail_in===0&&B(W)<=B(G)&&W!==f)return Z(y,-5);if(S.status===666&&y.avail_in!==0)return Z(y,-5);if(y.avail_in!==0||S.lookahead!==0||W!==u&&S.status!==666){var Y=S.strategy===2?function(N,V){for(var tt;;){if(N.lookahead===0&&(ft(N),N.lookahead===0)){if(V===u)return E;break}if(N.match_length=0,tt=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++,tt&&(R(N,!1),N.strm.avail_out===0))return E}return N.insert=0,V===f?(R(N,!0),N.strm.avail_out===0?X:z):N.last_lit&&(R(N,!1),N.strm.avail_out===0)?E:F}(S,W):S.strategy===3?function(N,V){for(var tt,q,it,vt,mt=N.window;;){if(N.lookahead<=M){if(ft(N),N.lookahead<=M&&V===u)return E;if(N.lookahead===0)break}if(N.match_length=0,N.lookahead>=L&&0<N.strstart&&(q=mt[it=N.strstart-1])===mt[++it]&&q===mt[++it]&&q===mt[++it]){vt=N.strstart+M;do;while(q===mt[++it]&&q===mt[++it]&&q===mt[++it]&&q===mt[++it]&&q===mt[++it]&&q===mt[++it]&&q===mt[++it]&&q===mt[++it]&&it<vt);N.match_length=M-(vt-it),N.match_length>N.lookahead&&(N.match_length=N.lookahead)}if(N.match_length>=L?(tt=a._tr_tally(N,1,N.match_length-L),N.lookahead-=N.match_length,N.strstart+=N.match_length,N.match_length=0):(tt=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++),tt&&(R(N,!1),N.strm.avail_out===0))return E}return N.insert=0,V===f?(R(N,!0),N.strm.avail_out===0?X:z):N.last_lit&&(R(N,!1),N.strm.avail_out===0)?E:F}(S,W):s[S.level].func(S,W);if(Y!==X&&Y!==z||(S.status=666),Y===E||Y===X)return y.avail_out===0&&(S.last_flush=-1),d;if(Y===F&&(W===1?a._tr_align(S):W!==5&&(a._tr_stored_block(S,0,0,!1),W===3&&(Q(S.head),S.lookahead===0&&(S.strstart=0,S.block_start=0,S.insert=0))),P(y),y.avail_out===0))return S.last_flush=-1,d}return W!==f?d:S.wrap<=0?1:(S.wrap===2?(et(S,255&y.adler),et(S,y.adler>>8&255),et(S,y.adler>>16&255),et(S,y.adler>>24&255),et(S,255&y.total_in),et(S,y.total_in>>8&255),et(S,y.total_in>>16&255),et(S,y.total_in>>24&255)):(J(S,y.adler>>>16),J(S,65535&y.adler)),P(y),0<S.wrap&&(S.wrap=-S.wrap),S.pending!==0?d:1)},r.deflateEnd=function(y){var W;return y&&y.state?(W=y.state.status)!==T&&W!==69&&W!==73&&W!==91&&W!==103&&W!==k&&W!==666?Z(y,_):(y.state=null,W===k?Z(y,-3):d):_},r.deflateSetDictionary=function(y,W){var G,S,C,D,$,Y,N,V,tt=W.length;if(!y||!y.state||(D=(G=y.state).wrap)===2||D===1&&G.status!==T||G.lookahead)return _;for(D===1&&(y.adler=l(y.adler,W,tt,0)),G.wrap=0,tt>=G.w_size&&(D===0&&(Q(G.head),G.strstart=0,G.block_start=0,G.insert=0),V=new o.Buf8(G.w_size),o.arraySet(V,W,tt-G.w_size,G.w_size,0),W=V,tt=G.w_size),$=y.avail_in,Y=y.next_in,N=y.input,y.avail_in=tt,y.next_in=0,y.input=W,ft(G);G.lookahead>=L;){for(S=G.strstart,C=G.lookahead-(L-1);G.ins_h=(G.ins_h<<G.hash_shift^G.window[S+L-1])&G.hash_mask,G.prev[S&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=S,S++,--C;);G.strstart=S,G.lookahead=L-1,ft(G)}return G.strstart+=G.lookahead,G.block_start=G.strstart,G.insert=G.lookahead,G.lookahead=0,G.match_length=G.prev_length=L-1,G.match_available=0,y.next_in=Y,y.input=N,y.avail_in=$,G.wrap=D,d},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,i,r){i.exports=function(s,o){var a,l,c,h,u,f,d,_,g,m,p,v,b,w,x,A,I,O,L,M,U,T,k,E,F;a=s.state,l=s.next_in,E=s.input,c=l+(s.avail_in-5),h=s.next_out,F=s.output,u=h-(o-s.avail_out),f=h+(s.avail_out-257),d=a.dmax,_=a.wsize,g=a.whave,m=a.wnext,p=a.window,v=a.hold,b=a.bits,w=a.lencode,x=a.distcode,A=(1<<a.lenbits)-1,I=(1<<a.distbits)-1;t:do{b<15&&(v+=E[l++]<<b,b+=8,v+=E[l++]<<b,b+=8),O=w[v&A];e:for(;;){if(v>>>=L=O>>>24,b-=L,(L=O>>>16&255)===0)F[h++]=65535&O;else{if(!(16&L)){if((64&L)==0){O=w[(65535&O)+(v&(1<<L)-1)];continue e}if(32&L){a.mode=12;break t}s.msg="invalid literal/length code",a.mode=30;break t}M=65535&O,(L&=15)&&(b<L&&(v+=E[l++]<<b,b+=8),M+=v&(1<<L)-1,v>>>=L,b-=L),b<15&&(v+=E[l++]<<b,b+=8,v+=E[l++]<<b,b+=8),O=x[v&I];i:for(;;){if(v>>>=L=O>>>24,b-=L,!(16&(L=O>>>16&255))){if((64&L)==0){O=x[(65535&O)+(v&(1<<L)-1)];continue i}s.msg="invalid distance code",a.mode=30;break t}if(U=65535&O,b<(L&=15)&&(v+=E[l++]<<b,(b+=8)<L&&(v+=E[l++]<<b,b+=8)),d<(U+=v&(1<<L)-1)){s.msg="invalid distance too far back",a.mode=30;break t}if(v>>>=L,b-=L,(L=h-u)<U){if(g<(L=U-L)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break t}if(k=p,(T=0)===m){if(T+=_-L,L<M){for(M-=L;F[h++]=p[T++],--L;);T=h-U,k=F}}else if(m<L){if(T+=_+m-L,(L-=m)<M){for(M-=L;F[h++]=p[T++],--L;);if(T=0,m<M){for(M-=L=m;F[h++]=p[T++],--L;);T=h-U,k=F}}}else if(T+=m-L,L<M){for(M-=L;F[h++]=p[T++],--L;);T=h-U,k=F}for(;2<M;)F[h++]=k[T++],F[h++]=k[T++],F[h++]=k[T++],M-=3;M&&(F[h++]=k[T++],1<M&&(F[h++]=k[T++]))}else{for(T=h-U;F[h++]=F[T++],F[h++]=F[T++],F[h++]=F[T++],2<(M-=3););M&&(F[h++]=F[T++],1<M&&(F[h++]=F[T++]))}break}}break}}while(l<c&&h<f);l-=M=b>>3,v&=(1<<(b-=M<<3))-1,s.next_in=l,s.next_out=h,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=h<f?f-h+257:257-(h-f),a.hold=v,a.bits=b}},{}],49:[function(e,i,r){var s=e("../utils/common"),o=e("./adler32"),a=e("./crc32"),l=e("./inffast"),c=e("./inftrees"),h=1,u=2,f=0,d=-2,_=1,g=852,m=592;function p(T){return(T>>>24&255)+(T>>>8&65280)+((65280&T)<<8)+((255&T)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(T){var k;return T&&T.state?(k=T.state,T.total_in=T.total_out=k.total=0,T.msg="",k.wrap&&(T.adler=1&k.wrap),k.mode=_,k.last=0,k.havedict=0,k.dmax=32768,k.head=null,k.hold=0,k.bits=0,k.lencode=k.lendyn=new s.Buf32(g),k.distcode=k.distdyn=new s.Buf32(m),k.sane=1,k.back=-1,f):d}function w(T){var k;return T&&T.state?((k=T.state).wsize=0,k.whave=0,k.wnext=0,b(T)):d}function x(T,k){var E,F;return T&&T.state?(F=T.state,k<0?(E=0,k=-k):(E=1+(k>>4),k<48&&(k&=15)),k&&(k<8||15<k)?d:(F.window!==null&&F.wbits!==k&&(F.window=null),F.wrap=E,F.wbits=k,w(T))):d}function A(T,k){var E,F;return T?(F=new v,(T.state=F).window=null,(E=x(T,k))!==f&&(T.state=null),E):d}var I,O,L=!0;function M(T){if(L){var k;for(I=new s.Buf32(512),O=new s.Buf32(32),k=0;k<144;)T.lens[k++]=8;for(;k<256;)T.lens[k++]=9;for(;k<280;)T.lens[k++]=7;for(;k<288;)T.lens[k++]=8;for(c(h,T.lens,0,288,I,0,T.work,{bits:9}),k=0;k<32;)T.lens[k++]=5;c(u,T.lens,0,32,O,0,T.work,{bits:5}),L=!1}T.lencode=I,T.lenbits=9,T.distcode=O,T.distbits=5}function U(T,k,E,F){var X,z=T.state;return z.window===null&&(z.wsize=1<<z.wbits,z.wnext=0,z.whave=0,z.window=new s.Buf8(z.wsize)),F>=z.wsize?(s.arraySet(z.window,k,E-z.wsize,z.wsize,0),z.wnext=0,z.whave=z.wsize):(F<(X=z.wsize-z.wnext)&&(X=F),s.arraySet(z.window,k,E-F,X,z.wnext),(F-=X)?(s.arraySet(z.window,k,E-F,F,0),z.wnext=F,z.whave=z.wsize):(z.wnext+=X,z.wnext===z.wsize&&(z.wnext=0),z.whave<z.wsize&&(z.whave+=X))),0}r.inflateReset=w,r.inflateReset2=x,r.inflateResetKeep=b,r.inflateInit=function(T){return A(T,15)},r.inflateInit2=A,r.inflate=function(T,k){var E,F,X,z,Z,B,Q,P,R,et,J,K,ft,pt,nt,ct,Et,Ct,$t,Pt,y,W,G,S,C=0,D=new s.Buf8(4),$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!T||!T.state||!T.output||!T.input&&T.avail_in!==0)return d;(E=T.state).mode===12&&(E.mode=13),Z=T.next_out,X=T.output,Q=T.avail_out,z=T.next_in,F=T.input,B=T.avail_in,P=E.hold,R=E.bits,et=B,J=Q,W=f;t:for(;;)switch(E.mode){case _:if(E.wrap===0){E.mode=13;break}for(;R<16;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if(2&E.wrap&&P===35615){D[E.check=0]=255&P,D[1]=P>>>8&255,E.check=a(E.check,D,2,0),R=P=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&P)<<8)+(P>>8))%31){T.msg="incorrect header check",E.mode=30;break}if((15&P)!=8){T.msg="unknown compression method",E.mode=30;break}if(R-=4,y=8+(15&(P>>>=4)),E.wbits===0)E.wbits=y;else if(y>E.wbits){T.msg="invalid window size",E.mode=30;break}E.dmax=1<<y,T.adler=E.check=1,E.mode=512&P?10:12,R=P=0;break;case 2:for(;R<16;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if(E.flags=P,(255&E.flags)!=8){T.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){T.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=P>>8&1),512&E.flags&&(D[0]=255&P,D[1]=P>>>8&255,E.check=a(E.check,D,2,0)),R=P=0,E.mode=3;case 3:for(;R<32;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}E.head&&(E.head.time=P),512&E.flags&&(D[0]=255&P,D[1]=P>>>8&255,D[2]=P>>>16&255,D[3]=P>>>24&255,E.check=a(E.check,D,4,0)),R=P=0,E.mode=4;case 4:for(;R<16;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}E.head&&(E.head.xflags=255&P,E.head.os=P>>8),512&E.flags&&(D[0]=255&P,D[1]=P>>>8&255,E.check=a(E.check,D,2,0)),R=P=0,E.mode=5;case 5:if(1024&E.flags){for(;R<16;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}E.length=P,E.head&&(E.head.extra_len=P),512&E.flags&&(D[0]=255&P,D[1]=P>>>8&255,E.check=a(E.check,D,2,0)),R=P=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(B<(K=E.length)&&(K=B),K&&(E.head&&(y=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),s.arraySet(E.head.extra,F,z,K,y)),512&E.flags&&(E.check=a(E.check,F,K,z)),B-=K,z+=K,E.length-=K),E.length))break t;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(B===0)break t;for(K=0;y=F[z+K++],E.head&&y&&E.length<65536&&(E.head.name+=String.fromCharCode(y)),y&&K<B;);if(512&E.flags&&(E.check=a(E.check,F,K,z)),B-=K,z+=K,y)break t}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(B===0)break t;for(K=0;y=F[z+K++],E.head&&y&&E.length<65536&&(E.head.comment+=String.fromCharCode(y)),y&&K<B;);if(512&E.flags&&(E.check=a(E.check,F,K,z)),B-=K,z+=K,y)break t}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;R<16;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if(P!==(65535&E.check)){T.msg="header crc mismatch",E.mode=30;break}R=P=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),T.adler=E.check=0,E.mode=12;break;case 10:for(;R<32;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}T.adler=E.check=p(P),R=P=0,E.mode=11;case 11:if(E.havedict===0)return T.next_out=Z,T.avail_out=Q,T.next_in=z,T.avail_in=B,E.hold=P,E.bits=R,2;T.adler=E.check=1,E.mode=12;case 12:if(k===5||k===6)break t;case 13:if(E.last){P>>>=7&R,R-=7&R,E.mode=27;break}for(;R<3;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}switch(E.last=1&P,R-=1,3&(P>>>=1)){case 0:E.mode=14;break;case 1:if(M(E),E.mode=20,k!==6)break;P>>>=2,R-=2;break t;case 2:E.mode=17;break;case 3:T.msg="invalid block type",E.mode=30}P>>>=2,R-=2;break;case 14:for(P>>>=7&R,R-=7&R;R<32;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if((65535&P)!=(P>>>16^65535)){T.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&P,R=P=0,E.mode=15,k===6)break t;case 15:E.mode=16;case 16:if(K=E.length){if(B<K&&(K=B),Q<K&&(K=Q),K===0)break t;s.arraySet(X,F,z,K,Z),B-=K,z+=K,Q-=K,Z+=K,E.length-=K;break}E.mode=12;break;case 17:for(;R<14;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if(E.nlen=257+(31&P),P>>>=5,R-=5,E.ndist=1+(31&P),P>>>=5,R-=5,E.ncode=4+(15&P),P>>>=4,R-=4,286<E.nlen||30<E.ndist){T.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;R<3;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}E.lens[$[E.have++]]=7&P,P>>>=3,R-=3}for(;E.have<19;)E.lens[$[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,G={bits:E.lenbits},W=c(0,E.lens,0,19,E.lencode,0,E.work,G),E.lenbits=G.bits,W){T.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;ct=(C=E.lencode[P&(1<<E.lenbits)-1])>>>16&255,Et=65535&C,!((nt=C>>>24)<=R);){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if(Et<16)P>>>=nt,R-=nt,E.lens[E.have++]=Et;else{if(Et===16){for(S=nt+2;R<S;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if(P>>>=nt,R-=nt,E.have===0){T.msg="invalid bit length repeat",E.mode=30;break}y=E.lens[E.have-1],K=3+(3&P),P>>>=2,R-=2}else if(Et===17){for(S=nt+3;R<S;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}R-=nt,y=0,K=3+(7&(P>>>=nt)),P>>>=3,R-=3}else{for(S=nt+7;R<S;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}R-=nt,y=0,K=11+(127&(P>>>=nt)),P>>>=7,R-=7}if(E.have+K>E.nlen+E.ndist){T.msg="invalid bit length repeat",E.mode=30;break}for(;K--;)E.lens[E.have++]=y}}if(E.mode===30)break;if(E.lens[256]===0){T.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,G={bits:E.lenbits},W=c(h,E.lens,0,E.nlen,E.lencode,0,E.work,G),E.lenbits=G.bits,W){T.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,G={bits:E.distbits},W=c(u,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,G),E.distbits=G.bits,W){T.msg="invalid distances set",E.mode=30;break}if(E.mode=20,k===6)break t;case 20:E.mode=21;case 21:if(6<=B&&258<=Q){T.next_out=Z,T.avail_out=Q,T.next_in=z,T.avail_in=B,E.hold=P,E.bits=R,l(T,J),Z=T.next_out,X=T.output,Q=T.avail_out,z=T.next_in,F=T.input,B=T.avail_in,P=E.hold,R=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;ct=(C=E.lencode[P&(1<<E.lenbits)-1])>>>16&255,Et=65535&C,!((nt=C>>>24)<=R);){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if(ct&&(240&ct)==0){for(Ct=nt,$t=ct,Pt=Et;ct=(C=E.lencode[Pt+((P&(1<<Ct+$t)-1)>>Ct)])>>>16&255,Et=65535&C,!(Ct+(nt=C>>>24)<=R);){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}P>>>=Ct,R-=Ct,E.back+=Ct}if(P>>>=nt,R-=nt,E.back+=nt,E.length=Et,ct===0){E.mode=26;break}if(32&ct){E.back=-1,E.mode=12;break}if(64&ct){T.msg="invalid literal/length code",E.mode=30;break}E.extra=15&ct,E.mode=22;case 22:if(E.extra){for(S=E.extra;R<S;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}E.length+=P&(1<<E.extra)-1,P>>>=E.extra,R-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;ct=(C=E.distcode[P&(1<<E.distbits)-1])>>>16&255,Et=65535&C,!((nt=C>>>24)<=R);){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if((240&ct)==0){for(Ct=nt,$t=ct,Pt=Et;ct=(C=E.distcode[Pt+((P&(1<<Ct+$t)-1)>>Ct)])>>>16&255,Et=65535&C,!(Ct+(nt=C>>>24)<=R);){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}P>>>=Ct,R-=Ct,E.back+=Ct}if(P>>>=nt,R-=nt,E.back+=nt,64&ct){T.msg="invalid distance code",E.mode=30;break}E.offset=Et,E.extra=15&ct,E.mode=24;case 24:if(E.extra){for(S=E.extra;R<S;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}E.offset+=P&(1<<E.extra)-1,P>>>=E.extra,R-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){T.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(Q===0)break t;if(K=J-Q,E.offset>K){if((K=E.offset-K)>E.whave&&E.sane){T.msg="invalid distance too far back",E.mode=30;break}ft=K>E.wnext?(K-=E.wnext,E.wsize-K):E.wnext-K,K>E.length&&(K=E.length),pt=E.window}else pt=X,ft=Z-E.offset,K=E.length;for(Q<K&&(K=Q),Q-=K,E.length-=K;X[Z++]=pt[ft++],--K;);E.length===0&&(E.mode=21);break;case 26:if(Q===0)break t;X[Z++]=E.length,Q--,E.mode=21;break;case 27:if(E.wrap){for(;R<32;){if(B===0)break t;B--,P|=F[z++]<<R,R+=8}if(J-=Q,T.total_out+=J,E.total+=J,J&&(T.adler=E.check=E.flags?a(E.check,X,J,Z-J):o(E.check,X,J,Z-J)),J=Q,(E.flags?P:p(P))!==E.check){T.msg="incorrect data check",E.mode=30;break}R=P=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;R<32;){if(B===0)break t;B--,P+=F[z++]<<R,R+=8}if(P!==(4294967295&E.total)){T.msg="incorrect length check",E.mode=30;break}R=P=0}E.mode=29;case 29:W=1;break t;case 30:W=-3;break t;case 31:return-4;case 32:default:return d}return T.next_out=Z,T.avail_out=Q,T.next_in=z,T.avail_in=B,E.hold=P,E.bits=R,(E.wsize||J!==T.avail_out&&E.mode<30&&(E.mode<27||k!==4))&&U(T,T.output,T.next_out,J-T.avail_out)?(E.mode=31,-4):(et-=T.avail_in,J-=T.avail_out,T.total_in+=et,T.total_out+=J,E.total+=J,E.wrap&&J&&(T.adler=E.check=E.flags?a(E.check,X,J,T.next_out-J):o(E.check,X,J,T.next_out-J)),T.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(et==0&&J===0||k===4)&&W===f&&(W=-5),W)},r.inflateEnd=function(T){if(!T||!T.state)return d;var k=T.state;return k.window&&(k.window=null),T.state=null,f},r.inflateGetHeader=function(T,k){var E;return T&&T.state?(2&(E=T.state).wrap)==0?d:((E.head=k).done=!1,f):d},r.inflateSetDictionary=function(T,k){var E,F=k.length;return T&&T.state?(E=T.state).wrap!==0&&E.mode!==11?d:E.mode===11&&o(1,k,F,0)!==E.check?-3:U(T,k,F,F)?(E.mode=31,-4):(E.havedict=1,f):d},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,i,r){var s=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(h,u,f,d,_,g,m,p){var v,b,w,x,A,I,O,L,M,U=p.bits,T=0,k=0,E=0,F=0,X=0,z=0,Z=0,B=0,Q=0,P=0,R=null,et=0,J=new s.Buf16(16),K=new s.Buf16(16),ft=null,pt=0;for(T=0;T<=15;T++)J[T]=0;for(k=0;k<d;k++)J[u[f+k]]++;for(X=U,F=15;1<=F&&J[F]===0;F--);if(F<X&&(X=F),F===0)return _[g++]=20971520,_[g++]=20971520,p.bits=1,0;for(E=1;E<F&&J[E]===0;E++);for(X<E&&(X=E),T=B=1;T<=15;T++)if(B<<=1,(B-=J[T])<0)return-1;if(0<B&&(h===0||F!==1))return-1;for(K[1]=0,T=1;T<15;T++)K[T+1]=K[T]+J[T];for(k=0;k<d;k++)u[f+k]!==0&&(m[K[u[f+k]]++]=k);if(I=h===0?(R=ft=m,19):h===1?(R=o,et-=257,ft=a,pt-=257,256):(R=l,ft=c,-1),T=E,A=g,Z=k=P=0,w=-1,x=(Q=1<<(z=X))-1,h===1&&852<Q||h===2&&592<Q)return 1;for(;;){for(O=T-Z,M=m[k]<I?(L=0,m[k]):m[k]>I?(L=ft[pt+m[k]],R[et+m[k]]):(L=96,0),v=1<<T-Z,E=b=1<<z;_[A+(P>>Z)+(b-=v)]=O<<24|L<<16|M|0,b!==0;);for(v=1<<T-1;P&v;)v>>=1;if(v!==0?(P&=v-1,P+=v):P=0,k++,--J[T]==0){if(T===F)break;T=u[f+m[k]]}if(X<T&&(P&x)!==w){for(Z===0&&(Z=X),A+=E,B=1<<(z=T-Z);z+Z<F&&!((B-=J[z+Z])<=0);)z++,B<<=1;if(Q+=1<<z,h===1&&852<Q||h===2&&592<Q)return 1;_[w=P&x]=X<<24|z<<16|A-g|0}}return P!==0&&(_[A+P]=T-Z<<24|64<<16|0),p.bits=X,0}},{"../utils/common":41}],51:[function(e,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,i,r){var s=e("../utils/common"),o=0,a=1;function l(C){for(var D=C.length;0<=--D;)C[D]=0}var c=0,h=29,u=256,f=u+1+h,d=30,_=19,g=2*f+1,m=15,p=16,v=7,b=256,w=16,x=17,A=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=new Array(2*(f+2));l(U);var T=new Array(2*d);l(T);var k=new Array(512);l(k);var E=new Array(256);l(E);var F=new Array(h);l(F);var X,z,Z,B=new Array(d);function Q(C,D,$,Y,N){this.static_tree=C,this.extra_bits=D,this.extra_base=$,this.elems=Y,this.max_length=N,this.has_stree=C&&C.length}function P(C,D){this.dyn_tree=C,this.max_code=0,this.stat_desc=D}function R(C){return C<256?k[C]:k[256+(C>>>7)]}function et(C,D){C.pending_buf[C.pending++]=255&D,C.pending_buf[C.pending++]=D>>>8&255}function J(C,D,$){C.bi_valid>p-$?(C.bi_buf|=D<<C.bi_valid&65535,et(C,C.bi_buf),C.bi_buf=D>>p-C.bi_valid,C.bi_valid+=$-p):(C.bi_buf|=D<<C.bi_valid&65535,C.bi_valid+=$)}function K(C,D,$){J(C,$[2*D],$[2*D+1])}function ft(C,D){for(var $=0;$|=1&C,C>>>=1,$<<=1,0<--D;);return $>>>1}function pt(C,D,$){var Y,N,V=new Array(m+1),tt=0;for(Y=1;Y<=m;Y++)V[Y]=tt=tt+$[Y-1]<<1;for(N=0;N<=D;N++){var q=C[2*N+1];q!==0&&(C[2*N]=ft(V[q]++,q))}}function nt(C){var D;for(D=0;D<f;D++)C.dyn_ltree[2*D]=0;for(D=0;D<d;D++)C.dyn_dtree[2*D]=0;for(D=0;D<_;D++)C.bl_tree[2*D]=0;C.dyn_ltree[2*b]=1,C.opt_len=C.static_len=0,C.last_lit=C.matches=0}function ct(C){8<C.bi_valid?et(C,C.bi_buf):0<C.bi_valid&&(C.pending_buf[C.pending++]=C.bi_buf),C.bi_buf=0,C.bi_valid=0}function Et(C,D,$,Y){var N=2*D,V=2*$;return C[N]<C[V]||C[N]===C[V]&&Y[D]<=Y[$]}function Ct(C,D,$){for(var Y=C.heap[$],N=$<<1;N<=C.heap_len&&(N<C.heap_len&&Et(D,C.heap[N+1],C.heap[N],C.depth)&&N++,!Et(D,Y,C.heap[N],C.depth));)C.heap[$]=C.heap[N],$=N,N<<=1;C.heap[$]=Y}function $t(C,D,$){var Y,N,V,tt,q=0;if(C.last_lit!==0)for(;Y=C.pending_buf[C.d_buf+2*q]<<8|C.pending_buf[C.d_buf+2*q+1],N=C.pending_buf[C.l_buf+q],q++,Y===0?K(C,N,D):(K(C,(V=E[N])+u+1,D),(tt=I[V])!==0&&J(C,N-=F[V],tt),K(C,V=R(--Y),$),(tt=O[V])!==0&&J(C,Y-=B[V],tt)),q<C.last_lit;);K(C,b,D)}function Pt(C,D){var $,Y,N,V=D.dyn_tree,tt=D.stat_desc.static_tree,q=D.stat_desc.has_stree,it=D.stat_desc.elems,vt=-1;for(C.heap_len=0,C.heap_max=g,$=0;$<it;$++)V[2*$]!==0?(C.heap[++C.heap_len]=vt=$,C.depth[$]=0):V[2*$+1]=0;for(;C.heap_len<2;)V[2*(N=C.heap[++C.heap_len]=vt<2?++vt:0)]=1,C.depth[N]=0,C.opt_len--,q&&(C.static_len-=tt[2*N+1]);for(D.max_code=vt,$=C.heap_len>>1;1<=$;$--)Ct(C,V,$);for(N=it;$=C.heap[1],C.heap[1]=C.heap[C.heap_len--],Ct(C,V,1),Y=C.heap[1],C.heap[--C.heap_max]=$,C.heap[--C.heap_max]=Y,V[2*N]=V[2*$]+V[2*Y],C.depth[N]=(C.depth[$]>=C.depth[Y]?C.depth[$]:C.depth[Y])+1,V[2*$+1]=V[2*Y+1]=N,C.heap[1]=N++,Ct(C,V,1),2<=C.heap_len;);C.heap[--C.heap_max]=C.heap[1],function(mt,Yt){var ri,qt,Di,Rt,Mi,gn,se=Yt.dyn_tree,hr=Yt.max_code,Mo=Yt.stat_desc.static_tree,cr=Yt.stat_desc.has_stree,Pi=Yt.stat_desc.extra_bits,si=Yt.stat_desc.extra_base,xe=Yt.stat_desc.max_length,Ni=0;for(Rt=0;Rt<=m;Rt++)mt.bl_count[Rt]=0;for(se[2*mt.heap[mt.heap_max]+1]=0,ri=mt.heap_max+1;ri<g;ri++)xe<(Rt=se[2*se[2*(qt=mt.heap[ri])+1]+1]+1)&&(Rt=xe,Ni++),se[2*qt+1]=Rt,hr<qt||(mt.bl_count[Rt]++,Mi=0,si<=qt&&(Mi=Pi[qt-si]),gn=se[2*qt],mt.opt_len+=gn*(Rt+Mi),cr&&(mt.static_len+=gn*(Mo[2*qt+1]+Mi)));if(Ni!==0){do{for(Rt=xe-1;mt.bl_count[Rt]===0;)Rt--;mt.bl_count[Rt]--,mt.bl_count[Rt+1]+=2,mt.bl_count[xe]--,Ni-=2}while(0<Ni);for(Rt=xe;Rt!==0;Rt--)for(qt=mt.bl_count[Rt];qt!==0;)hr<(Di=mt.heap[--ri])||(se[2*Di+1]!==Rt&&(mt.opt_len+=(Rt-se[2*Di+1])*se[2*Di],se[2*Di+1]=Rt),qt--)}}(C,D),pt(V,vt,C.bl_count)}function y(C,D,$){var Y,N,V=-1,tt=D[1],q=0,it=7,vt=4;for(tt===0&&(it=138,vt=3),D[2*($+1)+1]=65535,Y=0;Y<=$;Y++)N=tt,tt=D[2*(Y+1)+1],++q<it&&N===tt||(q<vt?C.bl_tree[2*N]+=q:N!==0?(N!==V&&C.bl_tree[2*N]++,C.bl_tree[2*w]++):q<=10?C.bl_tree[2*x]++:C.bl_tree[2*A]++,V=N,vt=(q=0)===tt?(it=138,3):N===tt?(it=6,3):(it=7,4))}function W(C,D,$){var Y,N,V=-1,tt=D[1],q=0,it=7,vt=4;for(tt===0&&(it=138,vt=3),Y=0;Y<=$;Y++)if(N=tt,tt=D[2*(Y+1)+1],!(++q<it&&N===tt)){if(q<vt)for(;K(C,N,C.bl_tree),--q!=0;);else N!==0?(N!==V&&(K(C,N,C.bl_tree),q--),K(C,w,C.bl_tree),J(C,q-3,2)):q<=10?(K(C,x,C.bl_tree),J(C,q-3,3)):(K(C,A,C.bl_tree),J(C,q-11,7));V=N,vt=(q=0)===tt?(it=138,3):N===tt?(it=6,3):(it=7,4)}}l(B);var G=!1;function S(C,D,$,Y){J(C,(c<<1)+(Y?1:0),3),function(N,V,tt,q){ct(N),et(N,tt),et(N,~tt),s.arraySet(N.pending_buf,N.window,V,tt,N.pending),N.pending+=tt}(C,D,$)}r._tr_init=function(C){G||(function(){var D,$,Y,N,V,tt=new Array(m+1);for(N=Y=0;N<h-1;N++)for(F[N]=Y,D=0;D<1<<I[N];D++)E[Y++]=N;for(E[Y-1]=N,N=V=0;N<16;N++)for(B[N]=V,D=0;D<1<<O[N];D++)k[V++]=N;for(V>>=7;N<d;N++)for(B[N]=V<<7,D=0;D<1<<O[N]-7;D++)k[256+V++]=N;for($=0;$<=m;$++)tt[$]=0;for(D=0;D<=143;)U[2*D+1]=8,D++,tt[8]++;for(;D<=255;)U[2*D+1]=9,D++,tt[9]++;for(;D<=279;)U[2*D+1]=7,D++,tt[7]++;for(;D<=287;)U[2*D+1]=8,D++,tt[8]++;for(pt(U,f+1,tt),D=0;D<d;D++)T[2*D+1]=5,T[2*D]=ft(D,5);X=new Q(U,I,u+1,f,m),z=new Q(T,O,0,d,m),Z=new Q(new Array(0),L,0,_,v)}(),G=!0),C.l_desc=new P(C.dyn_ltree,X),C.d_desc=new P(C.dyn_dtree,z),C.bl_desc=new P(C.bl_tree,Z),C.bi_buf=0,C.bi_valid=0,nt(C)},r._tr_stored_block=S,r._tr_flush_block=function(C,D,$,Y){var N,V,tt=0;0<C.level?(C.strm.data_type===2&&(C.strm.data_type=function(q){var it,vt=4093624447;for(it=0;it<=31;it++,vt>>>=1)if(1&vt&&q.dyn_ltree[2*it]!==0)return o;if(q.dyn_ltree[18]!==0||q.dyn_ltree[20]!==0||q.dyn_ltree[26]!==0)return a;for(it=32;it<u;it++)if(q.dyn_ltree[2*it]!==0)return a;return o}(C)),Pt(C,C.l_desc),Pt(C,C.d_desc),tt=function(q){var it;for(y(q,q.dyn_ltree,q.l_desc.max_code),y(q,q.dyn_dtree,q.d_desc.max_code),Pt(q,q.bl_desc),it=_-1;3<=it&&q.bl_tree[2*M[it]+1]===0;it--);return q.opt_len+=3*(it+1)+5+5+4,it}(C),N=C.opt_len+3+7>>>3,(V=C.static_len+3+7>>>3)<=N&&(N=V)):N=V=$+5,$+4<=N&&D!==-1?S(C,D,$,Y):C.strategy===4||V===N?(J(C,2+(Y?1:0),3),$t(C,U,T)):(J(C,4+(Y?1:0),3),function(q,it,vt,mt){var Yt;for(J(q,it-257,5),J(q,vt-1,5),J(q,mt-4,4),Yt=0;Yt<mt;Yt++)J(q,q.bl_tree[2*M[Yt]+1],3);W(q,q.dyn_ltree,it-1),W(q,q.dyn_dtree,vt-1)}(C,C.l_desc.max_code+1,C.d_desc.max_code+1,tt+1),$t(C,C.dyn_ltree,C.dyn_dtree)),nt(C),Y&&ct(C)},r._tr_tally=function(C,D,$){return C.pending_buf[C.d_buf+2*C.last_lit]=D>>>8&255,C.pending_buf[C.d_buf+2*C.last_lit+1]=255&D,C.pending_buf[C.l_buf+C.last_lit]=255&$,C.last_lit++,D===0?C.dyn_ltree[2*$]++:(C.matches++,D--,C.dyn_ltree[2*(E[$]+u+1)]++,C.dyn_dtree[2*R(D)]++),C.last_lit===C.lit_bufsize-1},r._tr_align=function(C){J(C,2,3),K(C,b,U),function(D){D.bi_valid===16?(et(D,D.bi_buf),D.bi_buf=0,D.bi_valid=0):8<=D.bi_valid&&(D.pending_buf[D.pending++]=255&D.bi_buf,D.bi_buf>>=8,D.bi_valid-=8)}(C)}},{"../utils/common":41}],53:[function(e,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,i,r){(function(s){(function(o,a){if(!o.setImmediate){var l,c,h,u,f=1,d={},_=!1,g=o.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(o);m=m&&m.setTimeout?m:o,l={}.toString.call(o.process)==="[object process]"?function(w){process.nextTick(function(){v(w)})}:function(){if(o.postMessage&&!o.importScripts){var w=!0,x=o.onmessage;return o.onmessage=function(){w=!1},o.postMessage("","*"),o.onmessage=x,w}}()?(u="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",b,!1):o.attachEvent("onmessage",b),function(w){o.postMessage(u+w,"*")}):o.MessageChannel?((h=new MessageChannel).port1.onmessage=function(w){v(w.data)},function(w){h.port2.postMessage(w)}):g&&"onreadystatechange"in g.createElement("script")?(c=g.documentElement,function(w){var x=g.createElement("script");x.onreadystatechange=function(){v(w),x.onreadystatechange=null,c.removeChild(x),x=null},c.appendChild(x)}):function(w){setTimeout(v,0,w)},m.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var x=new Array(arguments.length-1),A=0;A<x.length;A++)x[A]=arguments[A+1];var I={callback:w,args:x};return d[f]=I,l(f),f++},m.clearImmediate=p}function p(w){delete d[w]}function v(w){if(_)setTimeout(v,0,w);else{var x=d[w];if(x){_=!0;try{(function(A){var I=A.callback,O=A.args;switch(O.length){case 0:I();break;case 1:I(O[0]);break;case 2:I(O[0],O[1]);break;case 3:I(O[0],O[1],O[2]);break;default:I.apply(a,O)}})(x)}finally{p(w),_=!1}}}}function b(w){w.source===o&&typeof w.data=="string"&&w.data.indexOf(u)===0&&v(+w.data.slice(u.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof yi<"u"?yi:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(ba)),ba.exports}var f1=Uf();const g1=jf(f1);var pr={},xa={},eu;function Yf(){return eu||(eu=1,xa.geometries={NULL:0,POINT:1,POLYLINE:3,POLYGON:5,MULTIPOINT:8,POINTZ:11,POLYLINEZ:13,POLYGONZ:15,MULTIPOINTZ:18,POINTM:21,POLYLINEM:23,POLYGONM:25,MULTIPOINTM:28,MULTIPATCH:31}),xa}var Ca={},Ta,iu;function Xf(){return iu||(iu=1,Ta={C:254,L:1,D:8,N:18,M:18,F:18,B:8}),Ta}var yr={},nu;function _1(){return nu||(nu=1,yr.lpad=function(t,e,i){for(;t.length<e;)t=i+t;return t},yr.rpad=function(t,e,i){for(;t.length<e;)t=t+i;return t},yr.writeField=function(t,e,i,r){for(var s=0;s<e;s++)t.setUint8(r,i.charCodeAt(s)),r++;return r}),yr}var Er={},ru;function m1(){if(ru)return Er;ru=1;var n=Xf(),t={string:"C",number:"N",boolean:"L",null:"C"};Er.multi=e,Er.bytesPer=s,Er.obj=r;function e(o){var a={};o.forEach(l);function l(c){i(a,c)}return r(a)}function i(o,a){for(var l in a){var c=typeof a[l]<"u"&&a[l]!==null;(typeof o[l]>"u"||c)&&(o[l]=a[l])}return o}function r(o){var a={},l=[];for(var c in o)a[c]=o[c]===null?"null":typeof o[c];for(var h in a){var u=t[a[h]];u&&l.push({name:h,type:u,size:n[u]})}return l}function s(o){return o.reduce(function(a,l){return a+l.size},1)}return Er}var Sa,su;function p1(){if(su)return Sa;su=1,Xf();var n=_1(),t=m1();return Sa=function(i,r){var s=r||t.multi(i),o=32*s.length+1,a=t.bytesPer(s),l=new ArrayBuffer(o+32+a*i.length+1),c=new Date,h=new DataView(l);h.setUint8(0,3),h.setUint8(1,c.getFullYear()-1900),h.setUint8(2,c.getMonth()+1),h.setUint8(3,c.getDate()),h.setUint32(4,i.length,!0);var u=o+32;h.setUint16(8,u,!0),h.setUint16(10,a,!0),h.setInt8(32+o-1,13),s.forEach(function(d,_){d.name.split("").slice(0,10).forEach(function(g,m){h.setInt8(32+_*32+m,g.charCodeAt(0))}),h.setInt8(32+_*32+11,d.type.charCodeAt(0)),h.setInt8(32+_*32+16,d.size),d.type=="N"&&h.setInt8(32+_*32+17,3)});var f=o+32;return i.forEach(function(d,_){h.setUint8(f,32),f++,s.forEach(function(g){var m=d[g.name];switch((m===null||typeof m>"u")&&(m=""),g.type){case"L":h.setUint8(f,m?84:70),f++;break;case"D":f=n.writeField(h,8,n.lpad(m.toString(),8," "),f);break;case"N":f=n.writeField(h,g.size,n.lpad(m.toString(),g.size," ").substr(0,18),f);break;case"C":f=n.writeField(h,g.size,n.rpad(m.toString(),g.size," "),f);break;default:throw new Error("Unknown field type")}})}),h.setUint8(f,26),h},Sa}var ou;function y1(){return ou||(ou=1,Ca.structure=p1()),Ca}var Aa,au;function Kf(){return au||(au=1,Aa='GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]]'),Aa}var Bi={},vr={},lu;function Vf(){return lu||(lu=1,vr.enlarge=function(t,e){return e[0]<t.xmin&&(t.xmin=e[0]),e[0]>t.xmax&&(t.xmax=e[0]),e[1]<t.ymin&&(t.ymin=e[1]),e[1]>t.ymax&&(t.ymax=e[1]),t},vr.enlargeExtent=function(t,e){return e.xmax>t.xmax&&(t.xmax=e.xmax),e.xmin<t.xmin&&(t.xmin=e.xmin),e.ymax>t.ymax&&(t.ymax=e.ymax),e.ymin<t.ymin&&(t.ymin=e.ymin),t},vr.blank=function(){return{xmin:Number.MAX_VALUE,ymin:Number.MAX_VALUE,xmax:-Number.MAX_VALUE,ymax:-Number.MAX_VALUE}}),vr}var hu;function E1(){if(hu)return Bi;hu=1;var n=Vf();return Bi.write=function(e,i,r,s){var o=28,a=100,l=0,c=0;e.forEach(function(u,f){r.setInt32(l,f+1),r.setInt32(l+4,10),r.setInt32(l+8,1,!0),r.setFloat64(l+12,u[0],!0),r.setFloat64(l+20,u[1],!0),s.setInt32(c,a/2),s.setInt32(c+4,10),c+=8,l+=o,a+=o})},Bi.extent=function(t){return t.reduce(function(e,i){return n.enlarge(e,i)},n.blank())},Bi.parts=function(e,i){return e.length},Bi.shxLength=function(t){return t.length*8},Bi.shpLength=function(t){return t.length*28},Bi}var Wi={},cu;function v1(){if(cu)return Wi;cu=1;var n=Vf(),t=Yf();Wi.write=function(s,o,a,l,c){var h=0,u=0,f=100;s.forEach(d);function d(_,g){var m=i(_),p=e([_],c),v=m.length*16+48+(p-1)*4,b=m.reduce(function(A,I){return n.enlarge(A,I)},n.blank());l.setInt32(u,f/2),l.setInt32(u+4,v/2),u+=8,f+=v+8,a.setInt32(h,g+1),a.setInt32(h+4,v/2),a.setInt32(h+8,c,!0),a.setFloat64(h+12,b.xmin,!0),a.setFloat64(h+20,b.ymin,!0),a.setFloat64(h+28,b.xmax,!0),a.setFloat64(h+36,b.ymax,!0),a.setInt32(h+44,p,!0),a.setInt32(h+48,m.length,!0),a.setInt32(h+52,0,!0);for(var w=_.reduce(function(A,I){return Array.isArray(I[0][0])?A=A.concat(I):A.push(I),A},[]),x=1;x<p;x++)a.setInt32(h+52+x*4,w.reduce(function(A,I,O){return O<x?A+I.length:A},0),!0);m.forEach(function(I,O){a.setFloat64(h+56+O*16+(p-1)*4,I[0],!0),a.setFloat64(h+56+O*16+(p-1)*4+8,I[1],!0)}),h+=v+8}},Wi.shpLength=function(r){return r.length*56+i(r).length*16},Wi.shxLength=function(r){return r.length*8},Wi.extent=function(r){return i(r).reduce(function(s,o){return n.enlarge(s,o)},n.blank())};function e(r,s){var o=1;return(s===t.geometries.POLYGON||s===t.geometries.POLYLINE)&&(o=r.reduce(function(a,l){return a+=l.length,Array.isArray(l[0][0][0])&&(a+=l.reduce(function(c,h){return c+h.length-1},0)),a},0)),o}Wi.parts=e;function i(r,s){return s===void 0&&(s=[]),typeof r[0][0]=="object"?r.reduce(function(o,a){return o.concat(i(a))},s):r}return Wi}var Ia,uu;function Hf(){if(uu)return Ia;uu=1;var n=Yf(),t=y1(),e=Kf(),i=E1(),r=v1(),s={1:i,5:r,3:r};Ia=o;function o(c,h,u,f){var d=n.geometries[h],_=s[d],g=_.parts(u,d),m=100+(g-u.length)*4+_.shpLength(u),p=100+_.shxLength(u),v=new ArrayBuffer(m),b=new DataView(v),w=new ArrayBuffer(p),x=new DataView(w),A=_.extent(u);a(b,d),a(x,d),l(A,b),l(A,x),_.write(u,A,new DataView(v,100),new DataView(w,100),d),b.setInt32(24,m/2),x.setInt32(24,50+u.length*4);var I=t.structure(c);f(null,{shp:b,shx:x,dbf:I,prj:e})}function a(c,h){c.setInt32(0,9994),c.setInt32(28,1e3,!0),c.setInt32(32,h,!0)}function l(c,h){h.setFloat64(36,c.xmin,!0),h.setFloat64(44,c.ymin,!0),h.setFloat64(52,c.xmax,!0),h.setFloat64(60,c.ymax,!0)}return Ia}var $i={},du;function w1(){if(du)return $i;du=1,$i.point=n("Point","POINT"),$i.line=n("LineString","POLYLINE"),$i.multiline=n("MultiLineString","POLYLINE"),$i.polygon=n("Polygon","POLYGON"),$i.multipolygon=n("MultiPolygon","POLYGON");function n(r,s){return function(o){var a=o.features.filter(i(r));return{geometries:s==="POLYLINE"?[a.map(t)]:a.map(t),properties:a.map(e),type:s}}}function t(r){return r.geometry.coordinates}function e(r){return r.properties}function i(r){return Array.isArray(r)?function(s){return r.includes(s.geometry.type)}:function(s){return s.geometry.type===r}}return $i}var Ra,fu;function Zf(){if(fu)return Ra;fu=1;var n=Hf(),t=w1(),e=Kf(),i=Uf();return Ra=function(r,s,o=!1){let a=new i,l=a;s&&s.folder&&(l=a.folder(s.folder));var c=s&&s.prj?s.prj:e;[t.point(r),t.line(r),t.polygon(r),t.multipolygon(r),t.multiline(r)].forEach(function(u){u.geometries.length&&u.geometries[0].length&&n(u.properties,u.type,u.geometries,function(f,d){var _=s&&s.types&&s.types[u.type.toLowerCase()]?s.types[u.type.toLowerCase()]:u.type;l.file(_+".shp",d.shp.buffer,{binary:!0}),l.file(_+".shx",d.shx.buffer,{binary:!0}),l.file(_+".dbf",d.dbf.buffer,{binary:!0}),l.file(_+".prj",c)})});var h={};return!s||!s.outputType?h.type="base64":h.type=s.outputType,!s||!s.compression?h.compression="DEFLATE":h.compression=s.compression,o?a.generateNodeStream({...h,streamFiles:!0}):a.generateAsync(h)},Ra}var ks={exports:{}},b1=ks.exports,gu;function x1(){return gu||(gu=1,function(n,t){(function(e,i){i()})(b1,function(){function e(c,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function i(c,h,u){var f=new XMLHttpRequest;f.open("GET",c),f.responseType="blob",f.onload=function(){l(f.response,h,u)},f.onerror=function(){console.error("could not download file")},f.send()}function r(c){var h=new XMLHttpRequest;h.open("HEAD",c,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(h)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof yi=="object"&&yi.global===yi?yi:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(c,h,u){var f=o.URL||o.webkitURL,d=document.createElement("a");h=h||c.name||"download",d.download=h,d.rel="noopener",typeof c=="string"?(d.href=c,d.origin===location.origin?s(d):r(d.href)?i(c,h,u):s(d,d.target="_blank")):(d.href=f.createObjectURL(c),setTimeout(function(){f.revokeObjectURL(d.href)},4e4),setTimeout(function(){s(d)},0))}:"msSaveOrOpenBlob"in navigator?function(c,h,u){if(h=h||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(e(c,u),h);else if(r(c))i(c,h,u);else{var f=document.createElement("a");f.href=c,f.target="_blank",setTimeout(function(){s(f)})}}:function(c,h,u,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof c=="string")return i(c,h,u);var d=c.type==="application/octet-stream",_=/constructor/i.test(o.HTMLElement)||o.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||d&&_||a)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var b=m.result;b=g?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=b:location=b,f=null},m.readAsDataURL(c)}else{var p=o.URL||o.webkitURL,v=p.createObjectURL(c);f?f.location=v:location.href=v,f=null,setTimeout(function(){p.revokeObjectURL(v)},4e4)}});o.saveAs=l.saveAs=l,n.exports=l})}(ks)),ks.exports}var La,_u;function C1(){if(_u)return La;_u=1;var n=Zf(),t=x1().saveAs;return La=function(e,i){let r="download";i&&(i.filename||i.folder)&&(r=i.filename||i.folder),n(e,i).then(function(s){t(s,r+".zip")})},La}var mu;function T1(){return mu||(mu=1,pr.download=C1(),pr.write=Hf(),pr.zip=Zf()),pr}var S1=T1();const A1=jf(S1),Ei=document.createElement("canvas"),Nn=Ei.getContext("2d");Ei.width=16;Ei.height=16;Nn.strokeStyle="rgba(51, 51, 51, 0.4)";const I1=(n,t,e)=>{const i=Math.max(Math.ceil((t-n)/e),0),r=Array(i);for(let s=0;s<i;s++,n+=e)r[s]=n;return r};I1(-1*Ei.width,Ei.height,8).forEach(n=>{Nn.beginPath(),Nn.moveTo(n,0),Nn.lineTo(Ei.width+n,Ei.height),Nn.stroke()});const R1=Nn.createPattern(Ei,"repeat"),L1=[0,5,17,33,45,57,69,93,117],pu={error_cone:{0:new at({fill:new ut({color:R1}),stroke:new Lt({color:[51,51,51,.4],width:1}),zIndex:2}),72:new at({fill:new ut({color:[224,224,224,.7]}),stroke:new Lt({color:[0,0,0,.4],width:1}),zIndex:3}),120:new at({fill:new ut({color:[255,255,255,.4]}),stroke:new Lt({color:[0,0,0,.4],width:1}),zIndex:1})},forecast_position:{default:new at({image:new Bt({fill:new ut({color:"#FFFFFF"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:1,angle:Math.PI/4})}),RED:new at({image:new Bt({fill:new ut({color:"#FF0000"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})}),BLUE:new at({image:new Bt({fill:new ut({color:"#0024FA"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})}),WHITE:new at({image:new Bt({fill:new ut({color:"#FFFFFF"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})}),YELLOW:new at({image:new Bt({fill:new ut({color:"#FFFF33"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})})},forecast_track_line:{default:new at({stroke:new Lt({color:"#777777",width:2})})},past_track_line:{default:new at({stroke:new Lt({color:"#777777",width:2})})},warning_line:{default:new at({stroke:new Lt({color:"#777777",width:2})})},forecast_track_point:{RED:new at({image:new Bt({fill:new ut({color:"#FF0000"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})}),BLUE:new at({image:new Bt({fill:new ut({color:"#0024FA"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})}),WHITE:new at({image:new Bt({fill:new ut({color:"#FFFFFF"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})}),YELLOW:new at({image:new Bt({fill:new ut({color:"#FFFF33"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})})},forecast_winds:{RED:new at({fill:new ut({color:"rgba(255, 0, 0, 0.4)"})}),BLUE:new at({fill:new ut({color:"rgba(0, 36, 250, 0.4)"})}),WHITE:new at({fill:new ut({color:"rgba(255, 255, 255, 0.4)"})}),YELLOW:new at({fill:new ut({color:"rgba(255, 255, 51, 0.4)"})})},past_wind:{RED:new at({fill:new ut({color:"rgba(255, 0, 0, 0.4)"})}),BLUE:new at({fill:new ut({color:"rgba(0, 36, 250, 0.4)"})}),WHITE:new at({fill:new ut({color:"rgba(255, 255, 255, 0.4)"})}),YELLOW:new at({fill:new ut({color:"rgba(255, 255, 51, 0.4)"})})},past_track_point:{RED:new at({image:new Bt({fill:new ut({color:"#FF0000"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})}),BLUE:new at({image:new Bt({fill:new ut({color:"#0024FA"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})}),WHITE:new at({image:new Bt({fill:new ut({color:"#FFFFFF"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})}),YELLOW:new at({image:new Bt({fill:new ut({color:"#FFFF33"}),stroke:new Lt({color:"#000000",width:.5}),points:4,radius:5,angle:Math.PI/4})})},wind_prob_point:{default:new at({fill:new ut({color:"rgba(0, 178, 0, 0.4)"}),zIndex:1})},wind_prob_polygon:{GREEN:new at({fill:new ut({color:"rgba(0, 178, 0, 0.4)"}),zIndex:1}),LIMEGREEN:new at({fill:new ut({color:"rgba(0, 255, 0, 0.4)"}),zIndex:2}),LIGHTYELLOW:new at({fill:new ut({color:"rgba(255, 255, 0, 0.4)"}),zIndex:3}),BLANDYELLOW:new at({fill:new ut({color:"rgba(255, 204, 102, 0.4)"}),zIndex:4}),DARKORANGE:new at({fill:new ut({color:"rgba(204, 102, 0, 0.4)"}),zIndex:5}),ORANGE:new at({fill:new ut({color:"rgba(255, 128, 0, 0.4)"}),zIndex:6}),RED:new at({fill:new ut({color:"rgba(192, 0, 0, 0.4)"}),zIndex:7}),DARKRED:new at({fill:new ut({color:"rgba(128, 0, 0, 0.4)"}),zIndex:8}),PURPLE:new at({fill:new ut({color:"rgba(102, 0, 204, 0.4)"}),zIndex:9})},forecast_wind_swath:{RED:new at({fill:new ut({color:"rgba(255, 0, 0, 0.4)"})}),BLUE:new at({fill:new ut({color:"rgba(0, 36, 250, 0.4)"})}),WHITE:new at({fill:new ut({color:"rgba(255, 255, 255, 0.4)"})}),YELLOW:new at({fill:new ut({color:"rgba(255, 255, 51, 0.4)"})})},getColorFromWS(n){return n>=34&&n<50?"BLUE":n>=50&&n<64?"YELLOW":n>=64?"RED":"WHITE"},getColorFromProb(n){switch(n=n>=10?Math.floor(n/10)*10:n>=5?5:0,n){case 5:return"DARKGREEN";case 10:return"GREEN";case 20:return"LIMEGREEN";case 30:return"LIGHTYELLOW";case 40:return"BLANDYELLOW";case 50:return"DARKORANGE";case 60:return"ORANGE";case 70:return"RED";case 80:return"DARKRED";case 90:return"PURPLE"}},styleFunction(n){const t=n.get("layer");if(t==="error_cone")return this[t][n.get("label")];if(t==="forecast_position")if(L1.includes(n.get("hour"))){const e=this.getColorFromWS(n.get("maxwind"));return this[t][e]}else return this[t].default;else{if(t==="forecast_track_line")return this[t].default;if(t==="forecast_track_point"){const e=this.getColorFromWS(n.get("maxwind"));return this[t][e]}else if(t==="forecast_winds"){const e=this.getColorFromWS(n.get("maxwind"));return this[t][e]}else if(t==="past_track_point"){const e=this.getColorFromWS(n.get("maxwind"));return this[t][e]}else{if(t==="past_track_line")return this[t].default;if(t==="past_wind"){const e=this.getColorFromWS(n.get("windspd"));return this[t][e]}else{if(t==="warning_line")return this[t].default;if(t==="wind_prob_point")return this[t].default;if(t==="wind_prob_polygon"){if(n.get("windspd")===34){const e=this.getColorFromProb(n.get("prob"));return this[t][e]}}else if(t==="forecast_wind_swath"){const e=this.getColorFromWS(n.get("windspd"));return this[t][e]}}}}}},fh="https://data.hurricanemapping.com",kn={};let Fn={},on,Qi,vi,Te,Cn=null,Ir=!1;const Do="fb790bbfff4ba5a930d0fb75c1f81dd53503fc2b";function O1(){const n=new Uw({source:new Xb,name:"basemap"});on=new bw({layers:[n],target:document.getElementById("map"),view:new Oe({center:[0,3e6],zoom:2})}),document.getElementById("toc").addEventListener("toggle",function(t){const e=t.target;if(e.tagName==="DETAILS"&&e.open){const i=document.querySelector(`details[data-stormid="${vi}"]`);i&&i!==e&&(i.querySelector("summary").style.backgroundColor="",i.open=!1,document.querySelectorAll(`input[name="layer_${vi}"]`).forEach(s=>{s.checked&&(s.checked=!1,s.dispatchEvent(new Event("change")))})),e.querySelector("summary").style.backgroundColor="#c1ddf2",vi=e.getAttribute("data-stormid");const r=Qi.find(s=>s.stormid===vi);F1(r)}},!0)}function yu(n){const t=n.getSource().getExtent();on.getView().fit(t,{duration:1e3,padding:[20,20,20,20],maxZoom:4})}async function k1(n){try{const t=await fetch(`${fh}/hmgis/advisories/?storm=${n.stormid}`,{method:"GET",headers:{Authorization:`Token ${Do}`,"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to fetch advisories: ${t.statusText}`);const e=await t.json(),i=Qi.findIndex(r=>r.stormid===n.stormid);return i!==-1&&!Qi[i].workingAdvisories&&(Qi[i].workingAdvisories=e.filter(r=>r.storm===n.stormid)),e}catch(t){return console.error(t),[]}}function D1(){fetch(`${fh}/hmgis/?format=json`,{method:"GET",headers:{Authorization:`Token ${Do}`,"Content-Type":"application/json"}}).then(n=>{if(!n.ok)throw new Error(`Failed to fetch GeoJSON file: ${n.statusText}`);return n.json()}).then(n=>{Qi=n.map(t=>({...t,year:t.stormid.slice(-4),region:t.stormid.slice(0,2),number:t.stormid.slice(2,4)})),Fn=Object.fromEntries(Qi.map(t=>[t.stormid,t])),M1()})}async function M1(){const n=document.getElementById("toc");n.innerHTML="";let t="";const e={};Qi.forEach(a=>{const l=a.year,c=a.region.toUpperCase();e[l]||(e[l]={}),e[l][c]||(e[l][c]=[]),e[l][c].push(a)});const i=Object.keys(e).sort((a,l)=>l-a),r=i[0];for(const a of i){t+=`<div class="folder year-folder">
      <div class="folder-header" onclick="this.nextElementSibling.classList.toggle('collapsed'); 
      const toggle = this.querySelector('.year-toggle');
      toggle.textContent = toggle.textContent === '+' ? '-' : '+';">
        <span class="year-toggle">+</span> ${a}
      </div>
      <div class="folder-content collapsed">`;const l=Object.keys(e[a]).sort();for(const c of l)t+=`
          <div class="folder region-folder" style="margin-left:10px;">
            <div class="folder-header" onclick="this.nextElementSibling.classList.toggle('collapsed'); 
            const toggle = this.querySelector('.year-toggle');
            toggle.textContent = toggle.textContent === '+' ? '-' : '+';">
              <span class="year-toggle">+</span> ${c}
            </div>
            <div class="folder-content collapsed" id="region-${a}-${c}" style="margin-left:20px;">
              <div class="storm-list-placeholder">Loading...</div>
            </div>
          </div>
        `;t+="</div></div>"}n.innerHTML=t,await Promise.all(Object.keys(e[r]).map(async a=>{const l=e[r][a],c=await vu(l);document.getElementById(`region-${r}-${a}`).innerHTML=c}));const s=document.querySelector(Object.keys(e[r]).map(a=>`#region-${r}-${a} details`).join(", "));if(s){const a=s.closest(".folder-content.collapsed");if(a){a.classList.remove("collapsed");const l=a.previousElementSibling;if(l){const h=l.querySelector(".year-toggle");h&&(h.textContent="-")}const c=a.parentElement.closest(".folder-content.collapsed");if(c){c.classList.remove("collapsed");const h=c.previousElementSibling;if(h){const u=h.querySelector(".year-toggle");u&&(u.textContent="-")}}}s.open=!0}const o=[];i.slice(1).forEach(a=>{Object.keys(e[a]).forEach(l=>{o.push(()=>G1(async()=>{const c=e[a][l],h=await vu(c);document.getElementById(`region-${a}-${l}`).innerHTML=h}))})}),z1(o,1)}function P1(){const n=document.getElementById("left-arrow"),t=document.getElementById("right-arrow"),e=n.cloneNode(!0),i=t.cloneNode(!0);n.parentNode.replaceChild(e,n),t.parentNode.replaceChild(i,t),e.addEventListener("click",()=>{Cn&&clearTimeout(Cn),Te--,Cn=setTimeout(()=>{Te=Eu(Te,Fn[vi]),to("click",Fn[vi],Te)},250)}),i.addEventListener("click",()=>{Cn&&clearTimeout(Cn),Te++,Cn=setTimeout(()=>{Te=Eu(Te,Fn[vi]),to("click",Fn[vi],Te)},250)})}function Eu(n,t){return n<0?0:n>t.workingAdvisories.length-1?t.workingAdvisories.length-1:n}const N1=async n=>{const t=await k1(n),e=t[t.length-1];if(!e||!e.layers)return console.warn(`No advisories or layers found for storm ${n.stormid}`),"";const i=e.storm_name?`${e.storm_name} (${n.stormid})`:`${n.stormid}`,r=Object.entries(e.layers).map(([o,a],l)=>(a.startsWith("http://")&&(a=a.replace("http://","https://")),`
      <div class="form-check">
          <input class="form-check-input" type="checkbox" name="layer_${n.stormid}" value="${a}" adv="${e.advisory_id}" layername="${o}">
          <label class="form-check-label">${o}</label>
      </div>
    `)).join(""),s=`
  <span class="storm-download-container">
    <i class="bi bi-arrow-down-square storm-download-icon" title="Download Storm" data-stormid="${n.stormid}" style="cursor:pointer;"></i>
  </span>
`;return`
  <details data-stormid="${n.stormid}">
    <summary>
      <span class="storm-label-fixed">${i}</span>
      ${s}
    </summary>
    ${r}
  </details>
`},vu=async n=>(await Promise.all(n.sort((e,i)=>e.number-i.number).map(e=>N1(e)))).join("");function F1(n){if(n){const t=n.workingAdvisories[n.workingAdvisories.length-1];Te=n.workingAdvisories.length-1,document.getElementById("storm-title")&&t&&(document.getElementById("left-arrow").style.display="inline-block",document.getElementById("right-arrow").style.display="inline-block",to("init",n,Te));const i=document.querySelector(`details[data-stormid="${n.stormid}"]`);i&&(i.open=!0);const r=document.querySelector(`input[name="layer_${n.stormid}"]`);r&&(Ir=!0,r.checked=!0,r.dispatchEvent(new Event("change",{bubbles:!0})))}}function Oa(n){n.target.checked?B1(n.target):qf(n.target)}function to(n,t,e){W1(),Te=e;const i=[...document.querySelectorAll(`input[name="layer_${t.stormid}"]`)].filter(r=>r.checked).map(r=>r.getAttribute("layername"));if(n==="click"){i.forEach(a=>{const l=document.querySelector(`input[name="layer_${t.stormid}"][layername="${a}"]`);qf(l)});const r=document.querySelector(`details[data-stormid="${t.stormid}"]`);r.querySelectorAll(".form-check").forEach(a=>{a.removeEventListener("change",Oa),a.remove()});const s=Object.entries(t.workingAdvisories[e].layers).map(([a,l])=>{const c=i.includes(a);return l.startsWith("http://")&&(l=l.replace("http://","https://")),`
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="layer_${t.stormid}" 
                            value="${l}" adv="${t.workingAdvisories[e].advisory_id}" 
                            layername="${a}" ${c?"checked":""}>
                        <label class="form-check-label">${a}</label>
                    </div>
                `}).join("");r.insertAdjacentHTML("beforeend",s);const o=i.filter(a=>!t.workingAdvisories[e].layers[a]);if(o.length>0){const a=document.getElementById("layer-notifications"),l=a.querySelector(".notification-text");if(l.textContent=`Previously selected layers are not available in this advisory: ${o.join(", ")}`,a.style.display="block",setTimeout(()=>{a.style.display="none"},5e3),!(document.querySelectorAll(`input[name="layer_${t.stormid}"]:checked`).length>0)){const h=document.querySelector(`input[name="layer_${t.stormid}"]`);h&&(h.checked=!0,l.textContent+=`
Automatically selected the first available layer.`)}}}document.querySelectorAll(`input[name="layer_${t.stormid}"]`).forEach(r=>{r.removeEventListener("change",Oa),r.addEventListener("change",Oa),r.checked&&r.dispatchEvent(new Event("change"))}),document.getElementById("storm-name").textContent=`${t.workingAdvisories[e].storm_status.toLowerCase().replace(/\b\w/g,r=>r.toUpperCase())} ${t.workingAdvisories[e].storm_name.toLowerCase().replace(/\b\w/g,r=>r.toUpperCase())}`,$1(t,e),document.getElementById("advisory-time").textContent=`${t.workingAdvisories[e].advisory_time}`,document.getElementById("left-arrow").disabled=e===0,document.getElementById("left-arrow").style.opacity=e===0?.5:1,document.getElementById("left-arrow").style.pointerEvents=e===0?"none":"auto",document.getElementById("right-arrow").disabled=e===t.workingAdvisories.length-1,document.getElementById("right-arrow").style.opacity=e===t.workingAdvisories.length-1?.5:1,document.getElementById("right-arrow").style.pointerEvents=e===t.workingAdvisories.length-1?"none":"auto"}function z1(n,t=4){let e=0;const i=[],r=[],s=()=>{if(e===n.length)return Promise.resolve();const o=n[e++]();i.push(o);const a=o.then(()=>r.splice(r.indexOf(a),1));r.push(a);let l=Promise.resolve();return r.length>=t&&(l=Promise.race(r)),l.then(()=>s())};return s().then(()=>Promise.all(i))}function G1(n){return new Promise(t=>{"requestIdleCallback"in window?requestIdleCallback(()=>{n().then(t)},{timeout:1e3}):setTimeout(()=>{n().then(t)},50)})}function B1(n){kn[n.attributes.name.value]||(kn[n.attributes.name.value]={}),kn[n.attributes.name.value][n.attributes.adv.value]||(kn[n.attributes.name.value][n.attributes.adv.value]={});const t=kn[n.attributes.name.value][n.attributes.adv.value];if(t[n.attributes.layername.value])wu(t[n.attributes.layername.value]),on.addLayer(t[n.attributes.layername.value]),Ir&&(yu(t[n.attributes.layername.value]),Ir=!1);else{let e=n.value.replace(/^https:\/\/data\.hurricanemapping\.com/,"");fetch(`${fh}${e}`,{method:"GET",headers:{Authorization:`Token ${Do}`,"Content-Type":"application/json"}}).then(i=>{if(!i.ok)throw new Error(`Failed to fetch GeoJSON file: ${i.statusText}`);return i.json()}).then(i=>{const r=new qb().readFeatures(i,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),s=new Sb;s.addFeatures(r);const o=new vb({source:s,stormid:n.attributes.name.value,advisory:n.attributes.adv.value,layer:n.attributes.layername.value,style:pu.styleFunction.bind(pu)});t[n.attributes.layername.value]=o,wu(o),on.addLayer(o),Ir&&(yu(t[n.attributes.layername.value]),Ir=!1)}).catch(i=>{console.error(i.message)})}}function wu(n){let t=0;const e=n.getSource().getFeatures();if(e.length>0){const i=e[0].getGeometry().getType();i==="Point"||i==="MultiPoint"?t=30:i==="LineString"||i==="MultiLineString"?t=20:(i==="Polygon"||i==="MultiPolygon")&&(t=10)}n.setZIndex(t)}function W1(){on.getLayers().getArray().forEach(n=>{n.get("name")!=="basemap"&&on.removeLayer(n)})}function qf(n){on.removeLayer(kn[n.attributes.name.value][n.attributes.adv.value][n.attributes.layername.value])}function $1(n,t){const e=document.getElementById("advisory-dropdown");if(!e)return;e.innerHTML=`
    <div class="selected" tabindex="0">${"Advisory #"+n.workingAdvisories[t].advisory_id}</div>
    <div class="dropdown-list" style="display:none"></div>
  `;const i=e.querySelector(".selected"),r=e.querySelector(".dropdown-list");r.innerHTML=n.workingAdvisories.map((s,o)=>`<div class="dropdown-item${o===t?" selected":""}" data-idx="${o}">
      Advisory #${s.advisory_id}
    </div>`).join(""),i.onclick=s=>{s.stopPropagation(),e.classList.toggle("open"),r.style.display=e.classList.contains("open")?"block":"none",i.focus()},e.onkeydown=s=>{(s.key==="Enter"||s.key===" ")&&(i.click(),s.preventDefault()),s.key==="Escape"&&(e.classList.remove("open"),r.style.display="none")},r.onclick=s=>{s.target.classList.contains("dropdown-item")&&(t=parseInt(s.target.dataset.idx,10),e.classList.remove("open"),r.style.display="none",to("click",n,t))},window._advisoryDropdownHandler&&document.removeEventListener("click",window._advisoryDropdownHandler),window._advisoryDropdownHandler=function(s){e.contains(s.target)||(e.classList.remove("open"),r.style.display="none")},document.addEventListener("click",window._advisoryDropdownHandler),e.onblur=function(){e.classList.remove("open"),r.style.display="none"}}function j1(){const n=document.getElementById("toc");n&&n.addEventListener("click",function(t){if(t.target.classList.contains("storm-download-icon")||t.target.classList.contains("storm-download-container")){t.preventDefault(),t.stopPropagation();const e=t.target.closest("[data-stormid]").getAttribute("data-stormid");U1(e)}})}function U1(n){const t=document.getElementById("downloadModalLabel");t&&(t.textContent=`Download Storm: ${n}`);const e=new bootstrap.Modal(document.getElementById("downloadModal"));e.show();const i=document.getElementById("downloadFormModal");i.onsubmit=function(r){r.preventDefault();const s=i.querySelector('input[name="advisory"]:checked').value,o=i.querySelector('input[name="format"]:checked').value;Y1(n,s,o,e)}}async function Y1(n,t,e,i){const r=document.getElementById("downloadLoadingOverlay");r&&(r.style.display="flex");let s;const o=new Promise((a,l)=>{s=setTimeout(()=>{l(new Error("Download preparation timed out. Please try again later."))},6e4)});try{const a=Fn[n];if(!a)throw new Error("Storm not found.");let l=[];if(t==="all")a.workingAdvisories.forEach(u=>{Object.entries(u.layers).forEach(([f,d])=>{d.startsWith("http://")&&(d=d.replace("http://","https://")),l.push({url:d,name:f,adv:u.advisory_id})})});else{const f=document.querySelector(`input[name="layer_${n}"]`).getAttribute("adv"),d=a.workingAdvisories[f-1].layers;Object.entries(d).forEach(([_,g])=>{g.startsWith("http://")&&(g=g.replace("http://","https://")),l.push({url:g,name:_,adv:f})})}const c=await Promise.race([Promise.all(l.map(u=>fetch(u.url,{headers:{Authorization:`Token ${Do}`,"Content-Type":"application/json"}}).then(f=>f.json().then(d=>({name:u.name,adv:u.adv,data:d}))))),o]);clearTimeout(s);const h=new g1;if(e==="shapefile")for(const{name:u,adv:f,data:d}of c){const _=h.folder(u),g=A1.zip(d,{type:"blob"});_.file(`${u}_adv${f}.zip`,g)}else c.forEach(({name:u,adv:f,data:d})=>{h.folder(u).file(`${u}_adv${f}.geojson`,JSON.stringify(d,null,2))});await h.generateAsync({type:"blob"}).then(function(u){const f=document.createElement("a");f.href=URL.createObjectURL(u),f.download=`${n}_${e}_layers.zip`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(f.href)}),r&&(r.style.display="none"),i.hide()}catch(a){r&&(r.style.display="none"),i.hide(),alert(a.message||"An error occurred during download.")}}document.addEventListener("DOMContentLoaded",function(){O1(),D1(),P1(),j1()});
